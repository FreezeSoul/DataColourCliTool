#!/usr/bin/env node

const a0_0x1da0=['c3RkZXJy','Y29tbWFuZA==','b3Jh','5p6E5bu65LiA5LiqV2lkZ2V0','LS1tZWRpYS1jYWNoZS1zaXplPTE=','6K+36L6T5YWlV2lkZ2V05L2c6ICF5ZCN56ew77yM5aaC77yaRnJlZXplU291bDxmcmVlemVzb3VsQGdtYWlsLmNvbT4=','cmVhZHk=','5byA5aeL5bu656uL5pyN5Yqh5Zmo6L+e5o6lLi4u','dGFn','5aaC5rWP6KeI5Zmo5ZCv5Yqo5aSx6LSl77yM6K+36YCa6L+H5aaC5LiL5ZG95Luk6KGM5omL5bel5ZCv5Yqo77ya','Y3JlYXRlV3JpdGVTdHJlYW0=','ZW5hYmxl','ZGF0YQ==','5bey5a2Y5Zyo','ZG93bmxvYWQtZ2l0LXJlcG8=','c3VjY2VlZA==','YnVpbGQ=','c3RhcnQtd2lkZ2V0','Y2hhbGs=','d2lkZ2V0cw==','cmVk','dmFsdWU=','ZXJyb3I=','ZGVidWc=','c2l6ZQ==','5Yid5aeL5YyWV2lkZ2V06aG555uu','6K+35o+Q5L6b5a6M5pW055qEV2lkZ2V05L+h5oGv','bG9nLXN5bWJvbHM=','Y29tbWFuZGVy','d2lkZ2V0cy5qc29u6K+75Y+W5aSx6LSl','bWF0Y2g=','5Yib5bu65LiA5LiqV2lkZ2V0','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tcGF0aD0=','ZnRwLmRhdGFjb2xvdXIuY24=','bG9n','ZmFpbA==','ZXhlY1N5bmM=','V2lkZ2V05Yib5bu65oiQ5Yqf','5p6E5bu65omA5pyJV2lkZ2V0cw==','dW5vZmZpY2lhbA==','TGludXg6IC9vcHQvZ29vZ2xlL2Nocm9tZS9jaHJvbWUgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9L3RtcC9jaHJvbWVfdG1w','cGlwZQ==','cGFja2FnZS5qc29u','6K+36L6T5YWlV2lkZ2V055qE5ZCN56ew77yM6KaB5rGC566A55+t55qE5Lit5paH5ZCN56ew5a6a5LmJ','6K+36YCJ5oup6KaB5p6E5bu655qEV2lkZ2V0','6K+36YCJ5oup6KaB5Y+R5biD55qEV2lkZ2V0','cHVibGlzaC8=','Y3JlYXRl','ZXhpc3RzU3luYw==','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4u','YnVpbGQv','YXV0aG9y','dmVyc2lvbg==','5qCH6K+GOg==','bmFtZQ==','5LiN5a2Y5Zyo','YXJndg==','c3Rkb3V0','ZGlzdC93aWRnZXRzLw==','L21hbmlmZXN0Lmpzb24=','cGFjaw==','LOWQjeensDo=','c3Bhd24=','6LCD6K+V5LiA5LiqV2lkZ2V0','5ZCv5Yqo6LC35q2M5rWP6KeI5Zmo6LCD6K+VLi4u','6K+36L6T5YWlV2lkZ2V055qE5qCH6K+G77yM6KaB5rGC6Iux5paH44CB5pWw5a2X44CB5LiL5YiS57q/','Y29ubmVjdA==','Y2hyb21lLWxhdW5jaGVy','6K+36YCJ5oup6KaB6LCD6K+V55qEV2lkZ2V0','c3VjY2Vzcw==','cmVwbGFjZQ==','c3JjL3dpZGdldHMv','LXYsIC0tdmVyc2lvbg==','6K+36L6T5YWl5bmz5Y+w5pyN5Yqh5Zyw5Z2A77yM6buY6K6k6LCD55So5YWs5YWx5pyN5Yqh','LS0gLS1wYXRoPQ==','cHJvbXB0','cHVibGlzaA==','V2lkZ2V0Og==','cGF0aA==','ZnRw','Z3JlZW4=','c3RhcnQ=','bnBt','dG9JU09TdHJpbmc=','5q2j5Zyo5Yib5bu6V2lkZ2V0Og==','Y3JlYXRlUmVhZFN0cmVhbQ==','LS11c2VyLWRhdGEtZGlyPS4vY2hyb21lX3RtcA==','bW92ZVN5bmM=','6K+36L6T5YWlV2lkZ2V05a2Y5YKo6Lev5b6E77yM6buY6K6k6Lev5b6EdW5vZmZpY2lhbO+8jOW7uuiurum7mOiupA==','Y29weS1kaXI=','cmVzb2x2ZQ==','aW5xdWlyZXI=','c3JjL3dpZGdldHMvdGVtcGxhdGUvd2lkZ2V0','c3RyaW5naWZ5','Y2hkaXI=','dXNl','cmF3bGlzdA==','cHV0','V2luZG93OiAiQzpQcm9ncmFtIEZpbGVzICh4ODYpR29vZ2xlQ2hyb21lQXBwbGljYXRpb25jaHJvbWUuZXhlIiAtLWRpc2FibGUtd2ViLXNlY3VyaXR5IC0tdXNlci1kYXRhLWRpcj1+L2Nocm9tZV90bXA=','ZXhwcmVzcw==','Y2hpbGRfcHJvY2Vzcw==','6K+36L6T5YWlV2lkZ2V055qE5o+P6L+w77yM6KaB5rGC566A55+t55qE5Lit5paH5o+P6L+w5L+h5oGv','V2lkZ2V05qih5p2/5paH5Lu25aS55LiN5a2Y5Zyo','L19fcGF0aF9fLnR4dA==','5pyN5Yqh5Zmo6L+e5o6l5bey5bu656uLLi4u','aW5mbw==','YnVpbGRBbGw=','LS1kaXNhYmxlLXdlYi1zZWN1cml0eQ==','cmVhZEZpbGVTeW5j','LnNyYy50YXI=','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','cHVzaA==','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4uCQ==','bWtkaXJTeW5j','ZGVzY3JpcHRpb24=','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','dGFyLWZz','ZGF0YWNvbG91cg==','cGFyc2U=','6K+35Y+N6aaI5Y+R5biD5bqP5Y+3Og==','aW5oZXJpdA==','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','LmRpc3QudGFy','L3dpZGdldHM=','ZW5k','5a6M5oiQ6aG555uu5Yid5aeL5YyW77yM6K+35Yib5bu65LiA5LiqV2lkZ2V0','LS1kaXNrLWNhY2hlLXNpemU9MQ==','6K+75Y+W5aSx6LSl','aG9zdA==','Li4u','aHR0cDovLzM5LjEwMS4xMzguNDM6ODA4MA==','dG9TdHJpbmc=','bGlzdGVu','bGlzdA==','bnBtIGluc3RhbGw=','aHR0cDovLzEyNy4wLjAuMTo4MDg4Lw==','RnJlZXplU291bC9EYXRhQ29sb3VyV2lkZ2V0VGVtcGxhdGUjbWFzdGVy','c3luYw==','aGFuZGxlYmFycw==','YWN0aW9u','dG9GaXhlZA==','Ymx1ZQ==','d3JpdGVGaWxlU3luYw==','5q2j5Zyo5ZCv5Yqo5Luj55CG5pyN5YqhLi4u','aHR0cDovLzEyNy4wLjAuMTo=','d2hpdGU=','6YOo5Lu25bey5oiQ5Yqf5o+Q5LqkLi4u','LOeJiOacrDo=','aHR0cC1wcm94eS1taWRkbGV3YXJl','ZnMtZXh0cmE=','dGhlbg=='];(function(_0x48db51,_0x44ed9c){const _0x3c7ab3=function(_0xe9d144){while(--_0xe9d144){_0x48db51['push'](_0x48db51['shift']());}};_0x3c7ab3(++_0x44ed9c);}(a0_0x1da0,0x84));const a0_0x21b0=function(_0x48db51,_0x44ed9c){_0x48db51=_0x48db51-0x0;let _0x3c7ab3=a0_0x1da0[_0x48db51];if(a0_0x21b0['KdcQYk']===undefined){(function(){let _0xf5cb62;try{const _0x44f019=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xf5cb62=_0x44f019();}catch(_0x279eaf){_0xf5cb62=window;}const _0x25d240='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0xf5cb62['atob']||(_0xf5cb62['atob']=function(_0x2921ae){const _0x34f955=String(_0x2921ae)['replace'](/=+$/,'');let _0x410463='';for(let _0x38e854=0x0,_0x119c9d,_0x115f01,_0x39b816=0x0;_0x115f01=_0x34f955['charAt'](_0x39b816++);~_0x115f01&&(_0x119c9d=_0x38e854%0x4?_0x119c9d*0x40+_0x115f01:_0x115f01,_0x38e854++%0x4)?_0x410463+=String['fromCharCode'](0xff&_0x119c9d>>(-0x2*_0x38e854&0x6)):0x0){_0x115f01=_0x25d240['indexOf'](_0x115f01);}return _0x410463;});}());a0_0x21b0['iYLmjE']=function(_0x3c2ade){const _0x100bc5=atob(_0x3c2ade);let _0x40dbd5=[];for(let _0x1e572b=0x0,_0x558b5a=_0x100bc5['length'];_0x1e572b<_0x558b5a;_0x1e572b++){_0x40dbd5+='%'+('00'+_0x100bc5['charCodeAt'](_0x1e572b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x40dbd5);};a0_0x21b0['JfmfdU']={};a0_0x21b0['KdcQYk']=!![];}const _0xe9d144=a0_0x21b0['JfmfdU'][_0x48db51];if(_0xe9d144===undefined){_0x3c7ab3=a0_0x21b0['iYLmjE'](_0x3c7ab3);a0_0x21b0['JfmfdU'][_0x48db51]=_0x3c7ab3;}else{_0x3c7ab3=_0xe9d144;}return _0x3c7ab3;};const fs=require('fs');const fse=require(a0_0x21b0('0x11'));const path=require(a0_0x21b0('0x61'));const ora=require(a0_0x21b0('0x15'));const tar=require(a0_0x21b0('0x87'));const Client=require(a0_0x21b0('0x62'));const chalk=require(a0_0x21b0('0x25'));const express=require(a0_0x21b0('0x76'));const copydir=require(a0_0x21b0('0x6c'));const program=require(a0_0x21b0('0x2f'));const inquirer=require(a0_0x21b0('0x6e'));const symbols=require(a0_0x21b0('0x2e'));const handlebars=require(a0_0x21b0('0x6'));const proxy=require(a0_0x21b0('0x10'));const download=require(a0_0x21b0('0x21'));const child_process=require(a0_0x21b0('0x77'));const ChromeLauncher=require(a0_0x21b0('0x56'));const githublink=a0_0x21b0('0x4');const dcServerAddress=a0_0x21b0('0x95');const widgetDebugUrl=a0_0x21b0('0x3');const ftpServerAddress=a0_0x21b0('0x34');const ftpServerUserName='datacolour';const ftpServerPassword=a0_0x21b0('0x88');const proxyServerPort=0x270f;try{const packagePath=path[a0_0x21b0('0x6d')](__dirname,a0_0x21b0('0x3d'));if(fs[a0_0x21b0('0x43')](packagePath)){const pjson=require(packagePath);const version=pjson[a0_0x21b0('0x47')];program[a0_0x21b0('0x47')](version,a0_0x21b0('0x5b'));}}catch(a0_0x113861){}program[a0_0x21b0('0x14')]('init\x20<name>')[a0_0x21b0('0x85')](a0_0x21b0('0x2c'))['action'](_0x4873d3=>{if(!fs[a0_0x21b0('0x43')](_0x4873d3)){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk['white']('初始化Widget项目'));const _0x4b4d0f=ora('正在下载Widget模板...');_0x4b4d0f['start']();download(githublink,_0x4873d3,{'clone':![]},_0x571f16=>{if(_0x571f16){_0x4b4d0f[a0_0x21b0('0x36')]();console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x571f16));}else{_0x4b4d0f[a0_0x21b0('0x22')]();process[a0_0x21b0('0x71')](_0x4873d3);console['log'](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0xd')]('开始安装依赖组件...'));child_process['execSync'](a0_0x21b0('0x2'),{'stdio':a0_0x21b0('0x8b')});console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0xd')]('完成安装依赖组件...'));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0xd')](a0_0x21b0('0x90')));}});}else{console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')]('项目'+_0x4873d3+a0_0x21b0('0x20')));}});program[a0_0x21b0('0x14')](a0_0x21b0('0x1'))[a0_0x21b0('0x85')]('列出所有Widget')[a0_0x21b0('0x7')](()=>{try{const _0x337e60=a0_0x21b0('0x81');if(fs[a0_0x21b0('0x43')](_0x337e60)){const _0x77b9e2=fs[a0_0x21b0('0x7f')](_0x337e60)[a0_0x21b0('0x96')]();const _0x3e5b8d=JSON['parse'](_0x77b9e2);for(let _0x3e3eec of _0x3e5b8d[a0_0x21b0('0x26')]){const _0x4ad2bd=a0_0x21b0('0x5a')+_0x3e3eec[a0_0x21b0('0x61')];const _0x225963=_0x4ad2bd+a0_0x21b0('0x4e');if(fs[a0_0x21b0('0x43')](_0x225963)){let _0x4602a3=fs['readFileSync'](_0x225963)[a0_0x21b0('0x96')]();const _0x15540c=JSON[a0_0x21b0('0x89')](_0x4602a3);console[a0_0x21b0('0x35')](symbols['info'],chalk['white'](a0_0x21b0('0x48')+_0x15540c['id']+a0_0x21b0('0x50')+_0x15540c[a0_0x21b0('0x49')]+a0_0x21b0('0xf')+_0x15540c[a0_0x21b0('0x47')]));}}}}catch(_0x5f42b4){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x5f42b4));}});program[a0_0x21b0('0x14')](a0_0x21b0('0x42'))['description'](a0_0x21b0('0x32'))[a0_0x21b0('0x7')](()=>{inquirer[a0_0x21b0('0x5e')]([{'name':'id','message':a0_0x21b0('0x54')},{'name':'name','message':a0_0x21b0('0x3e')},{'name':a0_0x21b0('0x85'),'message':a0_0x21b0('0x78')},{'name':a0_0x21b0('0x1b'),'message':'请输入Widget分类标签，要求英文字母，多个逗号分割'},{'name':a0_0x21b0('0x46'),'message':a0_0x21b0('0x18')},{'name':a0_0x21b0('0x61'),'message':a0_0x21b0('0x6b')}])['then'](_0x4c7640=>{try{const _0x4af8be=_0x4c7640['id'];const _0x5053c9=_0x4c7640[a0_0x21b0('0x49')];const _0x446cfb=_0x4c7640['description'];const _0x3def9d=_0x4c7640[a0_0x21b0('0x46')];const _0x2522f7=_0x4c7640[a0_0x21b0('0x1b')]?_0x4c7640[a0_0x21b0('0x1b')]:'Chart';const _0x988e0a=_0x4c7640[a0_0x21b0('0x61')]?_0x4c7640[a0_0x21b0('0x61')][a0_0x21b0('0x59')](/^\/+|\/+$/g,''):a0_0x21b0('0x3a');const _0x3ec99c=createWidget(_0x4af8be,_0x5053c9,_0x446cfb,_0x3def9d,_0x2522f7,_0x988e0a);if(_0x3ec99c){console[a0_0x21b0('0x35')](symbols['success'],chalk[a0_0x21b0('0x63')](a0_0x21b0('0x38')));}}catch(_0x4ff711){console['log'](symbols['error'],chalk['red'](_0x4ff711));}});});program['command'](a0_0x21b0('0x2a'))[a0_0x21b0('0x85')](a0_0x21b0('0x52'))[a0_0x21b0('0x7')](()=>{inquirer['prompt']([{'name':'id','message':a0_0x21b0('0x57'),'type':'rawlist','choices':getWidgetsList()},{'name':a0_0x21b0('0x93'),'message':a0_0x21b0('0x5c')}])[a0_0x21b0('0x12')](_0x4725ed=>{try{const _0x205606=_0x4725ed['id'];const _0x4642dc=getWidgetPath(_0x205606);const _0x4c8a1d=_0x4725ed['host']?_0x4725ed[a0_0x21b0('0x93')]:dcServerAddress;const _0x1c84a3=a0_0x21b0('0x5a')+_0x4642dc+a0_0x21b0('0x4e');if(fs[a0_0x21b0('0x43')](_0x1c84a3)){const _0x4e8021=a0_0x21b0('0x81');let _0x27b362=fs[a0_0x21b0('0x7f')](_0x4e8021)['toString']();const _0x2186b2=JSON[a0_0x21b0('0x89')](_0x27b362);_0x2186b2[a0_0x21b0('0x47')]=getNextVersion(_0x2186b2[a0_0x21b0('0x47')]);for(let _0x424897 of _0x2186b2[a0_0x21b0('0x26')]){_0x424897[a0_0x21b0('0x1e')]=_0x424897[a0_0x21b0('0x61')]===_0x4642dc;}_0x27b362=JSON[a0_0x21b0('0x70')](_0x2186b2,null,0x2);fs[a0_0x21b0('0xa')](_0x4e8021,_0x27b362);let _0xc045b6=fs[a0_0x21b0('0x7f')](_0x1c84a3)['toString']();const _0x202a87=JSON[a0_0x21b0('0x89')](_0xc045b6);_0x202a87['version']=getNextVersion(_0x202a87[a0_0x21b0('0x47')]);_0xc045b6=JSON[a0_0x21b0('0x70')](_0x202a87,null,0x2);fs[a0_0x21b0('0xa')](_0x1c84a3,_0xc045b6);console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0xd')]('当前Widget版本号：'+_0x202a87['version']));startProxyServer(_0x4c8a1d,function(){const _0x587b86=child_process[a0_0x21b0('0x51')](a0_0x21b0('0x65'),['run',a0_0x21b0('0x24'),a0_0x21b0('0x5d')+_0x4642dc],{'shell':!![]});_0x587b86[a0_0x21b0('0x4c')]['on'](a0_0x21b0('0x1f'),function(_0xde2822){console['log'](_0xde2822['toString']());});_0x587b86[a0_0x21b0('0x13')]['on'](a0_0x21b0('0x1f'),function(_0x27c8e9){console[a0_0x21b0('0x35')](_0x27c8e9[a0_0x21b0('0x96')]());});});}else{console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')]('Widget:'+_0x205606+'不存在'));}}catch(_0x1a3b70){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk['red'](_0x1a3b70));}});});program[a0_0x21b0('0x14')](a0_0x21b0('0x23'))['description'](a0_0x21b0('0x16'))['action'](()=>{inquirer[a0_0x21b0('0x5e')]([{'name':'id','message':a0_0x21b0('0x3f'),'type':a0_0x21b0('0x73'),'choices':getWidgetsList()}])[a0_0x21b0('0x12')](_0x3db941=>{try{const _0x315066=_0x3db941['id'];const _0x1b9529=getWidgetPath(_0x315066);const _0x2eb3a6='src/widgets/'+_0x1b9529+a0_0x21b0('0x4e');if(fs[a0_0x21b0('0x43')](_0x2eb3a6)){let _0x54c714=fs['readFileSync'](_0x2eb3a6)[a0_0x21b0('0x96')]();const _0x59ce8e=JSON[a0_0x21b0('0x89')](_0x54c714);_0x59ce8e[a0_0x21b0('0x47')]=getNextVersion(_0x59ce8e['version']);_0x54c714=JSON[a0_0x21b0('0x70')](_0x59ce8e,null,0x2);fs[a0_0x21b0('0xa')](_0x2eb3a6,_0x54c714);console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0xd')](a0_0x21b0('0x86')+_0x59ce8e[a0_0x21b0('0x47')]));child_process[a0_0x21b0('0x37')](a0_0x21b0('0x33')+_0x1b9529,{'stdio':a0_0x21b0('0x8b')});}else{console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](a0_0x21b0('0x60')+_0x315066+a0_0x21b0('0x4a')));}}catch(_0x17fb82){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x17fb82));}});});program[a0_0x21b0('0x14')](a0_0x21b0('0x7d'))[a0_0x21b0('0x85')](a0_0x21b0('0x39'))[a0_0x21b0('0x7')](()=>{try{const _0x63ce88=getWidgetsList();for(let _0x1da8bc of _0x63ce88){const _0x4f9cbb=_0x1da8bc[a0_0x21b0('0x28')];const _0x2b6a71=getWidgetPath(_0x4f9cbb);const _0x1dfb0c=a0_0x21b0('0x5a')+_0x2b6a71+a0_0x21b0('0x4e');if(fs[a0_0x21b0('0x43')](_0x1dfb0c)){let _0x405e2e=fs['readFileSync'](_0x1dfb0c)[a0_0x21b0('0x96')]();const _0xa5d8c8=JSON[a0_0x21b0('0x89')](_0x405e2e);_0xa5d8c8[a0_0x21b0('0x47')]=getNextVersion(_0xa5d8c8[a0_0x21b0('0x47')]);_0x405e2e=JSON[a0_0x21b0('0x70')](_0xa5d8c8,null,0x2);fs[a0_0x21b0('0xa')](_0x1dfb0c,_0x405e2e);console['log'](symbols['info'],chalk[a0_0x21b0('0xd')]('当前Widget标识：'+_0x4f9cbb));console['log'](symbols[a0_0x21b0('0x7c')],chalk['white'](a0_0x21b0('0x86')+_0xa5d8c8[a0_0x21b0('0x47')]));child_process[a0_0x21b0('0x37')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0x2b6a71,{'stdio':a0_0x21b0('0x8b')});console['log'](symbols[a0_0x21b0('0x58')],chalk[a0_0x21b0('0x63')]('完成构建Widget：'+_0xa5d8c8[a0_0x21b0('0x47')]));const _0x514c8d=a0_0x21b0('0x4d')+_0x2b6a71;const _0x199cbb=a0_0x21b0('0x45')+_0x2b6a71;if(!fs['existsSync'](a0_0x21b0('0x23'))){fs[a0_0x21b0('0x84')](a0_0x21b0('0x23'));}if(fs[a0_0x21b0('0x43')](_0x514c8d)){fse[a0_0x21b0('0x6a')](_0x514c8d,_0x199cbb);}}else{console[a0_0x21b0('0x35')](symbols['error'],chalk[a0_0x21b0('0x27')](a0_0x21b0('0x60')+_0x4f9cbb+a0_0x21b0('0x4a')));}}}catch(_0x2f9bc3){console['log'](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x2f9bc3));}});program['command'](a0_0x21b0('0x5f'))[a0_0x21b0('0x85')]('发布一个Widget')[a0_0x21b0('0x7')](()=>{inquirer[a0_0x21b0('0x5e')]([{'name':'id','message':a0_0x21b0('0x40'),'type':a0_0x21b0('0x73'),'choices':getWidgetsList()},{'name':a0_0x21b0('0x62'),'message':'请确认是否备份至公共插件中心，请输入y/n(默认n)'}])[a0_0x21b0('0x12')](_0x3c1fca=>{try{const _0x45437c=_0x3c1fca['id'];const _0x13f68a=getWidgetPath(_0x45437c);const _0x5b2985='src/widgets/'+_0x13f68a;const _0x1c3091=a0_0x21b0('0x4d')+_0x13f68a;const _0x51500e=_0x5b2985+'/manifest.json';const _0xb4fe5a=new Date()[a0_0x21b0('0x66')]()[a0_0x21b0('0x59')](/T/,'')[a0_0x21b0('0x59')](/\..+/,'')[a0_0x21b0('0x59')](/-/g,'')[a0_0x21b0('0x59')](/:/g,'');const _0x2d0367=_0x45437c+'.'+_0xb4fe5a;const _0x6d5ce=_0x2d0367+a0_0x21b0('0x80');const _0xefd736=_0x2d0367+a0_0x21b0('0x8d');const _0x12c502=a0_0x21b0('0x41')+_0x6d5ce;const _0x62683b=a0_0x21b0('0x41')+_0xefd736;if(!fs[a0_0x21b0('0x43')](a0_0x21b0('0x5f'))){fs[a0_0x21b0('0x84')](a0_0x21b0('0x5f'));}if(fs[a0_0x21b0('0x43')](_0x51500e)){let _0x9d5fac=fs['readFileSync'](_0x51500e)['toString']();const _0x5949b5=JSON[a0_0x21b0('0x89')](_0x9d5fac);_0x5949b5[a0_0x21b0('0x47')]=getNextVersion(_0x5949b5['version']);_0x9d5fac=JSON['stringify'](_0x5949b5,null,0x2);fs[a0_0x21b0('0xa')](_0x51500e,_0x9d5fac);console['log'](symbols[a0_0x21b0('0x7c')],chalk['white']('当前Widget版本号：'+_0x5949b5['version']));child_process[a0_0x21b0('0x37')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0x13f68a,{'stdio':a0_0x21b0('0x8b')});fs[a0_0x21b0('0xa')](_0x5b2985+a0_0x21b0('0x7a'),_0x13f68a);fs[a0_0x21b0('0xa')](_0x1c3091+a0_0x21b0('0x7a'),_0x13f68a);tar[a0_0x21b0('0x4f')](_0x5b2985)[a0_0x21b0('0x3c')](fs[a0_0x21b0('0x1d')](_0x12c502));tar[a0_0x21b0('0x4f')](_0x1c3091)['pipe'](fs['createWriteStream'](_0x62683b));const _0x49ec38=_0x3c1fca[a0_0x21b0('0x62')];if(_0x49ec38==='y'){connectFtpServer(function(_0x4362ad){const _0x426ebf=ora(a0_0x21b0('0x44'));_0x426ebf['start']();const _0x10e894=fs[a0_0x21b0('0x68')](_0x12c502);const _0x5e3576=fs['statSync'](_0x12c502)[a0_0x21b0('0x2b')];_0x4362ad[a0_0x21b0('0x74')](_0x10e894,_0x6d5ce,function(_0x27f612){if(_0x27f612){_0x426ebf[a0_0x21b0('0x36')]();console['log'](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x27f612));throw _0x27f612;}_0x4362ad[a0_0x21b0('0x8f')]();_0x426ebf[a0_0x21b0('0x22')](a0_0x21b0('0x44'));console['log'](symbols[a0_0x21b0('0x58')],chalk[a0_0x21b0('0xd')](a0_0x21b0('0xe')));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk['white'](a0_0x21b0('0x8a')+_0x2d0367));});let _0x57130f=0x0;_0x10e894['on']('data',function(_0x5beca9){_0x57130f+=_0x5beca9['length'];_0x426ebf['text']=a0_0x21b0('0x83')+((_0x57130f/_0x5e3576*0x64)[a0_0x21b0('0x8')](0x2)+'%');});});}}else{console[a0_0x21b0('0x35')](symbols['error'],chalk['red'](a0_0x21b0('0x60')+_0x45437c+a0_0x21b0('0x4a')));}}catch(_0x4ed782){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x4ed782));}});});program[a0_0x21b0('0x89')](process[a0_0x21b0('0x4b')]);function createWidget(_0x37749f,_0xd89532,_0x28f6f3,_0x360dd6,_0x3548e3,_0x4e6b92){if(!_0x37749f||!_0xd89532||!_0x28f6f3||!_0x3548e3||!_0x4e6b92){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](a0_0x21b0('0x2d')));return![];}console[a0_0x21b0('0x35')](symbols['info'],chalk[a0_0x21b0('0xd')](a0_0x21b0('0x67')+_0x37749f+'...'));try{const _0x12dfdd=_0x4e6b92+'/'+_0x37749f;const _0x4301f6=a0_0x21b0('0x5a')+_0x4e6b92;const _0x3986cc=a0_0x21b0('0x5a')+_0x12dfdd;const _0x1fc76f=a0_0x21b0('0x6f');if(!fs[a0_0x21b0('0x43')](_0x4301f6)){fs[a0_0x21b0('0x84')](_0x4301f6);}if(!fs[a0_0x21b0('0x43')](_0x1fc76f)){console['log'](symbols[a0_0x21b0('0x29')],chalk['red'](a0_0x21b0('0x79')));return![];}if(fs['existsSync'](_0x3986cc)){console['log'](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](a0_0x21b0('0x60')+_0x37749f+'已存在对应目录'));return![];}copydir[a0_0x21b0('0x5')](_0x1fc76f,_0x3986cc);const _0x3a11a7=_0x3986cc+a0_0x21b0('0x4e');let _0xb4aa6a=fs[a0_0x21b0('0x7f')](_0x3a11a7)['toString']();const _0x5cbbce=JSON[a0_0x21b0('0x89')](_0xb4aa6a);_0x5cbbce['id']=_0x37749f;_0x5cbbce[a0_0x21b0('0x1b')]=_0x3548e3;_0x5cbbce['name']=_0xd89532;_0x5cbbce[a0_0x21b0('0x85')]=_0x28f6f3;_0x5cbbce[a0_0x21b0('0x46')]=_0x360dd6;_0xb4aa6a=JSON[a0_0x21b0('0x70')](_0x5cbbce,null,0x2);fs[a0_0x21b0('0xa')](_0x3a11a7,_0xb4aa6a);const _0x46414e='src/widgets/widgets.json';let _0x3bf187=fs['readFileSync'](_0x46414e)[a0_0x21b0('0x96')]();const _0x371d34=JSON[a0_0x21b0('0x89')](_0x3bf187);_0x371d34[a0_0x21b0('0x47')]=getNextVersion(_0x371d34[a0_0x21b0('0x47')]);for(let _0x1f92cc of _0x371d34[a0_0x21b0('0x26')]){_0x1f92cc[a0_0x21b0('0x1e')]=![];}_0x371d34[a0_0x21b0('0x26')][a0_0x21b0('0x82')]({'group':'测试','path':_0x12dfdd,'enable':!![]});_0x3bf187=JSON[a0_0x21b0('0x70')](_0x371d34,null,0x2);fs[a0_0x21b0('0xa')](_0x46414e,_0x3bf187);console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk['white'](a0_0x21b0('0x8c')+_0x37749f+a0_0x21b0('0x94')));}catch(_0x52123c){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x52123c));return![];}return!![];}function getNextVersion(_0x1d912b){if(_0x1d912b){const _0x558791=_0x1d912b[a0_0x21b0('0x31')](/(.*\.)(\d+)$/);if(_0x558791&&_0x558791[0x1]&&_0x558791[0x2]){return''+_0x558791[0x1]+(parseInt(_0x558791[0x2])+0x1);}}return _0x1d912b;}function getWidgetsList(){const _0x13c693=[];try{const _0x16afaa='src/widgets/widgets.json';if(fs[a0_0x21b0('0x43')](_0x16afaa)){const _0xcdba35=fs[a0_0x21b0('0x7f')](_0x16afaa)[a0_0x21b0('0x96')]();const _0x16706f=JSON[a0_0x21b0('0x89')](_0xcdba35);for(let _0x469826 of _0x16706f[a0_0x21b0('0x26')]){try{const _0x4c0f10='src/widgets/'+_0x469826[a0_0x21b0('0x61')];const _0x456bc0=_0x4c0f10+a0_0x21b0('0x4e');if(fs[a0_0x21b0('0x43')](_0x456bc0)){let _0x247c73=fs[a0_0x21b0('0x7f')](_0x456bc0)[a0_0x21b0('0x96')]();const _0x589517=JSON[a0_0x21b0('0x89')](_0x247c73);_0x13c693['push']({'value':_0x589517['id'],'name':a0_0x21b0('0x48')+_0x589517['id']+a0_0x21b0('0x50')+_0x589517['name']+a0_0x21b0('0xf')+_0x589517[a0_0x21b0('0x47')]});}}catch(_0x5b1dec){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x469826['path']+a0_0x21b0('0x92')));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x5b1dec));}}}}catch(_0x2ecf22){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](a0_0x21b0('0x30')));console['log'](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')](_0x2ecf22));}return _0x13c693;}function getWidgetPath(_0x1c60d8){const _0x40c716=a0_0x21b0('0x81');let _0xa76125=fs[a0_0x21b0('0x7f')](_0x40c716)[a0_0x21b0('0x96')]();const _0x1a2ac3=JSON[a0_0x21b0('0x89')](_0xa76125);for(let _0x1c9304 of _0x1a2ac3[a0_0x21b0('0x26')]){const _0x7fe49e=a0_0x21b0('0x5a')+_0x1c9304[a0_0x21b0('0x61')]+a0_0x21b0('0x4e');let _0x5bc9b3=fs[a0_0x21b0('0x7f')](_0x7fe49e)[a0_0x21b0('0x96')]();const _0x2bd268=JSON[a0_0x21b0('0x89')](_0x5bc9b3);if(_0x2bd268['id']===_0x1c60d8){return _0x1c9304[a0_0x21b0('0x61')];}}console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x29')],chalk[a0_0x21b0('0x27')]('未找到匹配的widget：'+_0x1c60d8));}function startProxyServer(_0x44fd3a,_0x243479){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0x9')](a0_0x21b0('0xb')));var _0x4c5e42=express();_0x4c5e42[a0_0x21b0('0x72')]('/',proxy({'target':_0x44fd3a,'changeOrigin':!![],'pathRewrite':{'/core/widgets':a0_0x21b0('0x8e')},'router':{'/core/widgets':widgetDebugUrl}}));_0x4c5e42[a0_0x21b0('0x0')](proxyServerPort,function(){console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk['blue']('代理服务器已启动...'));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0x9')](a0_0x21b0('0x53')));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0x63')](a0_0x21b0('0x1c')));console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk[a0_0x21b0('0x63')](a0_0x21b0('0x75')));console[a0_0x21b0('0x35')](symbols['info'],chalk['green'](a0_0x21b0('0x3b')));console[a0_0x21b0('0x35')](symbols['info'],chalk['green']('OSX:\x20open\x20-n\x20-a\x20/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome\x20--args\x20--disable-web-security\x20--user-data-dir=\x22/tmp/chrome_tmp\x22'));ChromeLauncher['launch']({'startingUrl':a0_0x21b0('0xc')+proxyServerPort,'chromeFlags':[a0_0x21b0('0x7e'),a0_0x21b0('0x69'),a0_0x21b0('0x17'),a0_0x21b0('0x91')]})['then'](_0x3199ba=>{console[a0_0x21b0('0x35')](symbols['info'],chalk[a0_0x21b0('0x9')]('谷歌浏览器启动成功...'));});if(_0x243479){_0x243479();}});}function connectFtpServer(_0x2b4e87){const _0xb1cb10=new Client();const _0x591fd8=ora(a0_0x21b0('0x1a'));_0x591fd8[a0_0x21b0('0x64')]();_0xb1cb10['on'](a0_0x21b0('0x19'),function(){_0x591fd8[a0_0x21b0('0x22')]();console[a0_0x21b0('0x35')](symbols[a0_0x21b0('0x7c')],chalk['white'](a0_0x21b0('0x7b')));if(_0x2b4e87){_0x2b4e87(_0xb1cb10);}});_0xb1cb10['on'](a0_0x21b0('0x29'),function(_0x440fd7){_0x591fd8[a0_0x21b0('0x36')]();console[a0_0x21b0('0x35')](symbols['error'],chalk['red'](_0x440fd7));});_0xb1cb10[a0_0x21b0('0x55')]({'host':ftpServerAddress,'user':ftpServerUserName,'password':ftpServerPassword});}