#!/usr/bin/env node

const a0_0x4007=['cGFyc2U=','L2NvcmUvd2lkZ2V0cy8=','YXJndg==','cHVzaA==','Y29tbWFuZA==','cHVibGlzaA==','L19fcGF0aF9fLnR4dA==','LOeJiOacrDo=','V2lkZ2V05qih5p2/5paH5Lu25aS55LiN5a2Y5Zyo','cmVwbGFjZQ==','6K+36L6T5YWlV2lkZ2V05YiG57G75qCH562+77yM6KaB5rGC6Iux5paH5a2X5q+N77yM5aSa5Liq6YCX5Y+35YiG5Ymy','YWN0aW9u','YnVpbGRBbGw=','dXNl','LmRpc3QudGFy','6K+36L6T5YWlV2lkZ2V055qE5qCH6K+G77yM6KaB5rGC6Iux5paH44CB5pWw5a2X44CB5LiL5YiS57q/','cHJvbXB0','Y2hpbGRfcHJvY2Vzcw==','bG9nLXN5bWJvbHM=','LS1kaXNrLWNhY2hlLXNpemU9MQ==','Y3JlYXRlV3JpdGVTdHJlYW0=','ZGlzdC93aWRnZXRzLw==','YnVpbGQ=','5q2j5Zyo5Yib5bu6V2lkZ2V0Og==','5LiN5a2Y5Zyo','Y2hkaXI=','RnJlZXplU291bC9EYXRhQ29sb3VyV2lkZ2V0VGVtcGxhdGUjbWFzdGVy','c3RhcnQtd2lkZ2V0','LnNyYy50YXI=','ZG93bmxvYWQtZ2l0LXJlcG8=','YXV0aG9y','ZGF0YQ==','ZXJyb3I=','Li4u','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tcGF0aD0=','c3JjL3dpZGdldHMv','5aaC5rWP6KeI5Zmo5ZCv5Yqo5aSx6LSl77yM6K+36YCa6L+H5aaC5LiL5ZG95Luk6KGM5omL5bel5ZCv5Yqo77ya','6K+36L6T5YWlV2lkZ2V05L2c6ICF5ZCN56ew77yM5aaC77yaRnJlZXplU291bDxmcmVlemVzb3VsQGdtYWlsLmNvbT4=','YWxs','5a6M5oiQ5a6J6KOF5L6d6LWW57uE5Lu2Li4u','dGhlbg==','ZGVzY3JpcHRpb24=','aG9zdA==','cHVibGlzaC8=','d2hpdGU=','c2hpZnQ=','cmVk','c3Bhd24=','LS1kaXNhYmxlLXdlYi1zZWN1cml0eQ==','ZW5hYmxl','cmF3bGlzdA==','aW5xdWlyZXI=','d2lkZ2V0cw==','5b2T5YmNV2lkZ2V05qCH6K+G77ya','5p6E5bu65LiA5LiqV2lkZ2V0','6K+36YCJ5oup6KaB5Y+R5biD55qEV2lkZ2V0','ZXhpc3RzU3luYw==','6K+36YCJ5oup6KaB5p6E5bu655qEV2lkZ2V0','aGFuZGxlYmFycw==','bWtkaXJTeW5j','bmFtZQ==','V2lkZ2V05Yib5bu65oiQ5Yqf','dW5vZmZpY2lhbA==','5a6M5oiQ6aG555uu5Yid5aeL5YyW77yM6K+35Yib5bu65LiA5LiqV2lkZ2V0','cmVhZEZpbGVTeW5j','6LCD6K+V5LiA5LiqV2lkZ2V0','5ZCv5Yqo6LC35q2M5rWP6KeI5Zmo6LCD6K+VLi4u','LOWQjeensDo=','ZGVidWc=','c3VjY2Vzcw==','aW5mbw==','aHR0cC1wcm94eS1taWRkbGV3YXJl','ZXhlY1N5bmM=','bGF1bmNo','5Y+R5biD5omA5pyJV2lkZ2V0cw==','cGlwZQ==','5Yid5aeL5YyWV2lkZ2V06aG555uu','ZmFpbA==','5p6E5bu65omA5pyJV2lkZ2V0cw==','dmVyc2lvbg==','cGFjaw==','dG9JU09TdHJpbmc=','LS1tZWRpYS1jYWNoZS1zaXplPTE=','5qCH6K+GOg==','T1NYOiBvcGVuIC1uIC1hIC9BcHBsaWNhdGlvbnMvR29vZ2xlIENocm9tZS5hcHAvQ29udGVudHMvTWFjT1MvR29vZ2xlIENocm9tZSAtLWFyZ3MgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9Ii90bXAvY2hyb21lX3RtcCI=','dGFyLWZz','aHR0cDovLzEyNy4wLjAuMTo4MDg4Lw==','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','c3luYw==','cGFja2FnZS5qc29u','bG9n','L21hbmlmZXN0Lmpzb24=','Y2hyb21lLWxhdW5jaGVy','c3RyaW5naWZ5','cmVzb2x2ZQ==','5pyq5om+5Yiw5Yy56YWN55qEd2lkZ2V077ya','5Yib5bu65LiA5LiqV2lkZ2V0','cnVu','Ymx1ZQ==','aW5oZXJpdA==','LS0gLS1wYXRoPQ==','ZmluaXNo','dmFsdWU=','6LC35q2M5rWP6KeI5Zmo5ZCv5Yqo5oiQ5YqfLi4u','Z3JlZW4=','bW92ZVN5bmM=','L3dpZGdldHM=','5byA5aeL5a6J6KOF5L6d6LWW57uE5Lu2Li4u','c3Rkb3V0','c3JjL3dpZGdldHMvdGVtcGxhdGUvd2lkZ2V0','dGFn','6K+36L6T5YWlV2lkZ2V055qE5ZCN56ew77yM6KaB5rGC566A55+t55qE5Lit5paH5ZCN56ew5a6a5LmJ','6K+36L6T5YWl5bmz5Y+w5pyN5Yqh5Zyw5Z2A77yM6buY6K6k6LCD55So5YWs5YWx5pyN5Yqh','c3VjY2VlZA==','bGlzdA==','bGlzdGVu','V2lkZ2V0Og==','Y29tbWFuZGVy','5q2j5Zyo5LiL6L29V2lkZ2V05qih5p2/Li4u','d2lkZ2V0cy5qc29u6K+75Y+W5aSx6LSl','c3RhcnQ=','aHR0cDovLzM5LjEwMS4xMzguNDM6ODA4MA==','Y3JlYXRl','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','d3JpdGVGaWxlU3luYw==','cGF0aA==','Y2hhbGs=','LXYsIC0tdmVyc2lvbg==','Q2hhcnQ=','LS11c2VyLWRhdGEtZGlyPS4vY2hyb21lX3RtcA==','5bey5a2Y5Zyo','dG9TdHJpbmc=','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','5bey5a2Y5Zyo5a+55bqU55uu5b2V'];(function(_0x292272,_0x5bbaab){const _0x4d79ac=function(_0x558f40){while(--_0x558f40){_0x292272['push'](_0x292272['shift']());}};_0x4d79ac(++_0x5bbaab);}(a0_0x4007,0x103));const a0_0x41d6=function(_0x292272,_0x5bbaab){_0x292272=_0x292272-0x0;let _0x4d79ac=a0_0x4007[_0x292272];if(a0_0x41d6['SNuBsv']===undefined){(function(){let _0x1d50d5;try{const _0x51854e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1d50d5=_0x51854e();}catch(_0x4da097){_0x1d50d5=window;}const _0x3673a1='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x1d50d5['atob']||(_0x1d50d5['atob']=function(_0x26c334){const _0x1d9064=String(_0x26c334)['replace'](/=+$/,'');let _0x132f09='';for(let _0x42d44b=0x0,_0x3656fe,_0x3684bf,_0x6e07fa=0x0;_0x3684bf=_0x1d9064['charAt'](_0x6e07fa++);~_0x3684bf&&(_0x3656fe=_0x42d44b%0x4?_0x3656fe*0x40+_0x3684bf:_0x3684bf,_0x42d44b++%0x4)?_0x132f09+=String['fromCharCode'](0xff&_0x3656fe>>(-0x2*_0x42d44b&0x6)):0x0){_0x3684bf=_0x3673a1['indexOf'](_0x3684bf);}return _0x132f09;});}());a0_0x41d6['KqJhXb']=function(_0x1acbad){const _0x270ee0=atob(_0x1acbad);let _0x40ddd9=[];for(let _0x3d1df2=0x0,_0x13db87=_0x270ee0['length'];_0x3d1df2<_0x13db87;_0x3d1df2++){_0x40ddd9+='%'+('00'+_0x270ee0['charCodeAt'](_0x3d1df2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x40ddd9);};a0_0x41d6['fCwuIU']={};a0_0x41d6['SNuBsv']=!![];}const _0x558f40=a0_0x41d6['fCwuIU'][_0x292272];if(_0x558f40===undefined){_0x4d79ac=a0_0x41d6['KqJhXb'](_0x4d79ac);a0_0x41d6['fCwuIU'][_0x292272]=_0x4d79ac;}else{_0x4d79ac=_0x558f40;}return _0x4d79ac;};const fs=require('fs');const fse=require('fs-extra');const path=require(a0_0x41d6('0x0'));const ora=require('ora');const tar=require(a0_0x41d6('0x5e'));const chalk=require(a0_0x41d6('0x1'));const express=require('express');const copydir=require('copy-dir');const program=require(a0_0x41d6('0x7e'));const inquirer=require(a0_0x41d6('0x3c'));const symbols=require(a0_0x41d6('0x1b'));const handlebars=require(a0_0x41d6('0x43'));const proxy=require(a0_0x41d6('0x50'));const download=require(a0_0x41d6('0x26'));const child_process=require(a0_0x41d6('0x1a'));const ChromeLauncher=require(a0_0x41d6('0x65'));const githublink=a0_0x41d6('0x23');const dcServerAddress=a0_0x41d6('0x82');const widgetDebugUrl=a0_0x41d6('0x5f');const proxyServerPort=0x1f90;try{const packagePath=path[a0_0x41d6('0x67')](__dirname,a0_0x41d6('0x62'));if(fs['existsSync'](packagePath)){const pjson=require(packagePath);const version=pjson['version'];program[a0_0x41d6('0x58')](version,a0_0x41d6('0x2'));}}catch(a0_0x89a82b){}program[a0_0x41d6('0xd')]('init\x20<name>')['description'](a0_0x41d6('0x55'))[a0_0x41d6('0x14')](_0x48dc43=>{if(!fs[a0_0x41d6('0x41')](_0x48dc43)){console['log'](symbols[a0_0x41d6('0x4f')],chalk['white'](a0_0x41d6('0x55')));const _0x48dca3=ora(a0_0x41d6('0x7f'));_0x48dca3[a0_0x41d6('0x81')]();download(githublink,_0x48dc43,{'clone':![]},_0x46ea63=>{if(_0x46ea63){_0x48dca3[a0_0x41d6('0x56')]();console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x46ea63));}else{_0x48dca3[a0_0x41d6('0x7a')]();process[a0_0x41d6('0x22')](_0x48dc43);console[a0_0x41d6('0x63')](symbols['info'],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x74')));child_process['execSync']('npm\x20install',{'stdio':a0_0x41d6('0x6c')});console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x30')));console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x48')));}});}else{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')]('项目'+_0x48dc43+a0_0x41d6('0x5')));}});program[a0_0x41d6('0xd')](a0_0x41d6('0x7b'))[a0_0x41d6('0x32')]('列出所有Widget')['action'](()=>{try{const _0x2de4f0=a0_0x41d6('0x60');if(fs[a0_0x41d6('0x41')](_0x2de4f0)){const _0x2194b5=fs['readFileSync'](_0x2de4f0)['toString']();const _0x5cc112=JSON[a0_0x41d6('0x9')](_0x2194b5);for(let _0x1fdae7 of _0x5cc112[a0_0x41d6('0x3d')]){const _0x340041='src/widgets/'+_0x1fdae7[a0_0x41d6('0x0')];const _0x4b7fe2=_0x340041+'/manifest.json';if(fs[a0_0x41d6('0x41')](_0x4b7fe2)){let _0x685ba2=fs['readFileSync'](_0x4b7fe2)[a0_0x41d6('0x6')]();const _0x52b302=JSON[a0_0x41d6('0x9')](_0x685ba2);console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x5c')+_0x52b302['id']+a0_0x41d6('0x4c')+_0x52b302[a0_0x41d6('0x45')]+a0_0x41d6('0x10')+_0x52b302[a0_0x41d6('0x58')]));}}}}catch(_0x5dde36){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x5dde36));}});program['command'](a0_0x41d6('0x83'))['description'](a0_0x41d6('0x69'))[a0_0x41d6('0x14')](()=>{inquirer['prompt']([{'name':'id','message':a0_0x41d6('0x18')},{'name':a0_0x41d6('0x45'),'message':a0_0x41d6('0x78')},{'name':a0_0x41d6('0x32'),'message':'请输入Widget的描述，要求简短的中文描述信息'},{'name':a0_0x41d6('0x77'),'message':a0_0x41d6('0x13')},{'name':a0_0x41d6('0x27'),'message':a0_0x41d6('0x2e')},{'name':a0_0x41d6('0x0'),'message':'请输入Widget存储路径，默认路径unofficial，建议默认'}])[a0_0x41d6('0x31')](_0x45b51c=>{try{const _0x4b01c6=_0x45b51c['id'];const _0x96492b=_0x45b51c[a0_0x41d6('0x45')];const _0x5182c9=_0x45b51c[a0_0x41d6('0x32')];const _0x1d981e=_0x45b51c['author'];const _0x5318e1=_0x45b51c[a0_0x41d6('0x77')]?_0x45b51c[a0_0x41d6('0x77')]:a0_0x41d6('0x3');const _0x128117=_0x45b51c[a0_0x41d6('0x0')]?_0x45b51c[a0_0x41d6('0x0')][a0_0x41d6('0x12')](/^\/+|\/+$/g,''):a0_0x41d6('0x47');const _0x12ea91=createWidget(_0x4b01c6,_0x96492b,_0x5182c9,_0x1d981e,_0x5318e1,_0x128117);if(_0x12ea91){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4e')],chalk[a0_0x41d6('0x71')](a0_0x41d6('0x46')));}}catch(_0x4bb93b){console['log'](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x4bb93b));}});});program[a0_0x41d6('0xd')](a0_0x41d6('0x4d'))[a0_0x41d6('0x32')](a0_0x41d6('0x4a'))[a0_0x41d6('0x14')](()=>{inquirer[a0_0x41d6('0x19')]([{'name':'id','message':'请选择要调试的Widget','type':'rawlist','choices':getWidgetsList()},{'name':'host','message':a0_0x41d6('0x79')}])[a0_0x41d6('0x31')](_0x27eef7=>{try{const _0x24334b=_0x27eef7['id'];const _0x4d91c3=getWidgetPath(_0x24334b);const _0x43210e=_0x27eef7[a0_0x41d6('0x33')]?_0x27eef7['host']:dcServerAddress;const _0x3ff313=a0_0x41d6('0x2c')+_0x4d91c3+a0_0x41d6('0x64');if(fs[a0_0x41d6('0x41')](_0x3ff313)){const _0x280ac3=a0_0x41d6('0x60');let _0x2ea0aa=fs['readFileSync'](_0x280ac3)[a0_0x41d6('0x6')]();const _0xddde85=JSON['parse'](_0x2ea0aa);_0xddde85[a0_0x41d6('0x58')]=getNextVersion(_0xddde85[a0_0x41d6('0x58')]);for(let _0x2976ba of _0xddde85[a0_0x41d6('0x3d')]){_0x2976ba[a0_0x41d6('0x3a')]=_0x2976ba['path']===_0x4d91c3;}_0x2ea0aa=JSON['stringify'](_0xddde85,null,0x2);fs[a0_0x41d6('0x85')](_0x280ac3,_0x2ea0aa);let _0x4940e4=fs[a0_0x41d6('0x49')](_0x3ff313)[a0_0x41d6('0x6')]();const _0xb21f15=JSON[a0_0x41d6('0x9')](_0x4940e4);_0xb21f15[a0_0x41d6('0x58')]=getNextVersion(_0xb21f15['version']);_0x4940e4=JSON['stringify'](_0xb21f15,null,0x2);fs[a0_0x41d6('0x85')](_0x3ff313,_0x4940e4);console[a0_0x41d6('0x63')](symbols['info'],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x84')+_0xb21f15[a0_0x41d6('0x58')]));startProxyServer(_0x43210e,function(){const _0x121393=child_process[a0_0x41d6('0x38')]('npm',[a0_0x41d6('0x6a'),a0_0x41d6('0x24'),a0_0x41d6('0x6d')+_0x4d91c3],{'shell':!![]});_0x121393[a0_0x41d6('0x75')]['on'](a0_0x41d6('0x28'),function(_0x10919d){console[a0_0x41d6('0x63')](_0x10919d[a0_0x41d6('0x6')]());});_0x121393['stderr']['on']('data',function(_0x1c4041){console[a0_0x41d6('0x63')](_0x1c4041[a0_0x41d6('0x6')]());});});}else{console['log'](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x7d')+_0x24334b+a0_0x41d6('0x21')));}}catch(_0x4f6aaa){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x4f6aaa));}});});program[a0_0x41d6('0xd')]('build')[a0_0x41d6('0x32')](a0_0x41d6('0x3f'))[a0_0x41d6('0x14')](()=>{inquirer[a0_0x41d6('0x19')]([{'name':'id','message':a0_0x41d6('0x42'),'type':a0_0x41d6('0x3b'),'choices':getWidgetsList()}])[a0_0x41d6('0x31')](_0x40f62a=>{try{const _0x306e28=_0x40f62a['id'];const _0x2c9a71=getWidgetPath(_0x306e28);const _0x2c1bdb=a0_0x41d6('0x2c')+_0x2c9a71+'/manifest.json';if(fs[a0_0x41d6('0x41')](_0x2c1bdb)){let _0x271434=fs[a0_0x41d6('0x49')](_0x2c1bdb)[a0_0x41d6('0x6')]();const _0x4b3463=JSON[a0_0x41d6('0x9')](_0x271434);_0x4b3463['version']=getNextVersion(_0x4b3463[a0_0x41d6('0x58')]);_0x271434=JSON[a0_0x41d6('0x66')](_0x4b3463,null,0x2);fs[a0_0x41d6('0x85')](_0x2c1bdb,_0x271434);console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['white'](a0_0x41d6('0x84')+_0x4b3463[a0_0x41d6('0x58')]));child_process['execSync'](a0_0x41d6('0x2b')+_0x2c9a71,{'stdio':a0_0x41d6('0x6c')});}else{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk['red'](a0_0x41d6('0x7d')+_0x306e28+a0_0x41d6('0x21')));}}catch(_0xba3317){console[a0_0x41d6('0x63')](symbols['error'],chalk[a0_0x41d6('0x37')](_0xba3317));}});});program[a0_0x41d6('0xd')](a0_0x41d6('0x15'))[a0_0x41d6('0x32')](a0_0x41d6('0x57'))['action'](()=>{try{const _0x26b108=getWidgetsList();for(let _0x147256 of _0x26b108){const _0x13266c=_0x147256[a0_0x41d6('0x6f')];const _0x11832f=getWidgetPath(_0x13266c);const _0x4f399b='src/widgets/'+_0x11832f+a0_0x41d6('0x64');if(fs[a0_0x41d6('0x41')](_0x4f399b)){let _0x19b5b7=fs[a0_0x41d6('0x49')](_0x4f399b)[a0_0x41d6('0x6')]();const _0xafeba4=JSON[a0_0x41d6('0x9')](_0x19b5b7);_0xafeba4[a0_0x41d6('0x58')]=getNextVersion(_0xafeba4['version']);_0x19b5b7=JSON[a0_0x41d6('0x66')](_0xafeba4,null,0x2);fs[a0_0x41d6('0x85')](_0x4f399b,_0x19b5b7);console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['white'](a0_0x41d6('0x3e')+_0x13266c));console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x84')+_0xafeba4[a0_0x41d6('0x58')]));child_process['execSync'](a0_0x41d6('0x2b')+_0x11832f,{'stdio':'inherit'});console['log'](symbols[a0_0x41d6('0x4e')],chalk[a0_0x41d6('0x71')]('完成构建Widget：'+_0xafeba4[a0_0x41d6('0x58')]));const _0x3a4a62=a0_0x41d6('0x1e')+_0x11832f;const _0x258eb='build/'+_0x11832f;if(!fs['existsSync'](a0_0x41d6('0x1f'))){fs[a0_0x41d6('0x44')]('build');}if(fs['existsSync'](_0x3a4a62)){fse[a0_0x41d6('0x72')](_0x3a4a62,_0x258eb);}}else{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')]('Widget:'+_0x13266c+a0_0x41d6('0x21')));}}}catch(_0x58f9c2){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x58f9c2));}});program[a0_0x41d6('0xd')](a0_0x41d6('0xe'))[a0_0x41d6('0x32')]('发布一个Widget')[a0_0x41d6('0x14')](()=>{inquirer[a0_0x41d6('0x19')]([{'name':'id','message':a0_0x41d6('0x40'),'type':a0_0x41d6('0x3b'),'choices':getWidgetsList()}])[a0_0x41d6('0x31')](_0x34a5c5=>{try{const _0x151e72=_0x34a5c5['id'];const _0x59c44b=getWidgetPath(_0x151e72);const _0x5984ac=a0_0x41d6('0x2c')+_0x59c44b;const _0x122b71=a0_0x41d6('0x1e')+_0x59c44b;const _0x253007=_0x5984ac+a0_0x41d6('0x64');const _0x5491ec=new Date()[a0_0x41d6('0x5a')]()[a0_0x41d6('0x12')](/T/,'')[a0_0x41d6('0x12')](/\..+/,'')['replace'](/-/g,'')[a0_0x41d6('0x12')](/:/g,'');const _0x20b29e=_0x151e72+'.'+_0x5491ec;const _0x2d53ff=_0x20b29e+a0_0x41d6('0x25');const _0x1649e3=_0x20b29e+a0_0x41d6('0x17');const _0x11a557=a0_0x41d6('0x34')+_0x2d53ff;const _0x8a5fe2=a0_0x41d6('0x34')+_0x1649e3;if(!fs[a0_0x41d6('0x41')](a0_0x41d6('0xe'))){fs[a0_0x41d6('0x44')](a0_0x41d6('0xe'));}if(fs[a0_0x41d6('0x41')](_0x253007)){let _0x39f752=fs['readFileSync'](_0x253007)[a0_0x41d6('0x6')]();const _0x3ebd3a=JSON[a0_0x41d6('0x9')](_0x39f752);_0x3ebd3a[a0_0x41d6('0x58')]=getNextVersion(_0x3ebd3a[a0_0x41d6('0x58')]);_0x39f752=JSON[a0_0x41d6('0x66')](_0x3ebd3a,null,0x2);fs[a0_0x41d6('0x85')](_0x253007,_0x39f752);console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x84')+_0x3ebd3a[a0_0x41d6('0x58')]));child_process[a0_0x41d6('0x51')](a0_0x41d6('0x2b')+_0x59c44b,{'stdio':a0_0x41d6('0x6c')});fs['writeFileSync'](_0x5984ac+a0_0x41d6('0xf'),_0x59c44b);fs[a0_0x41d6('0x85')](_0x122b71+a0_0x41d6('0xf'),_0x59c44b);tar['pack'](_0x5984ac)[a0_0x41d6('0x54')](fs[a0_0x41d6('0x1d')](_0x11a557));tar[a0_0x41d6('0x59')](_0x122b71)['pipe'](fs[a0_0x41d6('0x1d')](_0x8a5fe2));}else{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x7d')+_0x151e72+a0_0x41d6('0x21')));}}catch(_0x56d98c){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x56d98c));}});});program[a0_0x41d6('0xd')]('publishAll')[a0_0x41d6('0x32')](a0_0x41d6('0x53'))[a0_0x41d6('0x14')](()=>{try{const _0x4cec23=getWidgetsList();const _0x81f352=function(){const _0x4c7105=_0x4cec23[a0_0x41d6('0x36')]();if(!_0x4c7105)return;const _0x4f58db=_0x4c7105[a0_0x41d6('0x6f')];const _0x327add=getWidgetPath(_0x4f58db);const _0x330023=a0_0x41d6('0x2c')+_0x327add;const _0x5b8559=a0_0x41d6('0x1e')+_0x327add;const _0x176494=_0x330023+'/manifest.json';const _0x2ee57d=new Date()[a0_0x41d6('0x5a')]()['replace'](/T/,'')['replace'](/\..+/,'')['replace'](/-/g,'')[a0_0x41d6('0x12')](/:/g,'');const _0x1542a9=_0x4f58db+'.'+_0x2ee57d;const _0x461e27=_0x1542a9+'.src.tar';const _0x34656f=_0x1542a9+a0_0x41d6('0x17');const _0x73dbfb=a0_0x41d6('0x34')+_0x461e27;const _0x3cd8fc='publish/'+_0x34656f;if(!fs[a0_0x41d6('0x41')](a0_0x41d6('0xe'))){fs['mkdirSync'](a0_0x41d6('0xe'));}if(fs[a0_0x41d6('0x41')](_0x176494)){let _0x64a05d=fs[a0_0x41d6('0x49')](_0x176494)[a0_0x41d6('0x6')]();const _0x3db159=JSON[a0_0x41d6('0x9')](_0x64a05d);_0x3db159[a0_0x41d6('0x58')]=getNextVersion(_0x3db159['version']);_0x64a05d=JSON[a0_0x41d6('0x66')](_0x3db159,null,0x2);fs['writeFileSync'](_0x176494,_0x64a05d);console[a0_0x41d6('0x63')](symbols['info'],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x84')+_0x3db159[a0_0x41d6('0x58')]));child_process[a0_0x41d6('0x51')](a0_0x41d6('0x2b')+_0x327add,{'stdio':a0_0x41d6('0x6c')});fs['writeFileSync'](_0x330023+a0_0x41d6('0xf'),_0x327add);fs[a0_0x41d6('0x85')](_0x5b8559+a0_0x41d6('0xf'),_0x327add);var _0x54ab45=new Promise((_0x3b3054,_0x59a8d3)=>{tar[a0_0x41d6('0x59')](_0x330023)[a0_0x41d6('0x54')](fs[a0_0x41d6('0x1d')](_0x73dbfb))['on'](a0_0x41d6('0x6e'),()=>{_0x3b3054(!![]);})['on'](a0_0x41d6('0x29'),_0x2eb586=>{_0x59a8d3(_0x2eb586);});});var _0xbf8ea6=new Promise((_0x181ec5,_0x43977c)=>{tar[a0_0x41d6('0x59')](_0x5b8559)['pipe'](fs[a0_0x41d6('0x1d')](_0x3cd8fc))['on']('finish',()=>{_0x181ec5(!![]);})['on'](a0_0x41d6('0x29'),_0x4d6dea=>{_0x43977c(_0x4d6dea);});});Promise[a0_0x41d6('0x2f')]([_0x54ab45,_0xbf8ea6])[a0_0x41d6('0x31')](()=>{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')]('Widget已发布：'+_0x4f58db));_0x81f352();});}else{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x7d')+_0x4f58db+a0_0x41d6('0x21')));}};_0x81f352();}catch(_0x343398){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x343398));}});program[a0_0x41d6('0x9')](process[a0_0x41d6('0xb')]);function createWidget(_0x244ecf,_0x493c52,_0xb71f94,_0x210726,_0x37ca72,_0x468431){if(!_0x244ecf||!_0x493c52||!_0xb71f94||!_0x37ca72||!_0x468431){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')]('请提供完整的Widget信息'));return![];}console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x20')+_0x244ecf+a0_0x41d6('0x2a')));try{const _0x507b70=_0x468431+'/'+_0x244ecf;const _0x2646b3=a0_0x41d6('0x2c')+_0x468431;const _0x466f5c=a0_0x41d6('0x2c')+_0x507b70;const _0xaadaa=a0_0x41d6('0x76');if(!fs[a0_0x41d6('0x41')](_0x2646b3)){fs[a0_0x41d6('0x44')](_0x2646b3);}if(!fs[a0_0x41d6('0x41')](_0xaadaa)){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x11')));return![];}if(fs[a0_0x41d6('0x41')](_0x466f5c)){console[a0_0x41d6('0x63')](symbols['error'],chalk['red'](a0_0x41d6('0x7d')+_0x244ecf+a0_0x41d6('0x8')));return![];}copydir[a0_0x41d6('0x61')](_0xaadaa,_0x466f5c);const _0x5673b4=_0x466f5c+a0_0x41d6('0x64');let _0x2a9937=fs[a0_0x41d6('0x49')](_0x5673b4)[a0_0x41d6('0x6')]();const _0x2d68c0=JSON[a0_0x41d6('0x9')](_0x2a9937);_0x2d68c0['id']=_0x244ecf;_0x2d68c0[a0_0x41d6('0x77')]=_0x37ca72;_0x2d68c0[a0_0x41d6('0x45')]=_0x493c52;_0x2d68c0[a0_0x41d6('0x32')]=_0xb71f94;_0x2d68c0[a0_0x41d6('0x27')]=_0x210726;_0x2a9937=JSON['stringify'](_0x2d68c0,null,0x2);fs[a0_0x41d6('0x85')](_0x5673b4,_0x2a9937);const _0x41bb8d=a0_0x41d6('0x60');let _0x411f33=fs[a0_0x41d6('0x49')](_0x41bb8d)[a0_0x41d6('0x6')]();const _0x2296c5=JSON[a0_0x41d6('0x9')](_0x411f33);_0x2296c5['version']=getNextVersion(_0x2296c5[a0_0x41d6('0x58')]);for(let _0x3ab10b of _0x2296c5['widgets']){_0x3ab10b[a0_0x41d6('0x3a')]=![];}_0x2296c5['widgets']['push']({'group':'测试','path':_0x507b70,'enable':!![]});_0x411f33=JSON[a0_0x41d6('0x66')](_0x2296c5,null,0x2);fs[a0_0x41d6('0x85')](_0x41bb8d,_0x411f33);console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x35')](a0_0x41d6('0x7')+_0x244ecf+'...'));}catch(_0x785004){console[a0_0x41d6('0x63')](symbols['error'],chalk[a0_0x41d6('0x37')](_0x785004));return![];}return!![];}function getNextVersion(_0xc2b317){if(_0xc2b317){const _0x12de34=_0xc2b317['match'](/(.*\.)(\d+)$/);if(_0x12de34&&_0x12de34[0x1]&&_0x12de34[0x2]){return''+_0x12de34[0x1]+(parseInt(_0x12de34[0x2])+0x1);}}return _0xc2b317;}function getWidgetsList(){const _0x59ff5=[];try{const _0x2565ad=a0_0x41d6('0x60');if(fs[a0_0x41d6('0x41')](_0x2565ad)){const _0x2bcdfc=fs[a0_0x41d6('0x49')](_0x2565ad)[a0_0x41d6('0x6')]();const _0x2cf8a3=JSON[a0_0x41d6('0x9')](_0x2bcdfc);for(let _0x348d69 of _0x2cf8a3[a0_0x41d6('0x3d')]){try{const _0x1e5e46=a0_0x41d6('0x2c')+_0x348d69['path'];const _0x2f0cfe=_0x1e5e46+a0_0x41d6('0x64');if(fs[a0_0x41d6('0x41')](_0x2f0cfe)){let _0x2e7705=fs[a0_0x41d6('0x49')](_0x2f0cfe)['toString']();const _0x17d2ea=JSON['parse'](_0x2e7705);_0x59ff5[a0_0x41d6('0xc')]({'value':_0x17d2ea['id'],'name':a0_0x41d6('0x5c')+_0x17d2ea['id']+a0_0x41d6('0x4c')+_0x17d2ea[a0_0x41d6('0x45')]+a0_0x41d6('0x10')+_0x17d2ea[a0_0x41d6('0x58')]});}}catch(_0xbfa91e){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](_0x348d69['path']+'读取失败'));console[a0_0x41d6('0x63')](symbols['error'],chalk[a0_0x41d6('0x37')](_0xbfa91e));}}}}catch(_0x5b0968){console['log'](symbols['error'],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x80')));console['log'](symbols['error'],chalk[a0_0x41d6('0x37')](_0x5b0968));}return _0x59ff5;}function getWidgetPath(_0x4555db){const _0x130d18=a0_0x41d6('0x60');let _0x4bce48=fs[a0_0x41d6('0x49')](_0x130d18)['toString']();const _0x5cbae3=JSON[a0_0x41d6('0x9')](_0x4bce48);for(let _0x1cc9ee of _0x5cbae3[a0_0x41d6('0x3d')]){const _0x36355e=a0_0x41d6('0x2c')+_0x1cc9ee[a0_0x41d6('0x0')]+a0_0x41d6('0x64');let _0x1742b3=fs['readFileSync'](_0x36355e)[a0_0x41d6('0x6')]();const _0x73655b=JSON[a0_0x41d6('0x9')](_0x1742b3);if(_0x73655b['id']===_0x4555db){return _0x1cc9ee['path'];}}console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x29')],chalk[a0_0x41d6('0x37')](a0_0x41d6('0x68')+_0x4555db));}function startProxyServer(_0x23a634,_0x7d9651){console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['blue']('正在启动代理服务...'));var _0x39d116=express();var _0x3cffe9={'/core/widgets':a0_0x41d6('0x73')};var _0xbf130f={};_0xbf130f[a0_0x41d6('0xa')]=widgetDebugUrl;_0x39d116[a0_0x41d6('0x16')]('/',proxy({'target':_0x23a634,'changeOrigin':!![],'pathRewrite':_0x3cffe9,'router':_0xbf130f}));_0x39d116[a0_0x41d6('0x7c')](proxyServerPort,function(){console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x6b')]('代理服务器已启动...'));console[a0_0x41d6('0x63')](symbols['info'],chalk[a0_0x41d6('0x6b')](a0_0x41d6('0x4b')));console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x71')](a0_0x41d6('0x2d')));console['log'](symbols[a0_0x41d6('0x4f')],chalk[a0_0x41d6('0x71')]('Window:\x20\x22C:Program\x20Files\x20(x86)GoogleChromeApplicationchrome.exe\x22\x20--disable-web-security\x20--user-data-dir=~/chrome_tmp'));console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['green']('Linux:\x20/opt/google/chrome/chrome\x20--disable-web-security\x20--user-data-dir=/tmp/chrome_tmp'));console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['green'](a0_0x41d6('0x5d')));ChromeLauncher[a0_0x41d6('0x52')]({'startingUrl':'http://127.0.0.1:'+proxyServerPort,'chromeFlags':[a0_0x41d6('0x39'),a0_0x41d6('0x4'),a0_0x41d6('0x5b'),a0_0x41d6('0x1c')]})[a0_0x41d6('0x31')](_0x4242ec=>{console[a0_0x41d6('0x63')](symbols[a0_0x41d6('0x4f')],chalk['blue'](a0_0x41d6('0x70')));});if(_0x7d9651){_0x7d9651();}});}