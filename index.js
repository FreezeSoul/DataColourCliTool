#!/usr/bin/env node

const a0_0x2450=['bGF1bmNo','cHVzaA==','ZXhpc3RzU3luYw==','c3RhcnQtd2lkZ2V0','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','5bey5a2Y5Zyo5a+55bqU55uu5b2V','6K+36L6T5YWlV2lkZ2V055qE5o+P6L+w77yM6KaB5rGC566A55+t55qE5Lit5paH5o+P6L+w5L+h5oGv','bW92ZVN5bmM=','6K+36L6T5YWlV2lkZ2V055qE5ZCN56ew77yM6KaB5rGC566A55+t55qE5Lit5paH5ZCN56ew5a6a5LmJ','Li4u','dmVyc2lvbg==','V2lkZ2V05qih5p2/5paH5Lu25aS55LiN5a2Y5Zyo','bGVuZ3Ro','6K+36L6T5YWlV2lkZ2V055qE5qCH6K+G77yM6KaB5rGC6Iux5paH44CB5pWw5a2X44CB5LiL5YiS57q/','aHR0cDovLzEyNy4wLjAuMTo=','cGFja2FnZS5qc29u','ZXhwcmVzcw==','cHV0','L19fcGF0aF9fLnR4dA==','dG9JU09TdHJpbmc=','RnJlZXplU291bC9EYXRhQ29sb3VyV2lkZ2V0VGVtcGxhdGUjbWFzdGVy','LOWQjeensDo=','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','ZXJyb3I=','Y29weS1kaXI=','cHVibGlzaA==','c3RkZXJy','Y29ubmVjdA==','d3JpdGVGaWxlU3luYw==','6K+36L6T5YWlV2lkZ2V05YiG57G75qCH562+77yM6KaB5rGC6Iux5paH5a2X5q+N77yM5aSa5Liq6YCX5Y+35YiG5Ymy','c3RyaW5naWZ5','dG9TdHJpbmc=','5Yid5aeL5YyWV2lkZ2V06aG555uu','5q2j5Zyo5Yib5bu6V2lkZ2V0Og==','Q2hhcnQ=','T1NYOiBvcGVuIC1uIC1hIC9BcHBsaWNhdGlvbnMvR29vZ2xlIENocm9tZS5hcHAvQ29udGVudHMvTWFjT1MvR29vZ2xlIENocm9tZSAtLWFyZ3MgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9Ii90bXAvY2hyb21lX3RtcCI=','L21hbmlmZXN0Lmpzb24=','YnVpbGRBbGw=','YWN0aW9u','aHR0cC1wcm94eS1taWRkbGV3YXJl','YXV0aG9y','cHJvbXB0','LOeJiOacrDo=','6K+35Y+N6aaI5Y+R5biD5bqP5Y+3Og==','6K+36L6T5YWlV2lkZ2V05a2Y5YKo6Lev5b6E77yM6buY6K6k6Lev5b6EdW5vZmZpY2lhbO+8jOW7uuiurum7mOiupA==','ZGVzY3JpcHRpb24=','LS0gLS1wYXRoPQ==','dXNl','c3luYw==','bGlzdGVu','dGhlbg==','5aaC5rWP6KeI5Zmo5ZCv5Yqo5aSx6LSl77yM6K+36YCa6L+H5aaC5LiL5ZG95Luk6KGM5omL5bel5ZCv5Yqo77ya','b3Jh','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','YnVpbGQv','LS1kaXNrLWNhY2hlLXNpemU9MQ==','5p6E5bu65omA5pyJV2lkZ2V0cw==','bWF0Y2g=','5b2T5YmNV2lkZ2V05qCH6K+G77ya','c3VjY2Vzcw==','5YiX5Ye65omA5pyJV2lkZ2V0','5LiN5a2Y5Zyo','Z3JlZW4=','dGFyLWZz','5a6M5oiQ5a6J6KOF5L6d6LWW57uE5Lu2Li4u','cmVhZEZpbGVTeW5j','c3VjY2VlZA==','LnNyYy50YXI=','5byA5aeL5a6J6KOF5L6d6LWW57uE5Lu2Li4u','5byA5aeL5bu656uL5pyN5Yqh5Zmo6L+e5o6lLi4u','c3Bhd24=','dW5vZmZpY2lhbA==','cHVibGlzaC8=','ZnRw','6K+356Gu6K6k5piv5ZCm5aSH5Lu96Iez5YWs5YWx5o+S5Lu25Lit5b+D77yM6K+36L6T5YWleS9uKOm7mOiupG4p','ZmFpbA==','bGlzdA==','5qCH6K+GOg==','bmFtZQ==','6LCD6K+V5LiA5LiqV2lkZ2V0','c3RhdFN5bmM=','5q2j5Zyo5ZCv5Yqo5Luj55CG5pyN5YqhLi4u','d2hpdGU=','6K+75Y+W5aSx6LSl','ZnMtZXh0cmE=','cmVk','cGFyc2U=','5pyN5Yqh5Zmo6L+e5o6l5bey5bu656uLLi4u','Y2hkaXI=','LS11c2VyLWRhdGEtZGlyPS4vY2hyb21lX3RtcA==','cGFjaw==','ZGlzdC93aWRnZXRzLw==','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tcGF0aD0=','YnVpbGQ=','ZW5hYmxl','bWtkaXJTeW5j','5bey5a2Y5Zyo','LmRpc3QudGFy','Y3JlYXRlV3JpdGVTdHJlYW0=','6K+36L6T5YWlV2lkZ2V05L2c6ICF5ZCN56ew77yM5aaC77yaRnJlZXplU291bDxmcmVlemVzb3VsQGdtYWlsLmNvbT4=','cnVu','Y3JlYXRlUmVhZFN0cmVhbQ==','ZGVidWc=','bG9n','V2lkZ2V0Og==','c3RhcnQ=','aW5xdWlyZXI=','cGlwZQ==','ZG93bmxvYWQtZ2l0LXJlcG8=','5p6E5bu65LiA5LiqV2lkZ2V0','ZGF0YWNvbG91cg==','Y2hpbGRfcHJvY2Vzcw==','aHR0cDovLzM5LjEwMS4xMzguNDM6ODA4MA==','cHVibGlzaEFsbA==','dGV4dA==','5q2j5Zyo5LiL6L29V2lkZ2V05qih5p2/Li4u','aW5mbw==','ZXhlY1N5bmM=','d2lkZ2V0cw==','5pyq5om+5Yiw5Yy56YWN55qEd2lkZ2V077ya','cmVwbGFjZQ==','c3JjL3dpZGdldHMv','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4u','Y2hyb21lLWxhdW5jaGVy','6LC35q2M5rWP6KeI5Zmo5ZCv5Yqo5oiQ5YqfLi4u','Ymx1ZQ==','V2lkZ2V05Yib5bu65oiQ5Yqf','c3Rkb3V0','cmVzb2x2ZQ==','dGFn','dG9GaXhlZA==','LS1tZWRpYS1jYWNoZS1zaXplPTE=','5Luj55CG5pyN5Yqh5Zmo5bey5ZCv5YqoLi4u','cGF0aA==','5a6M5oiQ6aG555uu5Yid5aeL5YyW77yM6K+35Yib5bu65LiA5LiqV2lkZ2V0','bnBtIGluc3RhbGw=','Y29tbWFuZA==','aW5oZXJpdA==','aG9zdA==','ZGF0YQ==','L3dpZGdldHM='];(function(_0x428931,_0x20ed3f){const _0x21caa5=function(_0x343c8e){while(--_0x343c8e){_0x428931['push'](_0x428931['shift']());}};_0x21caa5(++_0x20ed3f);}(a0_0x2450,0x1a0));const a0_0x19d4=function(_0x428931,_0x20ed3f){_0x428931=_0x428931-0x0;let _0x21caa5=a0_0x2450[_0x428931];if(a0_0x19d4['pbnCar']===undefined){(function(){let _0xf17c8e;try{const _0x4910a6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xf17c8e=_0x4910a6();}catch(_0x259805){_0xf17c8e=window;}const _0x3009bb='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0xf17c8e['atob']||(_0xf17c8e['atob']=function(_0x245442){const _0x595f69=String(_0x245442)['replace'](/=+$/,'');let _0x12b056='';for(let _0x5761f9=0x0,_0x53e770,_0x3e9ca8,_0x17f328=0x0;_0x3e9ca8=_0x595f69['charAt'](_0x17f328++);~_0x3e9ca8&&(_0x53e770=_0x5761f9%0x4?_0x53e770*0x40+_0x3e9ca8:_0x3e9ca8,_0x5761f9++%0x4)?_0x12b056+=String['fromCharCode'](0xff&_0x53e770>>(-0x2*_0x5761f9&0x6)):0x0){_0x3e9ca8=_0x3009bb['indexOf'](_0x3e9ca8);}return _0x12b056;});}());a0_0x19d4['RMrxVN']=function(_0x2c48a8){const _0x2b68d5=atob(_0x2c48a8);let _0x198c5d=[];for(let _0x2530b6=0x0,_0x55398c=_0x2b68d5['length'];_0x2530b6<_0x55398c;_0x2530b6++){_0x198c5d+='%'+('00'+_0x2b68d5['charCodeAt'](_0x2530b6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x198c5d);};a0_0x19d4['ssUvtZ']={};a0_0x19d4['pbnCar']=!![];}const _0x343c8e=a0_0x19d4['ssUvtZ'][_0x428931];if(_0x343c8e===undefined){_0x21caa5=a0_0x19d4['RMrxVN'](_0x21caa5);a0_0x19d4['ssUvtZ'][_0x428931]=_0x21caa5;}else{_0x21caa5=_0x343c8e;}return _0x21caa5;};const fs=require('fs');const fse=require(a0_0x19d4('0x5b'));const path=require(a0_0x19d4('0x8c'));const ora=require(a0_0x19d4('0x3b'));const tar=require(a0_0x19d4('0x46'));const Client=require(a0_0x19d4('0x50'));const chalk=require('chalk');const express=require(a0_0x19d4('0x17'));const copydir=require(a0_0x19d4('0x1f'));const program=require('commander');const inquirer=require(a0_0x19d4('0x71'));const symbols=require('log-symbols');const handlebars=require('handlebars');const proxy=require(a0_0x19d4('0x2e'));const download=require(a0_0x19d4('0x73'));const child_process=require(a0_0x19d4('0x76'));const ChromeLauncher=require(a0_0x19d4('0x82'));const githublink=a0_0x19d4('0x1b');const dcServerAddress=a0_0x19d4('0x77');const widgetDebugUrl='http://127.0.0.1:8088/';const ftpServerAddress='ftp.datacolour.cn';const ftpServerUserName=a0_0x19d4('0x75');const ftpServerPassword='datacolour';const proxyServerPort=0x270f;try{const packagePath=path[a0_0x19d4('0x87')](__dirname,a0_0x19d4('0x16'));if(fs[a0_0x19d4('0x9')](packagePath)){const pjson=require(packagePath);const version=pjson[a0_0x19d4('0x11')];program[a0_0x19d4('0x11')](version,'-v,\x20--version');}}catch(a0_0x2b3900){}program['command']('init\x20<name>')['description']('初始化Widget项目')[a0_0x19d4('0x2d')](_0x4593c0=>{if(!fs[a0_0x19d4('0x9')](_0x4593c0)){console[a0_0x19d4('0x6e')](symbols['info'],chalk['white'](a0_0x19d4('0x27')));const _0x2af4b0=ora(a0_0x19d4('0x7a'));_0x2af4b0[a0_0x19d4('0x70')]();download(githublink,_0x4593c0,{'clone':![]},_0x3ffbea=>{if(_0x3ffbea){_0x2af4b0['fail']();console['log'](symbols[a0_0x19d4('0x1e')],chalk['red'](_0x3ffbea));}else{_0x2af4b0[a0_0x19d4('0x49')]();process[a0_0x19d4('0x5f')](_0x4593c0);console['log'](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x4b')));child_process[a0_0x19d4('0x7c')](a0_0x19d4('0x1'),{'stdio':a0_0x19d4('0x3')});console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x47')));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk['white'](a0_0x19d4('0x0')));}});}else{console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')]('项目'+_0x4593c0+a0_0x19d4('0x67')));}});program['command'](a0_0x19d4('0x53'))[a0_0x19d4('0x34')](a0_0x19d4('0x43'))[a0_0x19d4('0x2d')](()=>{try{const _0x4afce4='src/widgets/widgets.json';if(fs[a0_0x19d4('0x9')](_0x4afce4)){const _0x19e451=fs['readFileSync'](_0x4afce4)[a0_0x19d4('0x26')]();const _0x53480c=JSON['parse'](_0x19e451);for(let _0x187275 of _0x53480c[a0_0x19d4('0x7d')]){const _0x535c6c='src/widgets/'+_0x187275[a0_0x19d4('0x8c')];const _0x12395e=_0x535c6c+'/manifest.json';if(fs[a0_0x19d4('0x9')](_0x12395e)){let _0x5c5702=fs['readFileSync'](_0x12395e)[a0_0x19d4('0x26')]();const _0x48a882=JSON['parse'](_0x5c5702);console[a0_0x19d4('0x6e')](symbols['info'],chalk['white'](a0_0x19d4('0x54')+_0x48a882['id']+',名称:'+_0x48a882[a0_0x19d4('0x55')]+a0_0x19d4('0x31')+_0x48a882[a0_0x19d4('0x11')]));}}}}catch(_0x62d316){console['log'](symbols['error'],chalk[a0_0x19d4('0x5c')](_0x62d316));}});program['command']('create')[a0_0x19d4('0x34')]('创建一个Widget')[a0_0x19d4('0x2d')](()=>{inquirer[a0_0x19d4('0x30')]([{'name':'id','message':a0_0x19d4('0x14')},{'name':a0_0x19d4('0x55'),'message':a0_0x19d4('0xf')},{'name':a0_0x19d4('0x34'),'message':a0_0x19d4('0xd')},{'name':a0_0x19d4('0x88'),'message':a0_0x19d4('0x24')},{'name':a0_0x19d4('0x2f'),'message':a0_0x19d4('0x6a')},{'name':a0_0x19d4('0x8c'),'message':a0_0x19d4('0x33')}])['then'](_0x2e34fb=>{try{const _0x1fad7b=_0x2e34fb['id'];const _0x3a132d=_0x2e34fb[a0_0x19d4('0x55')];const _0x138832=_0x2e34fb[a0_0x19d4('0x34')];const _0x20925e=_0x2e34fb['author'];const _0x3250b1=_0x2e34fb[a0_0x19d4('0x88')]?_0x2e34fb[a0_0x19d4('0x88')]:a0_0x19d4('0x29');const _0x45b825=_0x2e34fb[a0_0x19d4('0x8c')]?_0x2e34fb[a0_0x19d4('0x8c')][a0_0x19d4('0x7f')](/^\/+|\/+$/g,''):a0_0x19d4('0x4e');const _0xa85020=createWidget(_0x1fad7b,_0x3a132d,_0x138832,_0x20925e,_0x3250b1,_0x45b825);if(_0xa85020){console[a0_0x19d4('0x6e')](symbols['success'],chalk[a0_0x19d4('0x45')](a0_0x19d4('0x85')));}}catch(_0x22bff6){console['log'](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x22bff6));}});});program[a0_0x19d4('0x2')](a0_0x19d4('0x6d'))[a0_0x19d4('0x34')](a0_0x19d4('0x56'))[a0_0x19d4('0x2d')](()=>{inquirer[a0_0x19d4('0x30')]([{'name':'id','message':'请选择要调试的Widget','type':'rawlist','choices':getWidgetsList()},{'name':a0_0x19d4('0x4'),'message':'请输入平台服务地址，默认调用公共服务'}])[a0_0x19d4('0x39')](_0x451b9b=>{try{const _0x326299=_0x451b9b['id'];const _0x18374f=getWidgetPath(_0x326299);const _0x3f5229=_0x451b9b[a0_0x19d4('0x4')]?_0x451b9b['host']:dcServerAddress;const _0x58b8f8='src/widgets/'+_0x18374f+'/manifest.json';if(fs['existsSync'](_0x58b8f8)){const _0x29305e=a0_0x19d4('0xb');let _0x1e8f10=fs[a0_0x19d4('0x48')](_0x29305e)['toString']();const _0x214e8c=JSON[a0_0x19d4('0x5d')](_0x1e8f10);_0x214e8c[a0_0x19d4('0x11')]=getNextVersion(_0x214e8c['version']);for(let _0x1d6c4a of _0x214e8c[a0_0x19d4('0x7d')]){_0x1d6c4a[a0_0x19d4('0x65')]=_0x1d6c4a[a0_0x19d4('0x8c')]===_0x18374f;}_0x1e8f10=JSON[a0_0x19d4('0x25')](_0x214e8c,null,0x2);fs['writeFileSync'](_0x29305e,_0x1e8f10);let _0x400272=fs[a0_0x19d4('0x48')](_0x58b8f8)[a0_0x19d4('0x26')]();const _0x1ad43f=JSON[a0_0x19d4('0x5d')](_0x400272);_0x1ad43f['version']=getNextVersion(_0x1ad43f[a0_0x19d4('0x11')]);_0x400272=JSON[a0_0x19d4('0x25')](_0x1ad43f,null,0x2);fs[a0_0x19d4('0x23')](_0x58b8f8,_0x400272);console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk['white'](a0_0x19d4('0x3c')+_0x1ad43f[a0_0x19d4('0x11')]));startProxyServer(_0x3f5229,function(){const _0x9edb7a=child_process[a0_0x19d4('0x4d')]('npm',[a0_0x19d4('0x6b'),a0_0x19d4('0xa'),a0_0x19d4('0x35')+_0x18374f],{'shell':!![]});_0x9edb7a[a0_0x19d4('0x86')]['on'](a0_0x19d4('0x5'),function(_0x387b84){console[a0_0x19d4('0x6e')](_0x387b84['toString']());});_0x9edb7a[a0_0x19d4('0x21')]['on']('data',function(_0x4acc22){console['log'](_0x4acc22[a0_0x19d4('0x26')]());});});}else{console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](a0_0x19d4('0x6f')+_0x326299+'不存在'));}}catch(_0x1527e4){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x1527e4));}});});program[a0_0x19d4('0x2')](a0_0x19d4('0x64'))['description'](a0_0x19d4('0x74'))[a0_0x19d4('0x2d')](()=>{inquirer[a0_0x19d4('0x30')]([{'name':'id','message':'请选择要构建的Widget','type':'rawlist','choices':getWidgetsList()}])[a0_0x19d4('0x39')](_0x45e638=>{try{const _0x2b99c1=_0x45e638['id'];const _0x4aec3b=getWidgetPath(_0x2b99c1);const _0x1d4f96=a0_0x19d4('0x80')+_0x4aec3b+a0_0x19d4('0x2b');if(fs[a0_0x19d4('0x9')](_0x1d4f96)){let _0x39dbed=fs['readFileSync'](_0x1d4f96)['toString']();const _0x565ffc=JSON[a0_0x19d4('0x5d')](_0x39dbed);_0x565ffc[a0_0x19d4('0x11')]=getNextVersion(_0x565ffc['version']);_0x39dbed=JSON[a0_0x19d4('0x25')](_0x565ffc,null,0x2);fs[a0_0x19d4('0x23')](_0x1d4f96,_0x39dbed);console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk['white'](a0_0x19d4('0x3c')+_0x565ffc[a0_0x19d4('0x11')]));child_process[a0_0x19d4('0x7c')](a0_0x19d4('0x63')+_0x4aec3b,{'stdio':a0_0x19d4('0x3')});}else{console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](a0_0x19d4('0x6f')+_0x2b99c1+a0_0x19d4('0x44')));}}catch(_0x369a10){console[a0_0x19d4('0x6e')](symbols['error'],chalk['red'](_0x369a10));}});});program[a0_0x19d4('0x2')](a0_0x19d4('0x2c'))['description'](a0_0x19d4('0x3f'))[a0_0x19d4('0x2d')](()=>{try{const _0x305310=getWidgetsList();for(let _0x486e82 of _0x305310){const _0x5c91b9=_0x486e82['value'];const _0x1b3a75=getWidgetPath(_0x5c91b9);const _0x48c7c3='src/widgets/'+_0x1b3a75+a0_0x19d4('0x2b');if(fs[a0_0x19d4('0x9')](_0x48c7c3)){let _0x51cbe3=fs[a0_0x19d4('0x48')](_0x48c7c3)[a0_0x19d4('0x26')]();const _0x40fd8b=JSON[a0_0x19d4('0x5d')](_0x51cbe3);_0x40fd8b[a0_0x19d4('0x11')]=getNextVersion(_0x40fd8b['version']);_0x51cbe3=JSON[a0_0x19d4('0x25')](_0x40fd8b,null,0x2);fs[a0_0x19d4('0x23')](_0x48c7c3,_0x51cbe3);console[a0_0x19d4('0x6e')](symbols['info'],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x41')+_0x5c91b9));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x3c')+_0x40fd8b[a0_0x19d4('0x11')]));child_process[a0_0x19d4('0x7c')](a0_0x19d4('0x63')+_0x1b3a75,{'stdio':a0_0x19d4('0x3')});console[a0_0x19d4('0x6e')](symbols['success'],chalk['green']('完成构建Widget：'+_0x40fd8b['version']));const _0x34beb5=a0_0x19d4('0x62')+_0x1b3a75;const _0x2c1a38=a0_0x19d4('0x3d')+_0x1b3a75;if(!fs['existsSync'](a0_0x19d4('0x64'))){fs[a0_0x19d4('0x66')](a0_0x19d4('0x64'));}if(fs[a0_0x19d4('0x9')](_0x34beb5)){fse[a0_0x19d4('0xe')](_0x34beb5,_0x2c1a38);}}else{console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](a0_0x19d4('0x6f')+_0x5c91b9+a0_0x19d4('0x44')));}}}catch(_0x3e2749){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x3e2749));}});program['command'](a0_0x19d4('0x20'))[a0_0x19d4('0x34')]('发布一个Widget')['action'](()=>{inquirer[a0_0x19d4('0x30')]([{'name':'id','message':'请选择要发布的Widget','type':'rawlist','choices':getWidgetsList()},{'name':a0_0x19d4('0x50'),'message':a0_0x19d4('0x51')}])[a0_0x19d4('0x39')](_0x3b30e4=>{try{const _0x2e2391=_0x3b30e4['id'];const _0x3ce109=getWidgetPath(_0x2e2391);const _0x244859=a0_0x19d4('0x80')+_0x3ce109;const _0x2542ad=a0_0x19d4('0x62')+_0x3ce109;const _0x593215=_0x244859+a0_0x19d4('0x2b');const _0x4ebbc1=new Date()[a0_0x19d4('0x1a')]()[a0_0x19d4('0x7f')](/T/,'')['replace'](/\..+/,'')[a0_0x19d4('0x7f')](/-/g,'')['replace'](/:/g,'');const _0x10eb9b=_0x2e2391+'.'+_0x4ebbc1;const _0x10fb9f=_0x10eb9b+'.src.tar';const _0x4bdc93=_0x10eb9b+a0_0x19d4('0x68');const _0x4ed2ab='publish/'+_0x10fb9f;const _0x5940aa='publish/'+_0x4bdc93;if(!fs['existsSync']('publish')){fs[a0_0x19d4('0x66')](a0_0x19d4('0x20'));}if(fs[a0_0x19d4('0x9')](_0x593215)){let _0x43b285=fs[a0_0x19d4('0x48')](_0x593215)[a0_0x19d4('0x26')]();const _0x30e9af=JSON[a0_0x19d4('0x5d')](_0x43b285);_0x30e9af[a0_0x19d4('0x11')]=getNextVersion(_0x30e9af[a0_0x19d4('0x11')]);_0x43b285=JSON['stringify'](_0x30e9af,null,0x2);fs[a0_0x19d4('0x23')](_0x593215,_0x43b285);console['log'](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x3c')+_0x30e9af['version']));child_process[a0_0x19d4('0x7c')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0x3ce109,{'stdio':a0_0x19d4('0x3')});fs[a0_0x19d4('0x23')](_0x244859+'/__path__.txt',_0x3ce109);fs['writeFileSync'](_0x2542ad+a0_0x19d4('0x19'),_0x3ce109);tar[a0_0x19d4('0x61')](_0x244859)[a0_0x19d4('0x72')](fs[a0_0x19d4('0x69')](_0x4ed2ab));tar['pack'](_0x2542ad)[a0_0x19d4('0x72')](fs[a0_0x19d4('0x69')](_0x5940aa));const _0x5c9b63=_0x3b30e4[a0_0x19d4('0x50')];if(_0x5c9b63==='y'){connectFtpServer(function(_0x157621){const _0x47a1fe=ora(a0_0x19d4('0x81'));_0x47a1fe[a0_0x19d4('0x70')]();const _0x1acb0b=fs[a0_0x19d4('0x6c')](_0x4ed2ab);const _0xf6b14f=fs[a0_0x19d4('0x57')](_0x4ed2ab)['size'];_0x157621[a0_0x19d4('0x18')](_0x1acb0b,_0x10fb9f,function(_0x489c9f){if(_0x489c9f){_0x47a1fe[a0_0x19d4('0x52')]();console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk['red'](_0x489c9f));throw _0x489c9f;}_0x157621['end']();_0x47a1fe[a0_0x19d4('0x49')]('部件代码提交中...');console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x42')],chalk[a0_0x19d4('0x59')]('部件已成功提交...'));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x32')+_0x10eb9b));});let _0x448026=0x0;_0x1acb0b['on'](a0_0x19d4('0x5'),function(_0x74ad1c){_0x448026+=_0x74ad1c[a0_0x19d4('0x13')];_0x47a1fe[a0_0x19d4('0x79')]='部件代码提交中...\x09'+((_0x448026/_0xf6b14f*0x64)[a0_0x19d4('0x89')](0x2)+'%');});});}}else{console['log'](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](a0_0x19d4('0x6f')+_0x2e2391+a0_0x19d4('0x44')));}}catch(_0x30a7bf){console['log'](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x30a7bf));}});});program[a0_0x19d4('0x2')](a0_0x19d4('0x78'))['description']('发布所有Widgets')[a0_0x19d4('0x2d')](()=>{try{const _0x319aa6=getWidgetsList();for(let _0x488b8c of _0x319aa6){const _0x47c921=_0x488b8c['id'];const _0x3923e3=getWidgetPath(_0x47c921);const _0x4aac75=a0_0x19d4('0x80')+_0x3923e3;const _0x3bf04a='dist/widgets/'+_0x3923e3;const _0xea588f=_0x4aac75+a0_0x19d4('0x2b');const _0xcbe2b9=new Date()['toISOString']()[a0_0x19d4('0x7f')](/T/,'')['replace'](/\..+/,'')[a0_0x19d4('0x7f')](/-/g,'')[a0_0x19d4('0x7f')](/:/g,'');const _0x1f9f00=_0x47c921+'.'+_0xcbe2b9;const _0x1b16ab=_0x1f9f00+a0_0x19d4('0x4a');const _0x5d2f54=_0x1f9f00+a0_0x19d4('0x68');const _0x3a9303=a0_0x19d4('0x4f')+_0x1b16ab;const _0x5e50c2=a0_0x19d4('0x4f')+_0x5d2f54;if(!fs[a0_0x19d4('0x9')](a0_0x19d4('0x20'))){fs[a0_0x19d4('0x66')](a0_0x19d4('0x20'));}if(fs['existsSync'](_0xea588f)){let _0x5cbc0f=fs[a0_0x19d4('0x48')](_0xea588f)['toString']();const _0x24d27d=JSON[a0_0x19d4('0x5d')](_0x5cbc0f);_0x24d27d[a0_0x19d4('0x11')]=getNextVersion(_0x24d27d[a0_0x19d4('0x11')]);_0x5cbc0f=JSON[a0_0x19d4('0x25')](_0x24d27d,null,0x2);fs['writeFileSync'](_0xea588f,_0x5cbc0f);console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')]('当前Widget版本号：'+_0x24d27d[a0_0x19d4('0x11')]));child_process[a0_0x19d4('0x7c')](a0_0x19d4('0x63')+_0x3923e3,{'stdio':a0_0x19d4('0x3')});fs[a0_0x19d4('0x23')](_0x4aac75+a0_0x19d4('0x19'),_0x3923e3);fs[a0_0x19d4('0x23')](_0x3bf04a+a0_0x19d4('0x19'),_0x3923e3);tar['pack'](_0x4aac75)[a0_0x19d4('0x72')](fs[a0_0x19d4('0x69')](_0x3a9303));tar[a0_0x19d4('0x61')](_0x3bf04a)['pipe'](fs[a0_0x19d4('0x69')](_0x5e50c2));}else{console['log'](symbols[a0_0x19d4('0x1e')],chalk['red'](a0_0x19d4('0x6f')+_0x47c921+a0_0x19d4('0x44')));}}}catch(_0x1c7723){console['log'](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x1c7723));}});program[a0_0x19d4('0x5d')](process['argv']);function createWidget(_0x59fac8,_0x366e29,_0x1e5d81,_0x186eab,_0x520236,_0x28525e){if(!_0x59fac8||!_0x366e29||!_0x1e5d81||!_0x520236||!_0x28525e){console[a0_0x19d4('0x6e')](symbols['error'],chalk[a0_0x19d4('0x5c')]('请提供完整的Widget信息'));return![];}console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x28')+_0x59fac8+a0_0x19d4('0x10')));try{const _0x4d688f=_0x28525e+'/'+_0x59fac8;const _0x4d09ef=a0_0x19d4('0x80')+_0x28525e;const _0x4e398e='src/widgets/'+_0x4d688f;const _0xd691bc='src/widgets/template/widget';if(!fs['existsSync'](_0x4d09ef)){fs[a0_0x19d4('0x66')](_0x4d09ef);}if(!fs[a0_0x19d4('0x9')](_0xd691bc)){console[a0_0x19d4('0x6e')](symbols['error'],chalk['red'](a0_0x19d4('0x12')));return![];}if(fs[a0_0x19d4('0x9')](_0x4e398e)){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')]('Widget:'+_0x59fac8+a0_0x19d4('0xc')));return![];}copydir[a0_0x19d4('0x37')](_0xd691bc,_0x4e398e);const _0x5e854d=_0x4e398e+a0_0x19d4('0x2b');let _0x5a96fc=fs[a0_0x19d4('0x48')](_0x5e854d)[a0_0x19d4('0x26')]();const _0x2ea1db=JSON[a0_0x19d4('0x5d')](_0x5a96fc);_0x2ea1db['id']=_0x59fac8;_0x2ea1db[a0_0x19d4('0x88')]=_0x520236;_0x2ea1db[a0_0x19d4('0x55')]=_0x366e29;_0x2ea1db[a0_0x19d4('0x34')]=_0x1e5d81;_0x2ea1db[a0_0x19d4('0x2f')]=_0x186eab;_0x5a96fc=JSON['stringify'](_0x2ea1db,null,0x2);fs[a0_0x19d4('0x23')](_0x5e854d,_0x5a96fc);const _0x12d8c2=a0_0x19d4('0xb');let _0xa10239=fs[a0_0x19d4('0x48')](_0x12d8c2)[a0_0x19d4('0x26')]();const _0x1aa5e1=JSON[a0_0x19d4('0x5d')](_0xa10239);_0x1aa5e1[a0_0x19d4('0x11')]=getNextVersion(_0x1aa5e1[a0_0x19d4('0x11')]);for(let _0x1eb274 of _0x1aa5e1[a0_0x19d4('0x7d')]){_0x1eb274[a0_0x19d4('0x65')]=![];}_0x1aa5e1['widgets']['push']({'group':'测试','path':_0x4d688f,'enable':!![]});_0xa10239=JSON[a0_0x19d4('0x25')](_0x1aa5e1,null,0x2);fs[a0_0x19d4('0x23')](_0x12d8c2,_0xa10239);console['log'](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x1d')+_0x59fac8+a0_0x19d4('0x10')));}catch(_0x2c434d){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x2c434d));return![];}return!![];}function getNextVersion(_0x43115f){if(_0x43115f){const _0x5a7880=_0x43115f[a0_0x19d4('0x40')](/(.*\.)(\d+)$/);if(_0x5a7880&&_0x5a7880[0x1]&&_0x5a7880[0x2]){return''+_0x5a7880[0x1]+(parseInt(_0x5a7880[0x2])+0x1);}}return _0x43115f;}function getWidgetsList(){const _0x436986=[];try{const _0x4be84c=a0_0x19d4('0xb');if(fs['existsSync'](_0x4be84c)){const _0x3aef7e=fs[a0_0x19d4('0x48')](_0x4be84c)[a0_0x19d4('0x26')]();const _0x2e9716=JSON[a0_0x19d4('0x5d')](_0x3aef7e);for(let _0x19347b of _0x2e9716['widgets']){try{const _0x39727c='src/widgets/'+_0x19347b[a0_0x19d4('0x8c')];const _0x5dc831=_0x39727c+'/manifest.json';if(fs[a0_0x19d4('0x9')](_0x5dc831)){let _0xa0730=fs[a0_0x19d4('0x48')](_0x5dc831)['toString']();const _0x34af4e=JSON[a0_0x19d4('0x5d')](_0xa0730);_0x436986[a0_0x19d4('0x8')]({'value':_0x34af4e['id'],'name':a0_0x19d4('0x54')+_0x34af4e['id']+a0_0x19d4('0x1c')+_0x34af4e[a0_0x19d4('0x55')]+',版本:'+_0x34af4e[a0_0x19d4('0x11')]});}}catch(_0x5d884c){console['log'](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](_0x19347b[a0_0x19d4('0x8c')]+a0_0x19d4('0x5a')));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk['red'](_0x5d884c));}}}}catch(_0x2d02d8){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk['red']('widgets.json读取失败'));console['log'](symbols[a0_0x19d4('0x1e')],chalk['red'](_0x2d02d8));}return _0x436986;}function getWidgetPath(_0x46b55b){const _0x3c657c=a0_0x19d4('0xb');let _0x1dc956=fs[a0_0x19d4('0x48')](_0x3c657c)[a0_0x19d4('0x26')]();const _0x410ca6=JSON[a0_0x19d4('0x5d')](_0x1dc956);for(let _0x5b4bb1 of _0x410ca6['widgets']){const _0x305837=a0_0x19d4('0x80')+_0x5b4bb1['path']+a0_0x19d4('0x2b');let _0x16d359=fs[a0_0x19d4('0x48')](_0x305837)['toString']();const _0x3d46fe=JSON[a0_0x19d4('0x5d')](_0x16d359);if(_0x3d46fe['id']===_0x46b55b){return _0x5b4bb1[a0_0x19d4('0x8c')];}}console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x1e')],chalk[a0_0x19d4('0x5c')](a0_0x19d4('0x7e')+_0x46b55b));}function startProxyServer(_0x3f7e6e,_0x37e055){console['log'](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x84')](a0_0x19d4('0x58')));var _0x169440=express();_0x169440[a0_0x19d4('0x36')]('/',proxy({'target':_0x3f7e6e,'changeOrigin':!![],'pathRewrite':{'/core/widgets':a0_0x19d4('0x6')},'router':{'/core/widgets':widgetDebugUrl}}));_0x169440[a0_0x19d4('0x38')](proxyServerPort,function(){console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x84')](a0_0x19d4('0x8b')));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk['blue']('启动谷歌浏览器调试...'));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x45')](a0_0x19d4('0x3a')));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x45')]('Window:\x20\x22C:Program\x20Files\x20(x86)GoogleChromeApplicationchrome.exe\x22\x20--disable-web-security\x20--user-data-dir=~/chrome_tmp'));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x45')]('Linux:\x20/opt/google/chrome/chrome\x20--disable-web-security\x20--user-data-dir=/tmp/chrome_tmp'));console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x45')](a0_0x19d4('0x2a')));ChromeLauncher[a0_0x19d4('0x7')]({'startingUrl':a0_0x19d4('0x15')+proxyServerPort,'chromeFlags':['--disable-web-security',a0_0x19d4('0x60'),a0_0x19d4('0x8a'),a0_0x19d4('0x3e')]})[a0_0x19d4('0x39')](_0x1b1e8b=>{console['log'](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x84')](a0_0x19d4('0x83')));});if(_0x37e055){_0x37e055();}});}function connectFtpServer(_0xf11da2){const _0x2e0f70=new Client();const _0x30032e=ora(a0_0x19d4('0x4c'));_0x30032e[a0_0x19d4('0x70')]();_0x2e0f70['on']('ready',function(){_0x30032e[a0_0x19d4('0x49')]();console[a0_0x19d4('0x6e')](symbols[a0_0x19d4('0x7b')],chalk[a0_0x19d4('0x59')](a0_0x19d4('0x5e')));if(_0xf11da2){_0xf11da2(_0x2e0f70);}});_0x2e0f70['on'](a0_0x19d4('0x1e'),function(_0xb488e5){_0x30032e[a0_0x19d4('0x52')]();console['log'](symbols['error'],chalk['red'](_0xb488e5));});_0x2e0f70[a0_0x19d4('0x22')]({'host':ftpServerAddress,'user':ftpServerUserName,'password':ftpServerPassword});}