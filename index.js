#!/usr/bin/env node

const a0_0x5e20=['cHVzaA==','aHR0cDovLzEyNy4wLjAuMTo=','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','c3JjL3dpZGdldHMvdGVtcGxhdGUvd2lkZ2V0','dW5vZmZpY2lhbA==','LOeJiOacrDo=','dG9JU09TdHJpbmc=','6K+36L6T5YWlV2lkZ2V05L2c6ICF5ZCN56ew77yM5aaC77yaRnJlZXplU291bDxmcmVlemVzb3VsQGdtYWlsLmNvbT4=','cGFjaw==','5pyq5om+5Yiw5Yy56YWN55qEd2lkZ2V077ya','cGlwZQ==','5LiN5a2Y5Zyo','YnVpbGQv','ZG93bmxvYWQtZ2l0LXJlcG8=','LS0gLS1wYXRoPQ==','c3VjY2VlZA==','bG9nLXN5bWJvbHM=','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','cHVibGlzaEFsbA==','c3RhcnQ=','bGlzdGVu','Y3JlYXRlV3JpdGVTdHJlYW0=','bGVuZ3Ro','YXV0aG9y','aGFuZGxlYmFycw==','bGlzdA==','dGFyLWZz','cmVk','LS1tZWRpYS1jYWNoZS1zaXplPTE=','aHR0cC1wcm94eS1taWRkbGV3YXJl','6K+36YCJ5oup6KaB5p6E5bu655qEV2lkZ2V0','c3RyaW5naWZ5','ZW5hYmxl','5pyN5Yqh5Zmo6L+e5o6l5bey5bu656uLLi4u','cmVhZHk=','aHR0cDovLzEyNy4wLjAuMTo4MDg4Lw==','6LC35q2M5rWP6KeI5Zmo5ZCv5Yqo5oiQ5YqfLi4u','cGF0aA==','d2lkZ2V0cw==','cmVzb2x2ZQ==','5ZCv5Yqo6LC35q2M5rWP6KeI5Zmo6LCD6K+VLi4u','cHVibGlzaA==','bWtkaXJTeW5j','c3RkZXJy','Y29weS1kaXI=','ZGVzY3JpcHRpb24=','aG9zdA==','ZGVidWc=','6LCD6K+V5LiA5LiqV2lkZ2V0','5byA5aeL5bu656uL5pyN5Yqh5Zmo6L+e5o6lLi4u','TGludXg6IC9vcHQvZ29vZ2xlL2Nocm9tZS9jaHJvbWUgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9L3RtcC9jaHJvbWVfdG1w','c3luYw==','dG9TdHJpbmc=','5p6E5bu65LiA5LiqV2lkZ2V0','cHVibGlzaEZ0cA==','Y29tbWFuZA==','5a6M5oiQ5p6E5bu6V2lkZ2V077ya','Y2hkaXI=','dG9GaXhlZA==','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','6K+35Y+N6aaI5Y+R5biD5bqP5Y+3Og==','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4u','5Luj55CG5pyN5Yqh5Zmo5bey5ZCv5YqoLi4u','5bey5a2Y5Zyo','bG9n','5aaC5rWP6KeI5Zmo5ZCv5Yqo5aSx6LSl77yM6K+36YCa6L+H5aaC5LiL5ZG95Luk6KGM5omL5bel5ZCv5Yqo77ya','ZGF0YWNvbG91cg==','5Y+R5biDV2lkZ2V06Iez5a6Y5pa5','RnJlZXplU291bC9EYXRhQ29sb3VyV2lkZ2V0VGVtcGxhdGUjbWFzdGVy','ZGlzdC93aWRnZXRzLw==','aW5oZXJpdA==','Y3JlYXRlUmVhZFN0cmVhbQ==','LS1kaXNhYmxlLXdlYi1zZWN1cml0eQ==','V2lkZ2V05Yib5bu65oiQ5Yqf','LXYsIC0tdmVyc2lvbg==','d2hpdGU=','cHJvbXB0','cHVibGlzaC8=','YXJndg==','ZGF0YQ==','cmVhZEZpbGVTeW5j','cmF3bGlzdA==','LOWQjeensDo=','c3Rkb3V0','ZnRwLmRhdGFjb2xvdXIuY24=','d3JpdGVGaWxlU3luYw==','cmVwbGFjZQ==','5p6E5bu65omA5pyJV2lkZ2V0cw==','bnBt','aW5mbw==','cnVu','aW5pdCA8bmFtZT4=','dGV4dA==','ZmFpbA==','aHR0cDovLzM5LjEwMS4xMzguNDM6ODA4MA==','5byA5aeL5a6J6KOF5L6d6LWW57uE5Lu2Li4u','L21hbmlmZXN0Lmpzb24=','6K+75Y+W5aSx6LSl','5a6M5oiQ5a6J6KOF5L6d6LWW57uE5Lu2Li4u','c3RhdFN5bmM=','5YiX5Ye65omA5pyJV2lkZ2V0','c3JjL3dpZGdldHMv','YWN0aW9u','5q2j5Zyo5ZCv5Yqo5Luj55CG5pyN5YqhLi4u','ZXhlY1N5bmM=','c3VjY2Vzcw==','dGFn','Y29ubmVjdA==','Z3JlZW4=','5q2j5Zyo5LiL6L29V2lkZ2V05qih5p2/Li4u','6K+36L6T5YWlV2lkZ2V055qE5o+P6L+w77yM6KaB5rGC566A55+t55qE5Lit5paH5o+P6L+w5L+h5oGv','5b2T5YmNV2lkZ2V05qCH6K+G77ya','6K+36L6T5YWlV2lkZ2V05a2Y5YKo6Lev5b6E77yM6buY6K6k6Lev5b6EdW5vZmZpY2lhbO+8jOW7uuiurum7mOiupA==','bmFtZQ==','bGF1bmNo','Q2hhcnQ=','ZXJyb3I=','T1NYOiBvcGVuIC1uIC1hIC9BcHBsaWNhdGlvbnMvR29vZ2xlIENocm9tZS5hcHAvQ29udGVudHMvTWFjT1MvR29vZ2xlIENocm9tZSAtLWFyZ3MgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9Ii90bXAvY2hyb21lX3RtcCI=','LmRpc3QudGFy','ZmluaXNo','5a6M5oiQ6aG555uu5Yid5aeL5YyW77yM6K+35Yib5bu65LiA5LiqV2lkZ2V0','Y3JlYXRl','5Yib5bu65LiA5LiqV2lkZ2V0','YnVpbGQ=','bWF0Y2g=','6YOo5Lu25bey5oiQ5Yqf5o+Q5LqkLi4u','b3Jh','5Y+R5biD5omA5pyJV2lkZ2V0cw==','LnNyYy50YXI=','5Yid5aeL5YyWV2lkZ2V06aG555uu','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4uCQ==','6K+36YCJ5oup6KaB5Y+R5biD55qEV2lkZ2V0','ZXhpc3RzU3luYw==','V2lkZ2V0Og==','dmFsdWU=','6K+36L6T5YWlV2lkZ2V05YiG57G75qCH562+77yM6KaB5rGC6Iux5paH5a2X5q+N77yM5aSa5Liq6YCX5Y+35YiG5Ymy','Y29tbWFuZGVy','L19fcGF0aF9fLnR4dA==','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tcGF0aD0=','5Y+R5biD5LiA5LiqV2lkZ2V0','Ymx1ZQ==','6IezOmZyZWV6ZXNvdWxAZ21haWwuY29t','Li4u','dGhlbg==','ZnMtZXh0cmE=','cGFyc2U=','c3Bhd24=','cGFja2FnZS5qc29u','dmVyc2lvbg=='];(function(_0x1a4836,_0x2ae265){const _0x27da71=function(_0x3fb0e5){while(--_0x3fb0e5){_0x1a4836['push'](_0x1a4836['shift']());}};_0x27da71(++_0x2ae265);}(a0_0x5e20,0x153));const a0_0x2506=function(_0x1a4836,_0x2ae265){_0x1a4836=_0x1a4836-0x0;let _0x27da71=a0_0x5e20[_0x1a4836];if(a0_0x2506['fYfSul']===undefined){(function(){const _0x395187=function(){let _0x4f22c8;try{_0x4f22c8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x406d23){_0x4f22c8=window;}return _0x4f22c8;};const _0x4a46da=_0x395187();const _0x5be401='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x4a46da['atob']||(_0x4a46da['atob']=function(_0x26c6de){const _0x4c3b13=String(_0x26c6de)['replace'](/=+$/,'');let _0x342fb7='';for(let _0x3746d9=0x0,_0x359116,_0x198fb0,_0x5390db=0x0;_0x198fb0=_0x4c3b13['charAt'](_0x5390db++);~_0x198fb0&&(_0x359116=_0x3746d9%0x4?_0x359116*0x40+_0x198fb0:_0x198fb0,_0x3746d9++%0x4)?_0x342fb7+=String['fromCharCode'](0xff&_0x359116>>(-0x2*_0x3746d9&0x6)):0x0){_0x198fb0=_0x5be401['indexOf'](_0x198fb0);}return _0x342fb7;});}());a0_0x2506['xjOcSy']=function(_0x4e2007){const _0x1672ab=atob(_0x4e2007);let _0x2566ee=[];for(let _0x31e591=0x0,_0x284f9a=_0x1672ab['length'];_0x31e591<_0x284f9a;_0x31e591++){_0x2566ee+='%'+('00'+_0x1672ab['charCodeAt'](_0x31e591)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2566ee);};a0_0x2506['XwjgtK']={};a0_0x2506['fYfSul']=!![];}const _0x3fb0e5=a0_0x2506['XwjgtK'][_0x1a4836];if(_0x3fb0e5===undefined){_0x27da71=a0_0x2506['xjOcSy'](_0x27da71);a0_0x2506['XwjgtK'][_0x1a4836]=_0x27da71;}else{_0x27da71=_0x3fb0e5;}return _0x27da71;};const fs=require('fs');const fse=require(a0_0x2506('0x67'));const path=require(a0_0x2506('0x91'));const ora=require(a0_0x2506('0x55'));const tar=require(a0_0x2506('0x86'));const Client=require('ftp');const chalk=require('chalk');const express=require('express');const copydir=require(a0_0x2506('0x3'));const program=require(a0_0x2506('0x5f'));const inquirer=require('inquirer');const symbols=require(a0_0x2506('0x7c'));const handlebars=require(a0_0x2506('0x84'));const proxy=require(a0_0x2506('0x89'));const download=require(a0_0x2506('0x79'));const child_process=require('child_process');const ChromeLauncher=require('chrome-launcher');const githublink=a0_0x2506('0x1b');const dcServerAddress=a0_0x2506('0x35');const widgetDebugUrl=a0_0x2506('0x8f');const ftpServerAddress=a0_0x2506('0x2b');const ftpServerUserName=a0_0x2506('0x19');const ftpServerPassword=a0_0x2506('0x19');const proxyServerPort=0x1f90;try{const packagePath=path[a0_0x2506('0x93')](__dirname,a0_0x2506('0x6a'));if(fs[a0_0x2506('0x5b')](packagePath)){const pjson=require(packagePath);const version=pjson['version'];program[a0_0x2506('0x6b')](version,a0_0x2506('0x21'));}}catch(a0_0x528b7b){}program[a0_0x2506('0xe')](a0_0x2506('0x32'))[a0_0x2506('0x4')](a0_0x2506('0x58'))['action'](_0xa4f106=>{if(!fs['existsSync'](_0xa4f106)){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x58')));const _0x41c184=ora(a0_0x2506('0x44'));_0x41c184[a0_0x2506('0x7f')]();download(githublink,_0xa4f106,{'clone':![]},_0x156976=>{if(_0x156976){_0x41c184['fail']();console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red'](_0x156976));}else{_0x41c184[a0_0x2506('0x7b')]();process[a0_0x2506('0x10')](_0xa4f106);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x36')));child_process['execSync']('npm\x20install',{'stdio':a0_0x2506('0x1d')});console[a0_0x2506('0x17')](symbols['info'],chalk[a0_0x2506('0x22')](a0_0x2506('0x39')));console[a0_0x2506('0x17')](symbols['info'],chalk[a0_0x2506('0x22')](a0_0x2506('0x4f')));}});}else{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red']('项目'+_0xa4f106+a0_0x2506('0x16')));}});program[a0_0x2506('0xe')](a0_0x2506('0x85'))[a0_0x2506('0x4')](a0_0x2506('0x3b'))[a0_0x2506('0x3d')](()=>{try{const _0x2c934a='src/widgets/widgets.json';if(fs[a0_0x2506('0x5b')](_0x2c934a)){const _0x44cddb=fs[a0_0x2506('0x27')](_0x2c934a)[a0_0x2506('0xb')]();const _0x146228=JSON['parse'](_0x44cddb);for(let _0x48bbc6 of _0x146228['widgets']){const _0x4aff45=a0_0x2506('0x3c')+_0x48bbc6[a0_0x2506('0x91')];const _0x9a8821=_0x4aff45+a0_0x2506('0x37');if(fs['existsSync'](_0x9a8821)){let _0x203da5=fs[a0_0x2506('0x27')](_0x9a8821)['toString']();const _0x2a3184=JSON[a0_0x2506('0x68')](_0x203da5);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')]('标识:'+_0x2a3184['id']+a0_0x2506('0x29')+_0x2a3184[a0_0x2506('0x48')]+a0_0x2506('0x71')+_0x2a3184['version']));}}}}catch(_0x3ddff6){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0x3ddff6));}});program[a0_0x2506('0xe')](a0_0x2506('0x50'))[a0_0x2506('0x4')](a0_0x2506('0x51'))[a0_0x2506('0x3d')](()=>{inquirer[a0_0x2506('0x23')]([{'name':'id','message':'请输入Widget的标识，要求英文、数字、下划线'},{'name':'name','message':'请输入Widget的名称，要求简短的中文名称定义'},{'name':a0_0x2506('0x4'),'message':a0_0x2506('0x45')},{'name':a0_0x2506('0x41'),'message':a0_0x2506('0x5e')},{'name':a0_0x2506('0x83'),'message':a0_0x2506('0x73')},{'name':a0_0x2506('0x91'),'message':a0_0x2506('0x47')}])[a0_0x2506('0x66')](_0x181dc4=>{try{const _0x19eb4e=_0x181dc4['id'];const _0x58403c=_0x181dc4[a0_0x2506('0x48')];const _0x55e76e=_0x181dc4[a0_0x2506('0x4')];const _0x58e5bf=_0x181dc4[a0_0x2506('0x83')];const _0x493aad=_0x181dc4[a0_0x2506('0x41')]?_0x181dc4[a0_0x2506('0x41')]:a0_0x2506('0x4a');const _0x5bd655=_0x181dc4[a0_0x2506('0x91')]?_0x181dc4[a0_0x2506('0x91')]['replace'](/^\/+|\/+$/g,''):a0_0x2506('0x70');const _0x123fc0=createWidget(_0x19eb4e,_0x58403c,_0x55e76e,_0x58e5bf,_0x493aad,_0x5bd655);if(_0x123fc0){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x40')],chalk[a0_0x2506('0x43')](a0_0x2506('0x20')));}}catch(_0x1e9155){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red'](_0x1e9155));}});});program['command'](a0_0x2506('0x6'))[a0_0x2506('0x4')](a0_0x2506('0x7'))[a0_0x2506('0x3d')](()=>{inquirer['prompt']([{'name':'id','message':'请选择要调试的Widget','type':a0_0x2506('0x28'),'choices':getWidgetsList()},{'name':a0_0x2506('0x5'),'message':'请输入平台服务地址，默认调用公共服务'}])[a0_0x2506('0x66')](_0x2a94ab=>{try{const _0x32583c=_0x2a94ab['id'];const _0x4d668e=getWidgetPath(_0x32583c);const _0x411e67=_0x2a94ab['host']?_0x2a94ab[a0_0x2506('0x5')]:dcServerAddress;const _0x13ae1e='src/widgets/'+_0x4d668e+'/manifest.json';if(fs[a0_0x2506('0x5b')](_0x13ae1e)){const _0x17e57c=a0_0x2506('0x12');let _0x2cc871=fs[a0_0x2506('0x27')](_0x17e57c)[a0_0x2506('0xb')]();const _0x5124bd=JSON[a0_0x2506('0x68')](_0x2cc871);_0x5124bd[a0_0x2506('0x6b')]=getNextVersion(_0x5124bd[a0_0x2506('0x6b')]);for(let _0x18f3f2 of _0x5124bd[a0_0x2506('0x92')]){_0x18f3f2['enable']=_0x18f3f2[a0_0x2506('0x91')]===_0x4d668e;}_0x2cc871=JSON[a0_0x2506('0x8b')](_0x5124bd,null,0x2);fs[a0_0x2506('0x2c')](_0x17e57c,_0x2cc871);let _0x444fc9=fs[a0_0x2506('0x27')](_0x13ae1e)[a0_0x2506('0xb')]();const _0x5de1e2=JSON[a0_0x2506('0x68')](_0x444fc9);_0x5de1e2[a0_0x2506('0x6b')]=getNextVersion(_0x5de1e2[a0_0x2506('0x6b')]);_0x444fc9=JSON[a0_0x2506('0x8b')](_0x5de1e2,null,0x2);fs[a0_0x2506('0x2c')](_0x13ae1e,_0x444fc9);console['log'](symbols[a0_0x2506('0x30')],chalk['white']('当前Widget版本号：'+_0x5de1e2[a0_0x2506('0x6b')]));startProxyServer(_0x411e67,function(){const _0x3d1864=child_process[a0_0x2506('0x69')](a0_0x2506('0x2f'),[a0_0x2506('0x31'),'start-widget',a0_0x2506('0x7a')+_0x4d668e],{'shell':!![]});_0x3d1864[a0_0x2506('0x2a')]['on']('data',function(_0x2cdc9a){console['log'](_0x2cdc9a[a0_0x2506('0xb')]());});_0x3d1864[a0_0x2506('0x2')]['on'](a0_0x2506('0x26'),function(_0xce24d5){console[a0_0x2506('0x17')](_0xce24d5[a0_0x2506('0xb')]());});});}else{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red']('Widget:'+_0x32583c+'不存在'));}}catch(_0x4b1685){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0x4b1685));}});});program[a0_0x2506('0xe')](a0_0x2506('0x52'))[a0_0x2506('0x4')](a0_0x2506('0xc'))['action'](()=>{inquirer[a0_0x2506('0x23')]([{'name':'id','message':a0_0x2506('0x8a'),'type':a0_0x2506('0x28'),'choices':getWidgetsList()}])['then'](_0x123fd2=>{try{const _0x327fa7=_0x123fd2['id'];const _0x227a16=getWidgetPath(_0x327fa7);const _0x3027ef=a0_0x2506('0x3c')+_0x227a16+a0_0x2506('0x37');if(fs['existsSync'](_0x3027ef)){let _0x5220db=fs[a0_0x2506('0x27')](_0x3027ef)[a0_0x2506('0xb')]();const _0x53edce=JSON[a0_0x2506('0x68')](_0x5220db);_0x53edce[a0_0x2506('0x6b')]=getNextVersion(_0x53edce[a0_0x2506('0x6b')]);_0x5220db=JSON[a0_0x2506('0x8b')](_0x53edce,null,0x2);fs[a0_0x2506('0x2c')](_0x3027ef,_0x5220db);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')]('当前Widget版本号：'+_0x53edce[a0_0x2506('0x6b')]));child_process[a0_0x2506('0x3f')](a0_0x2506('0x61')+_0x227a16,{'stdio':a0_0x2506('0x1d')});}else{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](a0_0x2506('0x5c')+_0x327fa7+'不存在'));}}catch(_0x4c390a){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red'](_0x4c390a));}});});program[a0_0x2506('0xe')]('buildAll')['description'](a0_0x2506('0x2e'))[a0_0x2506('0x3d')](()=>{try{const _0x58ca09=getWidgetsList();for(let _0x3cd437 of _0x58ca09){const _0x5d6f9f=_0x3cd437[a0_0x2506('0x5d')];const _0x5ad3cc=getWidgetPath(_0x5d6f9f);const _0x10e7ec=a0_0x2506('0x3c')+_0x5ad3cc+'/manifest.json';if(fs['existsSync'](_0x10e7ec)){let _0x47f3ee=fs['readFileSync'](_0x10e7ec)[a0_0x2506('0xb')]();const _0x366e82=JSON[a0_0x2506('0x68')](_0x47f3ee);_0x366e82[a0_0x2506('0x6b')]=getNextVersion(_0x366e82[a0_0x2506('0x6b')]);_0x47f3ee=JSON[a0_0x2506('0x8b')](_0x366e82,null,0x2);fs[a0_0x2506('0x2c')](_0x10e7ec,_0x47f3ee);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x46')+_0x5d6f9f));console[a0_0x2506('0x17')](symbols['info'],chalk[a0_0x2506('0x22')](a0_0x2506('0x6e')+_0x366e82[a0_0x2506('0x6b')]));child_process[a0_0x2506('0x3f')](a0_0x2506('0x61')+_0x5ad3cc,{'stdio':a0_0x2506('0x1d')});console[a0_0x2506('0x17')](symbols[a0_0x2506('0x40')],chalk['green'](a0_0x2506('0xf')+_0x366e82[a0_0x2506('0x6b')]));const _0x66c6ed=a0_0x2506('0x1c')+_0x5ad3cc;const _0x37a7e9=a0_0x2506('0x78')+_0x5ad3cc;if(!fs[a0_0x2506('0x5b')](a0_0x2506('0x52'))){fs[a0_0x2506('0x1')](a0_0x2506('0x52'));}if(fs[a0_0x2506('0x5b')](_0x66c6ed)){fse['moveSync'](_0x66c6ed,_0x37a7e9);}}else{console['log'](symbols['error'],chalk[a0_0x2506('0x87')](a0_0x2506('0x5c')+_0x5d6f9f+'不存在'));}}}catch(_0x497ba8){console[a0_0x2506('0x17')](symbols['error'],chalk[a0_0x2506('0x87')](_0x497ba8));}});program[a0_0x2506('0xe')](a0_0x2506('0x0'))[a0_0x2506('0x4')](a0_0x2506('0x62'))[a0_0x2506('0x3d')](()=>{inquirer[a0_0x2506('0x23')]([{'name':'id','message':'请选择要发布的Widget','type':a0_0x2506('0x28'),'choices':getWidgetsList()}])['then'](_0x1aab88=>{try{const _0x155730=_0x1aab88['id'];const _0x3dc247=getWidgetPath(_0x155730);const _0x32b111=a0_0x2506('0x3c')+_0x3dc247;const _0x537432='dist/widgets/'+_0x3dc247;const _0x566f70=_0x32b111+'/manifest.json';const _0x22eacd=new Date()[a0_0x2506('0x72')]()[a0_0x2506('0x2d')](/T/,'')[a0_0x2506('0x2d')](/\..+/,'')[a0_0x2506('0x2d')](/-/g,'')[a0_0x2506('0x2d')](/:/g,'');const _0x55dd76=_0x155730+'.'+_0x22eacd;const _0x1007fe=_0x55dd76+a0_0x2506('0x57');const _0x507bac=_0x55dd76+'.dist.tar';const _0x196cb7=a0_0x2506('0x24')+_0x1007fe;const _0x1ff1a8=a0_0x2506('0x24')+_0x507bac;if(!fs[a0_0x2506('0x5b')]('publish')){fs[a0_0x2506('0x1')](a0_0x2506('0x0'));}if(fs[a0_0x2506('0x5b')](_0x566f70)){let _0xc5d6a0=fs[a0_0x2506('0x27')](_0x566f70)[a0_0x2506('0xb')]();const _0x1a9936=JSON['parse'](_0xc5d6a0);_0x1a9936[a0_0x2506('0x6b')]=getNextVersion(_0x1a9936[a0_0x2506('0x6b')]);_0xc5d6a0=JSON['stringify'](_0x1a9936,null,0x2);fs[a0_0x2506('0x2c')](_0x566f70,_0xc5d6a0);console['log'](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x6e')+_0x1a9936['version']));child_process[a0_0x2506('0x3f')](a0_0x2506('0x61')+_0x3dc247,{'stdio':'inherit'});fs[a0_0x2506('0x2c')](_0x32b111+a0_0x2506('0x60'),_0x3dc247);fs['writeFileSync'](_0x537432+a0_0x2506('0x60'),_0x3dc247);tar[a0_0x2506('0x74')](_0x32b111)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x196cb7));tar[a0_0x2506('0x74')](_0x537432)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x1ff1a8));}else{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](a0_0x2506('0x5c')+_0x155730+a0_0x2506('0x77')));}}catch(_0x5732e2){console[a0_0x2506('0x17')](symbols['error'],chalk[a0_0x2506('0x87')](_0x5732e2));}});});program[a0_0x2506('0xe')](a0_0x2506('0x7e'))[a0_0x2506('0x4')](a0_0x2506('0x56'))[a0_0x2506('0x3d')](()=>{try{const _0x2c5683=getWidgetsList();const _0xc24108=function(){const _0x39b1d1=_0x2c5683['shift']();if(!_0x39b1d1)return;const _0x5389d1=_0x39b1d1[a0_0x2506('0x5d')];const _0x53bb57=getWidgetPath(_0x5389d1);const _0x440a7f=a0_0x2506('0x3c')+_0x53bb57;const _0x77a10b='dist/widgets/'+_0x53bb57;const _0x34c49d=_0x440a7f+a0_0x2506('0x37');const _0x3d3632=new Date()[a0_0x2506('0x72')]()['replace'](/T/,'')[a0_0x2506('0x2d')](/\..+/,'')[a0_0x2506('0x2d')](/-/g,'')[a0_0x2506('0x2d')](/:/g,'');const _0x237348=_0x5389d1+'.'+_0x3d3632;const _0x1bea9d=_0x237348+'.src.tar';const _0x110dd4=_0x237348+a0_0x2506('0x4d');const _0x4829bd=a0_0x2506('0x24')+_0x1bea9d;const _0x3ee302=a0_0x2506('0x24')+_0x110dd4;if(!fs['existsSync']('publish')){fs[a0_0x2506('0x1')](a0_0x2506('0x0'));}if(fs['existsSync'](_0x34c49d)){let _0x23daad=fs[a0_0x2506('0x27')](_0x34c49d)[a0_0x2506('0xb')]();const _0x2692ab=JSON['parse'](_0x23daad);_0x2692ab[a0_0x2506('0x6b')]=getNextVersion(_0x2692ab[a0_0x2506('0x6b')]);_0x23daad=JSON['stringify'](_0x2692ab,null,0x2);fs[a0_0x2506('0x2c')](_0x34c49d,_0x23daad);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x6e')+_0x2692ab['version']));child_process[a0_0x2506('0x3f')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0x53bb57,{'stdio':a0_0x2506('0x1d')});fs['writeFileSync'](_0x440a7f+a0_0x2506('0x60'),_0x53bb57);fs[a0_0x2506('0x2c')](_0x77a10b+a0_0x2506('0x60'),_0x53bb57);var _0x5ad046=new Promise((_0x34bb66,_0x3ffb85)=>{tar[a0_0x2506('0x74')](_0x440a7f)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x4829bd))['on'](a0_0x2506('0x4e'),()=>{_0x34bb66(!![]);})['on'](a0_0x2506('0x4b'),_0x159ce5=>{_0x3ffb85(_0x159ce5);});});var _0x52e598=new Promise((_0x419fcd,_0xdeb346)=>{tar[a0_0x2506('0x74')](_0x77a10b)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x3ee302))['on'](a0_0x2506('0x4e'),()=>{_0x419fcd(!![]);})['on'](a0_0x2506('0x4b'),_0x336091=>{_0xdeb346(_0x336091);});});Promise['all']([_0x5ad046,_0x52e598])[a0_0x2506('0x66')](()=>{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')]('Widget已发布：'+_0x5389d1));_0xc24108();});}else{console['log'](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')]('Widget:'+_0x5389d1+'不存在'));}};_0xc24108();}catch(_0x505e39){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0x505e39));}});program[a0_0x2506('0xe')](a0_0x2506('0xd'))['description'](a0_0x2506('0x1a'))[a0_0x2506('0x3d')](()=>{inquirer[a0_0x2506('0x23')]([{'name':'id','message':a0_0x2506('0x5a'),'type':a0_0x2506('0x28'),'choices':getWidgetsList()}])['then'](_0x225820=>{try{const _0x30bedd=_0x225820['id'];const _0x2da8ad=getWidgetPath(_0x30bedd);const _0xad3d26=a0_0x2506('0x3c')+_0x2da8ad;const _0x249397=a0_0x2506('0x1c')+_0x2da8ad;const _0x167cf9=_0xad3d26+a0_0x2506('0x37');const _0x3ffa8d=new Date()['toISOString']()[a0_0x2506('0x2d')](/T/,'')[a0_0x2506('0x2d')](/\..+/,'')[a0_0x2506('0x2d')](/-/g,'')[a0_0x2506('0x2d')](/:/g,'');const _0x39e219=_0x30bedd+'.'+_0x3ffa8d;const _0x1d648a=_0x39e219+'.src.tar';const _0x30dfc5=_0x39e219+a0_0x2506('0x4d');const _0x170384=a0_0x2506('0x24')+_0x1d648a;const _0x25af8d=a0_0x2506('0x24')+_0x30dfc5;if(!fs[a0_0x2506('0x5b')](a0_0x2506('0x0'))){fs[a0_0x2506('0x1')](a0_0x2506('0x0'));}if(fs['existsSync'](_0x167cf9)){let _0x2ba004=fs['readFileSync'](_0x167cf9)[a0_0x2506('0xb')]();const _0x28c240=JSON[a0_0x2506('0x68')](_0x2ba004);_0x28c240['version']=getNextVersion(_0x28c240[a0_0x2506('0x6b')]);_0x2ba004=JSON['stringify'](_0x28c240,null,0x2);fs['writeFileSync'](_0x167cf9,_0x2ba004);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x6e')+_0x28c240[a0_0x2506('0x6b')]));child_process[a0_0x2506('0x3f')](a0_0x2506('0x61')+_0x2da8ad,{'stdio':a0_0x2506('0x1d')});fs['writeFileSync'](_0xad3d26+a0_0x2506('0x60'),_0x2da8ad);fs[a0_0x2506('0x2c')](_0x249397+a0_0x2506('0x60'),_0x2da8ad);tar[a0_0x2506('0x74')](_0xad3d26)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x170384));tar[a0_0x2506('0x74')](_0x249397)[a0_0x2506('0x76')](fs[a0_0x2506('0x81')](_0x25af8d));connectFtpServer(function(_0xb0d0ea){const _0xdd80cf=ora(a0_0x2506('0x14'));_0xdd80cf['start']();const _0x2c5422=fs[a0_0x2506('0x1e')](_0x170384);const _0x35de70=fs[a0_0x2506('0x3a')](_0x170384)['size'];_0xb0d0ea['put'](_0x2c5422,_0x1d648a,function(_0x26c241){if(_0x26c241){_0xdd80cf[a0_0x2506('0x34')]();console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0x26c241));throw _0x26c241;}_0xb0d0ea['end']();_0xdd80cf[a0_0x2506('0x7b')]('部件代码提交中...');console[a0_0x2506('0x17')](symbols['success'],chalk[a0_0x2506('0x22')](a0_0x2506('0x54')));console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk['white'](a0_0x2506('0x13')+_0x39e219+a0_0x2506('0x64')));});let _0x2e52bc=0x0;_0x2c5422['on'](a0_0x2506('0x26'),function(_0x30ddf8){_0x2e52bc+=_0x30ddf8[a0_0x2506('0x82')];_0xdd80cf[a0_0x2506('0x33')]=a0_0x2506('0x59')+((_0x2e52bc/_0x35de70*0x64)[a0_0x2506('0x11')](0x2)+'%');});});}else{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](a0_0x2506('0x5c')+_0x30bedd+a0_0x2506('0x77')));}}catch(_0x2bd80){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk['red'](_0x2bd80));}});});program[a0_0x2506('0x68')](process[a0_0x2506('0x25')]);function createWidget(_0xaec00d,_0x5e74cc,_0x342974,_0x530198,_0x2d98e6,_0x3d5dfe){if(!_0xaec00d||!_0x5e74cc||!_0x342974||!_0x2d98e6||!_0x3d5dfe){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')]('请提供完整的Widget信息'));return![];}console['log'](symbols['info'],chalk[a0_0x2506('0x22')]('正在创建Widget:'+_0xaec00d+a0_0x2506('0x65')));try{const _0x23c5c7=_0x3d5dfe+'/'+_0xaec00d;const _0x325179=a0_0x2506('0x3c')+_0x3d5dfe;const _0x7c27ae='src/widgets/'+_0x23c5c7;const _0x1bb177=a0_0x2506('0x6f');if(!fs['existsSync'](_0x325179)){fs['mkdirSync'](_0x325179);}if(!fs[a0_0x2506('0x5b')](_0x1bb177)){console[a0_0x2506('0x17')](symbols['error'],chalk[a0_0x2506('0x87')]('Widget模板文件夹不存在'));return![];}if(fs['existsSync'](_0x7c27ae)){console['log'](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')]('Widget:'+_0xaec00d+'已存在对应目录'));return![];}copydir[a0_0x2506('0xa')](_0x1bb177,_0x7c27ae);const _0x13ba2=_0x7c27ae+'/manifest.json';let _0x3dc61e=fs[a0_0x2506('0x27')](_0x13ba2)['toString']();const _0x352735=JSON[a0_0x2506('0x68')](_0x3dc61e);_0x352735['id']=_0xaec00d;_0x352735[a0_0x2506('0x41')]=_0x2d98e6;_0x352735[a0_0x2506('0x48')]=_0x5e74cc;_0x352735[a0_0x2506('0x4')]=_0x342974;_0x352735[a0_0x2506('0x83')]=_0x530198;_0x3dc61e=JSON[a0_0x2506('0x8b')](_0x352735,null,0x2);fs[a0_0x2506('0x2c')](_0x13ba2,_0x3dc61e);const _0x5b8e2e=a0_0x2506('0x12');let _0x231997=fs[a0_0x2506('0x27')](_0x5b8e2e)[a0_0x2506('0xb')]();const _0x460f46=JSON[a0_0x2506('0x68')](_0x231997);_0x460f46[a0_0x2506('0x6b')]=getNextVersion(_0x460f46[a0_0x2506('0x6b')]);for(let _0xf5206d of _0x460f46[a0_0x2506('0x92')]){_0xf5206d[a0_0x2506('0x8c')]=![];}_0x460f46[a0_0x2506('0x92')][a0_0x2506('0x6c')]({'group':'测试','path':_0x23c5c7,'enable':!![]});_0x231997=JSON[a0_0x2506('0x8b')](_0x460f46,null,0x2);fs[a0_0x2506('0x2c')](_0x5b8e2e,_0x231997);console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x22')](a0_0x2506('0x7d')+_0xaec00d+'...'));}catch(_0x3c9e50){console['log'](symbols[a0_0x2506('0x4b')],chalk['red'](_0x3c9e50));return![];}return!![];}function getNextVersion(_0x234f69){if(_0x234f69){const _0x59fd93=_0x234f69[a0_0x2506('0x53')](/(.*\.)(\d+)$/);if(_0x59fd93&&_0x59fd93[0x1]&&_0x59fd93[0x2]){return''+_0x59fd93[0x1]+(parseInt(_0x59fd93[0x2])+0x1);}}return _0x234f69;}function getWidgetsList(){const _0x2188f0=[];try{const _0x2ce5bf='src/widgets/widgets.json';if(fs[a0_0x2506('0x5b')](_0x2ce5bf)){const _0x527e82=fs['readFileSync'](_0x2ce5bf)[a0_0x2506('0xb')]();const _0x500c3d=JSON[a0_0x2506('0x68')](_0x527e82);for(let _0x16350b of _0x500c3d['widgets']){try{const _0x124f61='src/widgets/'+_0x16350b[a0_0x2506('0x91')];const _0x4d7d75=_0x124f61+a0_0x2506('0x37');if(fs['existsSync'](_0x4d7d75)){let _0x1399c6=fs[a0_0x2506('0x27')](_0x4d7d75)['toString']();const _0x2e2e81=JSON[a0_0x2506('0x68')](_0x1399c6);_0x2188f0[a0_0x2506('0x6c')]({'value':_0x2e2e81['id'],'name':'标识:'+_0x2e2e81['id']+a0_0x2506('0x29')+_0x2e2e81[a0_0x2506('0x48')]+a0_0x2506('0x71')+_0x2e2e81[a0_0x2506('0x6b')]});}}catch(_0x590152){console[a0_0x2506('0x17')](symbols['error'],chalk[a0_0x2506('0x87')](_0x16350b['path']+a0_0x2506('0x38')));console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0x590152));}}}}catch(_0x46d4ad){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')]('widgets.json读取失败'));console[a0_0x2506('0x17')](symbols['error'],chalk['red'](_0x46d4ad));}return _0x2188f0;}function getWidgetPath(_0x997057){const _0x8d0f6c='src/widgets/widgets.json';let _0x485c71=fs['readFileSync'](_0x8d0f6c)[a0_0x2506('0xb')]();const _0x408191=JSON['parse'](_0x485c71);for(let _0x6f85c3 of _0x408191[a0_0x2506('0x92')]){const _0x249e0a='src/widgets/'+_0x6f85c3[a0_0x2506('0x91')]+'/manifest.json';let _0x3a3fb3=fs['readFileSync'](_0x249e0a)['toString']();const _0x430457=JSON[a0_0x2506('0x68')](_0x3a3fb3);if(_0x430457['id']===_0x997057){return _0x6f85c3[a0_0x2506('0x91')];}}console['log'](symbols['error'],chalk['red'](a0_0x2506('0x75')+_0x997057));}function startProxyServer(_0x449690,_0x48444a){console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x63')](a0_0x2506('0x3e')));var _0xc872cc=express();_0xc872cc['use']('/',proxy({'target':_0x449690,'changeOrigin':!![],'pathRewrite':{'/core/widgets':'/widgets'},'router':{'/core/widgets':widgetDebugUrl}}));_0xc872cc[a0_0x2506('0x80')](proxyServerPort,function(){console['log'](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x63')](a0_0x2506('0x15')));console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x63')](a0_0x2506('0x94')));console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x43')](a0_0x2506('0x18')));console[a0_0x2506('0x17')](symbols['info'],chalk['green']('Window:\x20\x22C:Program\x20Files\x20(x86)GoogleChromeApplicationchrome.exe\x22\x20--disable-web-security\x20--user-data-dir=~/chrome_tmp'));console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x43')](a0_0x2506('0x9')));console['log'](symbols[a0_0x2506('0x30')],chalk[a0_0x2506('0x43')](a0_0x2506('0x4c')));ChromeLauncher[a0_0x2506('0x49')]({'startingUrl':a0_0x2506('0x6d')+proxyServerPort,'chromeFlags':[a0_0x2506('0x1f'),'--user-data-dir=./chrome_tmp',a0_0x2506('0x88'),'--disk-cache-size=1']})[a0_0x2506('0x66')](_0x3b3ef7=>{console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk['blue'](a0_0x2506('0x90')));});if(_0x48444a){_0x48444a();}});}function connectFtpServer(_0x573ef8){const _0x32abfb=new Client();const _0x267dca=ora(a0_0x2506('0x8'));_0x267dca[a0_0x2506('0x7f')]();_0x32abfb['on'](a0_0x2506('0x8e'),function(){_0x267dca[a0_0x2506('0x7b')]();console[a0_0x2506('0x17')](symbols[a0_0x2506('0x30')],chalk['white'](a0_0x2506('0x8d')));if(_0x573ef8){_0x573ef8(_0x32abfb);}});_0x32abfb['on'](a0_0x2506('0x4b'),function(_0xa16456){_0x267dca[a0_0x2506('0x34')]();console[a0_0x2506('0x17')](symbols[a0_0x2506('0x4b')],chalk[a0_0x2506('0x87')](_0xa16456));});_0x32abfb[a0_0x2506('0x42')]({'host':ftpServerAddress,'user':ftpServerUserName,'password':ftpServerPassword});}