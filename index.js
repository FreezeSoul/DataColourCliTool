#!/usr/bin/env node

const a0_0x46df=['Y2hpbGRfcHJvY2Vzcw==','5byA5aeL5a6J6KOF5L6d6LWW6YOo5Lu2Li4u','V2luZG93OiAiQzpQcm9ncmFtIEZpbGVzICh4ODYpR29vZ2xlQ2hyb21lQXBwbGljYXRpb25jaHJvbWUuZXhlIiAtLWRpc2FibGUtd2ViLXNlY3VyaXR5IC0tdXNlci1kYXRhLWRpcj1+L2Nocm9tZV90bXA=','aGFuZGxlYmFycw==','Y29ubmVjdA==','c3luYw==','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','c3RyaW5naWZ5','aW5pdCA8bmFtZT4=','aW5xdWlyZXI=','bG9nLXN5bWJvbHM=','dG9JU09TdHJpbmc=','5q2j5Zyo5LiL6L29V2lkZ2V05qih5p2/Li4u','LOeJiOacrDo=','5p6E5bu65LiA5LiqV2lkZ2V0','dmVyc2lvbg==','c3Bhd24=','RnJlZXplU291bC9EYXRhQ29sb3VyV2lkZ2V0VGVtcGxhdGUjbWFzdGVy','cnVu','c3RhdFN5bmM=','Y3JlYXRl','cmVzb2x2ZQ==','YnVpbGQ=','VGVzdA==','c3JjL3dpZGdldHMv','dmFsdWU=','d2hpdGU=','ZXJyb3I=','cmVk','cHVzaA==','ZnRw','dG9TdHJpbmc=','YWN0aW9u','aG9zdA==','bnBt','6K+36L6T5YWl5L2c6ICF5ZCN56ew77yM5aaC77yaRnJlZXplU291bDxmcmVlemVzb3VsQGdtYWlsLmNvbT4=','bmFtZQ==','6K+36L6T5YWlV2lkZ2V055qE5o+P6L+w77yM6KaB5rGC566A55+t55qE5Lit5paH5o+P6L+w5L+h5oGv','V2lkZ2V05qih5p2/5paH5Lu25aS55LiN5a2Y5Zyo','bW92ZVN5bmM=','6K+36YCJ5oup6KaB5p6E5bu655qEV2lkZ2V0','5ZCv5Yqo6LC35q2M5rWP6KeI5Zmo6LCD6K+VLi4u','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','bGF1bmNo','5b2T5YmNV2lkZ2V05qCH6K+G77ya','cmVhZEZpbGVTeW5j','5YiX5Ye65omA5pyJV2lkZ2V0','bnBtIGluc3RhbGw=','5bey5a2Y5Zyo','c3VjY2VlZA==','cmVhZHk=','cmF3bGlzdA==','c3RhcnQ=','5qCH6K+GOg==','YnVpbGQv','cHJvbXB0','5byA5aeL5bu656uL5pyN5Yqh5Zmo6L+e5o6lLi4u','dGhlbg==','aHR0cDovLzM5LjEwMS4xMzguNDM6ODA4MA==','cGFja2FnZS5qc29u','5bey57uP5a2Y5ZyoV2lkZ2V0Og==','dXNl','6LCD6K+V5LiA5LiqV2lkZ2V0','cmVwbGFjZQ==','5pyN5Yqh5Zmo6L+e5o6l5bey5bu656uLLi4u','5q2j5Zyo5ZCv5Yqo5Luj55CG5pyN5YqhLi4u','c3RhcnQtd2lkZ2V0','d3JpdGVGaWxlU3luYw==','6K+36L6T5YWlV2lkZ2V055qE5ZCN56ew77yM6KaB5rGC566A55+t55qE5Lit5paH5ZCN56ew5a6a5LmJ','5aaC5rWP6KeI5Zmo5ZCv5Yqo5aSx6LSl77yM6K+36YCa6L+H5aaC5LiL5ZG95Luk6KGM5omL5bel5ZCv5Yqo77ya','5a6M5oiQ5p6E5bu6V2lkZ2V077ya','Ymx1ZQ==','ZXhlY1N5bmM=','LXYsIC0tdmVyc2lvbg==','5Yid5aeL5YyW5LiA5LiqV2lkZ2V0','Y2hhbGs=','Z3JlZW4=','aHR0cDovLzEyNy4wLjAuMTo=','5Y+R5biD5LiA5LiqV2lkZ2V0','Y2hyb21lLWxhdW5jaGVy','cGFjaw==','aW5mbw==','LmRpc3QudGFy','YXV0aG9y','ZXhwcmVzcw==','bGVuZ3Ro','ZGVzY3JpcHRpb24=','5a6M5oiQ5a6J6KOF5L6d6LWW6YOo5Lu2Li4u','T1NYOiBvcGVuIC1uIC1hIC9BcHBsaWNhdGlvbnMvR29vZ2xlIENocm9tZS5hcHAvQ29udGVudHMvTWFjT1MvR29vZ2xlIENocm9tZSAtLWFyZ3MgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9Ii90bXAvY2hyb21lX3RtcCI=','bWF0Y2g=','LOWQjeensDo=','5q2j5Zyo5Yib5bu6V2lkZ2V0Og==','5Yib5bu65LiA5LiqV2lkZ2V0','Li4u','cGFyc2U=','6K+36L6T5YWlZGF0YWNvbG91cuW5s+WPsOacjeWKoeWcsOWdgO+8jOm7mOiupOiwg+eUqOWFrOWFseacjeWKoQ==','TGludXg6IC9vcHQvZ29vZ2xlL2Nocm9tZS9jaHJvbWUgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9L3RtcC9jaHJvbWVfdG1w','Y29tbWFuZGVy','6YOo5Lu25bey5oiQ5Yqf5o+Q5LqkLi4u','LnNyYy50YXI=','ZGF0YQ==','Y29tbWFuZA==','Y3JlYXRlV3JpdGVTdHJlYW0=','Y29weS1kaXI=','V2lkZ2V0Og==','L21hbmlmZXN0Lmpzb24=','Y2hkaXI=','5Yid5aeL5YyWV2lkZ2V06aG555uu','ZG93bmxvYWQtZ2l0LXJlcG8=','c3RkZXJy','ZXhpc3RzU3luYw==','6K+36L6T5YWlV2lkZ2V055qE5qCH6K+G77yM6KaB5rGC6Iux5paH44CB5pWw5a2X44CB5LiL5YiS57q/','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tbmFtZT0=','bG9n','V2lkZ2V05Yib5bu65oiQ5Yqf','LS11c2VyLWRhdGEtZGlyPS4vY2hyb21lX3RtcA==','ZmFpbA==','ZW5hYmxl','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','c3JjL3dpZGdldHMvd2lkZ2V0','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4uCQ==','d2lkZ2V0cw==','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4u','5LiN5a2Y5Zyo','c3Rkb3V0','ZGlzdC93aWRnZXRzLw==','5p6E5bu65omA5pyJV2lkZ2V0cw==','6LC35q2M5rWP6KeI5Zmo5ZCv5Yqo5oiQ5YqfLi4u','cGF0aA==','ZW5k','c3VjY2Vzcw==','6K+36YCJ5oup6KaB6LCD6K+V55qEV2lkZ2V0','aW5oZXJpdA==','Y3JlYXRlUmVhZFN0cmVhbQ==','dGV4dA=='];(function(_0xb2f9d5,_0x523030){const _0x4aec66=function(_0x52fa9c){while(--_0x52fa9c){_0xb2f9d5['push'](_0xb2f9d5['shift']());}};_0x4aec66(++_0x523030);}(a0_0x46df,0x102));const a0_0x51d1=function(_0xb2f9d5,_0x523030){_0xb2f9d5=_0xb2f9d5-0x0;let _0x4aec66=a0_0x46df[_0xb2f9d5];if(a0_0x51d1['PKIRsu']===undefined){(function(){let _0x5b173d;try{const _0x76c4e6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5b173d=_0x76c4e6();}catch(_0x3187a8){_0x5b173d=window;}const _0x222a2e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x5b173d['atob']||(_0x5b173d['atob']=function(_0x289127){const _0x281a08=String(_0x289127)['replace'](/=+$/,'');let _0x166bee='';for(let _0x2a3363=0x0,_0x15a01c,_0x516e86,_0x3306c6=0x0;_0x516e86=_0x281a08['charAt'](_0x3306c6++);~_0x516e86&&(_0x15a01c=_0x2a3363%0x4?_0x15a01c*0x40+_0x516e86:_0x516e86,_0x2a3363++%0x4)?_0x166bee+=String['fromCharCode'](0xff&_0x15a01c>>(-0x2*_0x2a3363&0x6)):0x0){_0x516e86=_0x222a2e['indexOf'](_0x516e86);}return _0x166bee;});}());a0_0x51d1['DuKMBT']=function(_0x450c25){const _0x471c40=atob(_0x450c25);let _0x46c90f=[];for(let _0x42a9b3=0x0,_0x4c9543=_0x471c40['length'];_0x42a9b3<_0x4c9543;_0x42a9b3++){_0x46c90f+='%'+('00'+_0x471c40['charCodeAt'](_0x42a9b3)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x46c90f);};a0_0x51d1['WmEuOI']={};a0_0x51d1['PKIRsu']=!![];}const _0x52fa9c=a0_0x51d1['WmEuOI'][_0xb2f9d5];if(_0x52fa9c===undefined){_0x4aec66=a0_0x51d1['DuKMBT'](_0x4aec66);a0_0x51d1['WmEuOI'][_0xb2f9d5]=_0x4aec66;}else{_0x4aec66=_0x52fa9c;}return _0x4aec66;};const fs=require('fs');const fse=require('fs-extra');const path=require(a0_0x51d1('0x5'));const ora=require('ora');const tar=require('tar-fs');const Client=require(a0_0x51d1('0x2a'));const chalk=require(a0_0x51d1('0x57'));const express=require(a0_0x51d1('0x60'));const copydir=require(a0_0x51d1('0x73'));const program=require(a0_0x51d1('0x6d'));const inquirer=require(a0_0x51d1('0x15'));const symbols=require(a0_0x51d1('0x16'));const handlebars=require(a0_0x51d1('0xf'));const proxy=require('http-proxy-middleware');const download=require(a0_0x51d1('0x78'));const child_process=require(a0_0x51d1('0xc'));const ChromeLauncher=require(a0_0x51d1('0x5b'));const githublink=a0_0x51d1('0x1d');const dcServerAddress=a0_0x51d1('0x46');const widgetDebugUrl='http://127.0.0.1:8088/';const ftpServerAddress='ftp.datacolour.cn';const ftpServerUserName='datacolour';const ftpServerPassword='datacolour';const proxyServerPort=0x270f;try{const packagePath=path[a0_0x51d1('0x21')](__dirname,a0_0x51d1('0x47'));if(fs[a0_0x51d1('0x7a')](packagePath)){const pjson=require(packagePath);const version=pjson[a0_0x51d1('0x1b')];program['version'](version,a0_0x51d1('0x55'));}}catch(a0_0x48c804){}program[a0_0x51d1('0x71')](a0_0x51d1('0x14'))[a0_0x51d1('0x62')](a0_0x51d1('0x77'))[a0_0x51d1('0x2c')](_0x3dcd83=>{if(!fs['existsSync'](_0x3dcd83)){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')]('初始化Widget项目'));const _0xe69edf=ora(a0_0x51d1('0x18'));_0xe69edf[a0_0x51d1('0x40')]();download(githublink,_0x3dcd83,{'clone':![]},_0x4bb7b9=>{if(_0x4bb7b9){_0xe69edf[a0_0x51d1('0x80')]();console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk['red'](_0x4bb7b9));}else{_0xe69edf[a0_0x51d1('0x3d')]();process[a0_0x51d1('0x76')](_0x3dcd83);console[a0_0x51d1('0x7d')](symbols['info'],chalk[a0_0x51d1('0x26')](a0_0x51d1('0xd')));child_process[a0_0x51d1('0x54')](a0_0x51d1('0x3b'),{'stdio':a0_0x51d1('0x9')});console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x63')));console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x56')));inquirer[a0_0x51d1('0x43')]([{'name':'id','message':a0_0x51d1('0x7b')},{'name':a0_0x51d1('0x30'),'message':a0_0x51d1('0x50')},{'name':'description','message':a0_0x51d1('0x31')},{'name':a0_0x51d1('0x5f'),'message':a0_0x51d1('0x2f')}])['then'](_0x26f7a0=>{try{const _0x2cb620=_0x26f7a0['id'];const _0x1e67a9=_0x26f7a0[a0_0x51d1('0x30')];const _0x54585a=_0x26f7a0[a0_0x51d1('0x62')];const _0x213473=_0x26f7a0[a0_0x51d1('0x5f')];const _0x45dc4f=createWidget(_0x2cb620,_0x1e67a9,_0x54585a,_0x213473);if(_0x45dc4f){console['log'](symbols['success'],chalk[a0_0x51d1('0x58')]('项目初始化完成'));}}catch(_0x5b0f1f){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk['red'](_0x5b0f1f));}});}});}else{console['log'](symbols['error'],chalk[a0_0x51d1('0x28')]('项目'+_0x3dcd83+'已存在'));}});program[a0_0x51d1('0x71')]('list')[a0_0x51d1('0x62')](a0_0x51d1('0x3a'))['action'](()=>{try{const _0x415968='src/widgets/widgets.json';if(fs[a0_0x51d1('0x7a')](_0x415968)){const _0x5e82ad=fs[a0_0x51d1('0x39')](_0x415968)[a0_0x51d1('0x2b')]();const _0x575808=JSON[a0_0x51d1('0x6a')](_0x5e82ad);for(let _0x2858c3 of _0x575808[a0_0x51d1('0x85')]){const _0xc6716d=a0_0x51d1('0x24')+_0x2858c3[a0_0x51d1('0x5')];const _0x5dcfed=_0xc6716d+a0_0x51d1('0x75');if(fs[a0_0x51d1('0x7a')](_0x5dcfed)){let _0x44ac3d=fs[a0_0x51d1('0x39')](_0x5dcfed)[a0_0x51d1('0x2b')]();const _0x20355d=JSON[a0_0x51d1('0x6a')](_0x44ac3d);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')]('标识:'+_0x20355d['id']+a0_0x51d1('0x66')+_0x20355d[a0_0x51d1('0x30')]+a0_0x51d1('0x19')+_0x20355d[a0_0x51d1('0x1b')]));}}}}catch(_0x315973){console[a0_0x51d1('0x7d')](symbols['error'],chalk[a0_0x51d1('0x28')](_0x315973));}});program[a0_0x51d1('0x71')](a0_0x51d1('0x20'))[a0_0x51d1('0x62')](a0_0x51d1('0x68'))['action'](()=>{inquirer[a0_0x51d1('0x43')]([{'name':'id','message':a0_0x51d1('0x7b')},{'name':a0_0x51d1('0x30'),'message':a0_0x51d1('0x50')},{'name':'description','message':a0_0x51d1('0x31')},{'name':a0_0x51d1('0x5f'),'message':'请输入作者名称，如：FreezeSoul<freezesoul@gmail.com>'}])[a0_0x51d1('0x45')](_0x50e1b6=>{try{const _0x1884d0=_0x50e1b6['id'];const _0x503a20=_0x50e1b6['name'];const _0x57f388=_0x50e1b6[a0_0x51d1('0x62')];const _0x8d9d60=_0x50e1b6[a0_0x51d1('0x5f')];const _0x1e8616=a0_0x51d1('0x24')+_0x1884d0;if(!fs[a0_0x51d1('0x7a')](_0x1e8616)){const _0x4abc46=createWidget(_0x1884d0,_0x503a20,_0x57f388,_0x8d9d60);if(_0x4abc46){console[a0_0x51d1('0x7d')](symbols['success'],chalk['green'](a0_0x51d1('0x7e')));}}else{console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x48')+_0x1884d0));}}catch(_0x328cc5){console[a0_0x51d1('0x7d')](symbols['error'],chalk[a0_0x51d1('0x28')](_0x328cc5));}});});program[a0_0x51d1('0x71')]('debug')[a0_0x51d1('0x62')](a0_0x51d1('0x4a'))['action'](()=>{inquirer[a0_0x51d1('0x43')]([{'name':'id','message':a0_0x51d1('0x8'),'type':a0_0x51d1('0x3f'),'choices':getWidgetsList()},{'name':'host','message':a0_0x51d1('0x6b')}])[a0_0x51d1('0x45')](_0x98b704=>{try{const _0x38c50a=_0x98b704['id'];const _0xb4bdb7=_0x98b704[a0_0x51d1('0x2d')]?_0x98b704[a0_0x51d1('0x2d')]:dcServerAddress;const _0x2e24f1=a0_0x51d1('0x24')+_0x38c50a+a0_0x51d1('0x75');if(fs[a0_0x51d1('0x7a')](_0x2e24f1)){const _0x4b3b6b=a0_0x51d1('0x82');let _0x4c78c9=fs[a0_0x51d1('0x39')](_0x4b3b6b)[a0_0x51d1('0x2b')]();const _0x21e433=JSON['parse'](_0x4c78c9);_0x21e433['version']=getNextVersion(_0x21e433[a0_0x51d1('0x1b')]);for(let _0x180ef8 of _0x21e433[a0_0x51d1('0x85')]){_0x180ef8['enable']=_0x180ef8[a0_0x51d1('0x5')]===_0x38c50a;}_0x4c78c9=JSON[a0_0x51d1('0x13')](_0x21e433,null,0x2);fs[a0_0x51d1('0x4f')](_0x4b3b6b,_0x4c78c9);let _0x41efe4=fs['readFileSync'](_0x2e24f1)['toString']();const _0x14d05c=JSON[a0_0x51d1('0x6a')](_0x41efe4);_0x14d05c[a0_0x51d1('0x1b')]=getNextVersion(_0x14d05c['version']);_0x41efe4=JSON[a0_0x51d1('0x13')](_0x14d05c,null,0x2);fs[a0_0x51d1('0x4f')](_0x2e24f1,_0x41efe4);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')]('当前Widget版本号：'+_0x14d05c[a0_0x51d1('0x1b')]));startProxyServer(_0xb4bdb7,function(){const _0x3c54e6=child_process[a0_0x51d1('0x1c')](a0_0x51d1('0x2e'),[a0_0x51d1('0x1e'),a0_0x51d1('0x4e'),'--\x20--name='+_0x38c50a],{'shell':!![]});_0x3c54e6[a0_0x51d1('0x1')]['on'](a0_0x51d1('0x70'),function(_0x344ae7){console[a0_0x51d1('0x7d')](_0x344ae7[a0_0x51d1('0x2b')]());});_0x3c54e6[a0_0x51d1('0x79')]['on'](a0_0x51d1('0x70'),function(_0x33104a){console[a0_0x51d1('0x7d')](_0x33104a['toString']());});});}else{console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')]('Widget:'+_0x38c50a+a0_0x51d1('0x0')));}}catch(_0x3c4b1c){console['log'](symbols[a0_0x51d1('0x27')],chalk['red'](_0x3c4b1c));}});});program[a0_0x51d1('0x71')](a0_0x51d1('0x22'))['description'](a0_0x51d1('0x1a'))[a0_0x51d1('0x2c')](()=>{inquirer[a0_0x51d1('0x43')]([{'name':'id','message':a0_0x51d1('0x34'),'type':a0_0x51d1('0x3f'),'choices':getWidgetsList()}])[a0_0x51d1('0x45')](_0x2f521b=>{try{const _0x589374=_0x2f521b['id'];const _0x51cdd6='src/widgets/'+_0x589374+'/manifest.json';if(fs[a0_0x51d1('0x7a')](_0x51cdd6)){let _0x37c640=fs[a0_0x51d1('0x39')](_0x51cdd6)[a0_0x51d1('0x2b')]();const _0x4a779=JSON[a0_0x51d1('0x6a')](_0x37c640);_0x4a779[a0_0x51d1('0x1b')]=getNextVersion(_0x4a779['version']);_0x37c640=JSON[a0_0x51d1('0x13')](_0x4a779,null,0x2);fs[a0_0x51d1('0x4f')](_0x51cdd6,_0x37c640);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x12')+_0x4a779[a0_0x51d1('0x1b')]));child_process['execSync'](a0_0x51d1('0x7c')+_0x589374,{'stdio':a0_0x51d1('0x9')});}else{console['log'](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x74')+_0x589374+a0_0x51d1('0x0')));}}catch(_0x198b41){console['log'](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](_0x198b41));}});});program[a0_0x51d1('0x71')]('buildAll')[a0_0x51d1('0x62')](a0_0x51d1('0x3'))[a0_0x51d1('0x2c')](()=>{try{const _0x1fb3c5=getWidgetsList();for(let _0xd34d32 of _0x1fb3c5){const _0x448916=_0xd34d32[a0_0x51d1('0x25')];const _0x2e9be9=a0_0x51d1('0x24')+_0x448916+a0_0x51d1('0x75');if(fs[a0_0x51d1('0x7a')](_0x2e9be9)){let _0x1a50f3=fs[a0_0x51d1('0x39')](_0x2e9be9)[a0_0x51d1('0x2b')]();const _0x2130b1=JSON[a0_0x51d1('0x6a')](_0x1a50f3);_0x2130b1[a0_0x51d1('0x1b')]=getNextVersion(_0x2130b1['version']);_0x1a50f3=JSON['stringify'](_0x2130b1,null,0x2);fs[a0_0x51d1('0x4f')](_0x2e9be9,_0x1a50f3);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk['white'](a0_0x51d1('0x38')+_0x448916));console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x12')+_0x2130b1['version']));child_process['execSync'](a0_0x51d1('0x7c')+_0x448916,{'stdio':a0_0x51d1('0x9')});console[a0_0x51d1('0x7d')](symbols['success'],chalk[a0_0x51d1('0x58')](a0_0x51d1('0x52')+_0x2130b1[a0_0x51d1('0x1b')]));const _0x4aa596=a0_0x51d1('0x2')+_0x448916;const _0x198c84=a0_0x51d1('0x42')+_0x448916;if(fs['existsSync'](_0x4aa596)){fse[a0_0x51d1('0x33')](_0x4aa596,_0x198c84);}}else{console['log'](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x74')+_0x448916+'不存在'));}}}catch(_0x12e1a7){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk['red'](_0x12e1a7));}});program[a0_0x51d1('0x71')]('publish')[a0_0x51d1('0x62')](a0_0x51d1('0x5a'))[a0_0x51d1('0x2c')](()=>{inquirer[a0_0x51d1('0x43')]([{'name':'id','message':'请选择要发布的Widget','type':'rawlist','choices':getWidgetsList()}])[a0_0x51d1('0x45')](_0x5dc818=>{try{const _0xbffeef=_0x5dc818['id'];const _0x52c7be=a0_0x51d1('0x24')+_0xbffeef;const _0x5bb974=a0_0x51d1('0x2')+_0xbffeef;const _0xfdd619=_0x52c7be+a0_0x51d1('0x75');const _0x217d97=new Date()[a0_0x51d1('0x17')]()[a0_0x51d1('0x4b')](/T/,'')[a0_0x51d1('0x4b')](/\..+/,'')[a0_0x51d1('0x4b')](/-/g,'')['replace'](/:/g,'');const _0x1b6192=_0xbffeef+'.'+_0x217d97;const _0x41e8c1=_0x1b6192+a0_0x51d1('0x6f');const _0x40e541=_0x1b6192+a0_0x51d1('0x5e');const _0x1e5327='build/'+_0x41e8c1;const _0x557a04=a0_0x51d1('0x42')+_0x40e541;if(fs[a0_0x51d1('0x7a')](_0xfdd619)){let _0x515b67=fs[a0_0x51d1('0x39')](_0xfdd619)[a0_0x51d1('0x2b')]();const _0x59b365=JSON[a0_0x51d1('0x6a')](_0x515b67);_0x59b365['version']=getNextVersion(_0x59b365['version']);_0x515b67=JSON['stringify'](_0x59b365,null,0x2);fs[a0_0x51d1('0x4f')](_0xfdd619,_0x515b67);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')]('当前Widget版本号：'+_0x59b365[a0_0x51d1('0x1b')]));child_process[a0_0x51d1('0x54')]('npm\x20run\x20build-widget:pro\x20--\x20--name='+_0xbffeef,{'stdio':a0_0x51d1('0x9')});tar[a0_0x51d1('0x5c')](_0x52c7be)['pipe'](fs['createWriteStream'](_0x1e5327));tar[a0_0x51d1('0x5c')](_0x5bb974)['pipe'](fs[a0_0x51d1('0x72')](_0x557a04));connectFtpServer(function(_0x1375b4){const _0x3f388f=ora(a0_0x51d1('0x86'));_0x3f388f[a0_0x51d1('0x40')]();const _0xc254c2=fs[a0_0x51d1('0xa')](_0x1e5327);const _0x16ce62=fs[a0_0x51d1('0x1f')](_0x1e5327)['size'];_0x1375b4['put'](_0xc254c2,_0x41e8c1,function(_0x2aac2a){if(_0x2aac2a){_0x3f388f[a0_0x51d1('0x80')]();console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](_0x2aac2a));throw _0x2aac2a;}_0x1375b4[a0_0x51d1('0x6')]();_0x3f388f['succeed'](a0_0x51d1('0x86'));console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x7')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x6e')));console['log'](symbols['info'],chalk['white']('请反馈发布序号:'+_0x1b6192));});let _0x58a457=0x0;_0xc254c2['on'](a0_0x51d1('0x70'),function(_0x266194){_0x58a457+=_0x266194[a0_0x51d1('0x61')];_0x3f388f[a0_0x51d1('0xb')]=a0_0x51d1('0x84')+((_0x58a457/_0x16ce62*0x64)['toFixed'](0x2)+'%');});});}else{console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x74')+_0xbffeef+a0_0x51d1('0x0')));}}catch(_0x395714){console[a0_0x51d1('0x7d')](symbols['error'],chalk[a0_0x51d1('0x28')](_0x395714));}});});program[a0_0x51d1('0x6a')](process['argv']);function createWidget(_0x4966d7,_0x1d343f,_0x401795,_0x25b476){if(!_0x4966d7||!_0x1d343f||!_0x401795){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk['red']('请提供完整的Widget信息'));return![];}console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk['white'](a0_0x51d1('0x67')+_0x4966d7+a0_0x51d1('0x69')));try{const _0x5c47a6=a0_0x51d1('0x24')+_0x4966d7;const _0x292b51=a0_0x51d1('0x83');if(!fs[a0_0x51d1('0x7a')](_0x292b51)){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x32')));return![];}if(fs[a0_0x51d1('0x7a')](_0x5c47a6)){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](a0_0x51d1('0x74')+_0x4966d7+a0_0x51d1('0x3c')));return![];}copydir[a0_0x51d1('0x11')](_0x292b51,_0x5c47a6);const _0xe0fe2c=_0x5c47a6+a0_0x51d1('0x75');let _0x37aadb=fs[a0_0x51d1('0x39')](_0xe0fe2c)[a0_0x51d1('0x2b')]();const _0x384246=JSON[a0_0x51d1('0x6a')](_0x37aadb);_0x384246['id']=_0x4966d7;_0x384246[a0_0x51d1('0x30')]=_0x1d343f;_0x384246[a0_0x51d1('0x62')]=_0x401795;_0x384246[a0_0x51d1('0x5f')]=_0x25b476;_0x37aadb=JSON['stringify'](_0x384246,null,0x2);fs[a0_0x51d1('0x4f')](_0xe0fe2c,_0x37aadb);const _0x13ca0e=a0_0x51d1('0x82');let _0x3b5f60=fs[a0_0x51d1('0x39')](_0x13ca0e)['toString']();const _0x247681=JSON[a0_0x51d1('0x6a')](_0x3b5f60);_0x247681[a0_0x51d1('0x1b')]=getNextVersion(_0x247681[a0_0x51d1('0x1b')]);for(let _0x44ef91 of _0x247681[a0_0x51d1('0x85')]){_0x44ef91[a0_0x51d1('0x81')]=![];}_0x247681['widgets'][a0_0x51d1('0x29')]({'group':'测试','tag':a0_0x51d1('0x23'),'path':_0x4966d7,'enable':!![]});_0x3b5f60=JSON[a0_0x51d1('0x13')](_0x247681,null,0x2);fs[a0_0x51d1('0x4f')](_0x13ca0e,_0x3b5f60);console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x36')+_0x4966d7+a0_0x51d1('0x69')));}catch(_0x57c4e1){console['log'](symbols['error'],chalk[a0_0x51d1('0x28')](_0x57c4e1));}return!![];}function getNextVersion(_0x591f80){if(_0x591f80){const _0x18db36=_0x591f80[a0_0x51d1('0x65')](/(.*\.)(\d+)$/);if(_0x18db36&&_0x18db36[0x1]&&_0x18db36[0x2]){return''+_0x18db36[0x1]+(parseInt(_0x18db36[0x2])+0x1);}}return _0x591f80;}function getWidgetsList(){const _0x42005b=[];try{const _0x42cfc9='src/widgets/widgets.json';if(fs[a0_0x51d1('0x7a')](_0x42cfc9)){const _0x13896b=fs[a0_0x51d1('0x39')](_0x42cfc9)[a0_0x51d1('0x2b')]();const _0x248869=JSON[a0_0x51d1('0x6a')](_0x13896b);for(let _0x20bb48 of _0x248869[a0_0x51d1('0x85')]){try{const _0x2e99b3='src/widgets/'+_0x20bb48['path'];const _0x588133=_0x2e99b3+'/manifest.json';if(fs[a0_0x51d1('0x7a')](_0x588133)){let _0x328707=fs[a0_0x51d1('0x39')](_0x588133)[a0_0x51d1('0x2b')]();const _0x2d63e5=JSON['parse'](_0x328707);_0x42005b['push']({'value':_0x2d63e5['id'],'name':a0_0x51d1('0x41')+_0x2d63e5['id']+',名称:'+_0x2d63e5[a0_0x51d1('0x30')]+a0_0x51d1('0x19')+_0x2d63e5['version']});}}catch(_0x252481){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](_0x20bb48[a0_0x51d1('0x5')]+'读取失败'));console['log'](symbols['error'],chalk[a0_0x51d1('0x28')](_0x252481));}}}}catch(_0x1336d9){console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')]('widgets.json读取失败'));console['log'](symbols[a0_0x51d1('0x27')],chalk[a0_0x51d1('0x28')](_0x1336d9));}return _0x42005b;}function startProxyServer(_0x3e48ae,_0x2071ce){console[a0_0x51d1('0x7d')](symbols['info'],chalk[a0_0x51d1('0x53')](a0_0x51d1('0x4d')));var _0x180197=express();_0x180197[a0_0x51d1('0x49')]('/',proxy({'target':_0x3e48ae,'changeOrigin':!![],'pathRewrite':{'/core/widgets':'/widgets'},'router':{'/core/widgets':widgetDebugUrl}}));_0x180197['listen'](proxyServerPort,function(){console['log'](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x53')]('代理服务器已启动...'));console[a0_0x51d1('0x7d')](symbols['info'],chalk[a0_0x51d1('0x53')](a0_0x51d1('0x35')));console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x58')](a0_0x51d1('0x51')));console['log'](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x58')](a0_0x51d1('0xe')));console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x58')](a0_0x51d1('0x6c')));console[a0_0x51d1('0x7d')](symbols['info'],chalk['green'](a0_0x51d1('0x64')));ChromeLauncher[a0_0x51d1('0x37')]({'startingUrl':a0_0x51d1('0x59')+proxyServerPort,'chromeFlags':['--disable-web-security',a0_0x51d1('0x7f')]})['then'](_0x51f98d=>{console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x53')](a0_0x51d1('0x4')));});if(_0x2071ce){_0x2071ce();}});}function connectFtpServer(_0x28c95b){const _0xa1cdb4=new Client();const _0x5cbb39=ora(a0_0x51d1('0x44'));_0x5cbb39[a0_0x51d1('0x40')]();_0xa1cdb4['on'](a0_0x51d1('0x3e'),function(){_0x5cbb39['succeed']();console[a0_0x51d1('0x7d')](symbols[a0_0x51d1('0x5d')],chalk[a0_0x51d1('0x26')](a0_0x51d1('0x4c')));if(_0x28c95b){_0x28c95b(_0xa1cdb4);}});_0xa1cdb4['on'](a0_0x51d1('0x27'),function(_0x10333){_0x5cbb39['fail']();console[a0_0x51d1('0x7d')](symbols['error'],chalk[a0_0x51d1('0x28')](_0x10333));});_0xa1cdb4[a0_0x51d1('0x10')]({'host':ftpServerAddress,'user':ftpServerUserName,'password':ftpServerPassword});}