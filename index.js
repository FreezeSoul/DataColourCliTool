#!/usr/bin/env node

const a0_0x406d=['6K+36L6T5YWlV2lkZ2V055qE5qCH6K+G77yM6KaB5rGC6Iux5paH44CB5pWw5a2X44CB5LiL5YiS57q/','cGFyc2U=','bWF0Y2g=','Y3JlYXRlV3JpdGVTdHJlYW0=','5byA5aeL5a6J6KOF5L6d6LWW57uE5Lu2Li4u','dGFn','cmVzb2x2ZQ==','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4uCQ==','Y29tbWFuZGVy','5q2j5Zyo5ZCv5Yqo5Luj55CG5pyN5YqhLi4u','LXYsIC0tdmVyc2lvbg==','bG9n','5b2T5YmNV2lkZ2V054mI5pys5Y+377ya','c3VjY2Vzcw==','cHVzaA==','bGlzdGVu','c3JjL3dpZGdldHMv','aW5oZXJpdA==','bG9nLXN5bWJvbHM=','cHJvbXB0','LnNyYy50YXI=','cGFjaw==','ZGF0YWNvbG91cg==','aG9zdA==','5bey5a2Y5Zyo5a+55bqU55uu5b2V','ZGF0YQ==','dmVyc2lvbg==','bnBtIHJ1biBidWlsZC13aWRnZXQ6cHJvIC0tIC0tcGF0aD0=','5p6E5bu65LiA5LiqV2lkZ2V0','cmVwbGFjZQ==','YWxs','cmVhZHk=','cHVibGlzaC8=','aW5mbw==','aHR0cDovLzEyNy4wLjAuMTo4MDg4Lw==','cmVk','5byA5aeL5bu656uL5pyN5Yqh5Zmo6L+e5o6lLi4u','6K+75Y+W5aSx6LSl','Y3JlYXRlUmVhZFN0cmVhbQ==','6K+356Gu6K6k5piv5ZCm5aSH5Lu96Iez5YWs5YWx5o+S5Lu25Lit5b+D77yM6K+36L6T5YWleS9uKOm7mOiupG4p','d2lkZ2V0cw==','bmFtZQ==','Y29ubmVjdA==','5ZCv5Yqo6LC35q2M5rWP6KeI5Zmo6LCD6K+VLi4u','bGlzdA==','cHV0','6K+36L6T5YWlV2lkZ2V055qE5o+P6L+w77yM6KaB5rGC566A55+t55qE5Lit5paH5o+P6L+w5L+h5oGv','ZG93bmxvYWQtZ2l0LXJlcG8=','L19fcGF0aF9fLnR4dA==','5p6E5bu65omA5pyJV2lkZ2V0cw==','6K+36L6T5YWlV2lkZ2V055qE5ZCN56ew77yM6KaB5rGC566A55+t55qE5Lit5paH5ZCN56ew5a6a5LmJ','cGlwZQ==','LOWQjeensDo=','ZmluaXNo','ZnRwLmRhdGFjb2xvdXIuY24=','dG9TdHJpbmc=','6YOo5Lu25bey5oiQ5Yqf5o+Q5LqkLi4u','LS1kaXNhYmxlLXdlYi1zZWN1cml0eQ==','T1NYOiBvcGVuIC1uIC1hIC9BcHBsaWNhdGlvbnMvR29vZ2xlIENocm9tZS5hcHAvQ29udGVudHMvTWFjT1MvR29vZ2xlIENocm9tZSAtLWFyZ3MgLS1kaXNhYmxlLXdlYi1zZWN1cml0eSAtLXVzZXItZGF0YS1kaXI9Ii90bXAvY2hyb21lX3RtcCI=','bWtkaXJTeW5j','5q2j5Zyo5LiL6L29V2lkZ2V05qih5p2/Li4u','Y2hhbGs=','c3JjL3dpZGdldHMvdGVtcGxhdGUvd2lkZ2V0','c3JjL3dpZGdldHMvd2lkZ2V0cy5qc29u','ZnRw','c3RhcnQ=','5bey5a2Y5Zyo','Li4u','5a6M5oiQ6aG555uu5Yid5aeL5YyW77yM6K+35Yib5bu65LiA5LiqV2lkZ2V0','5YiX5Ye65omA5pyJV2lkZ2V0','dGFyLWZz','5pyq5om+5Yiw5Yy56YWN55qEd2lkZ2V077ya','c2l6ZQ==','c3RhcnQtd2lkZ2V0','d2hpdGU=','YXV0aG9y','ZGVidWc=','V2luZG93OiAiQzpQcm9ncmFtIEZpbGVzICh4ODYpR29vZ2xlQ2hyb21lQXBwbGljYXRpb25jaHJvbWUuZXhlIiAtLWRpc2FibGUtd2ViLXNlY3VyaXR5IC0tdXNlci1kYXRhLWRpcj1+L2Nocm9tZV90bXA=','dGV4dA==','ZnMtZXh0cmE=','Y29weS1kaXI=','cHVibGlzaEFsbA==','YnVpbGQ=','5LiN5a2Y5Zyo','L21hbmlmZXN0Lmpzb24=','cGF0aA==','ZmFpbA==','ZW5k','6YOo5Lu25Luj56CB5o+Q5Lqk5LitLi4u','aW5xdWlyZXI=','bGF1bmNo','LS11c2VyLWRhdGEtZGlyPS4vY2hyb21lX3RtcA==','5q2j5Zyo5Yib5bu6V2lkZ2V0Og==','ZGVzY3JpcHRpb24=','cmF3bGlzdA==','6LCD6K+V5LiA5LiqV2lkZ2V0','5qCH6K+GOg==','d2lkZ2V0cy5qc29u6K+75Y+W5aSx6LSl','c3RyaW5naWZ5','ZW5hYmxl','ZXJyb3I=','LS0gLS1wYXRoPQ==','bGVuZ3Ro','LOeJiOacrDo=','bnBt','ZGlzdC93aWRnZXRzLw==','aW5pdCA8bmFtZT4=','ZXhlY1N5bmM=','5Luj55CG5pyN5Yqh5Zmo5bey5ZCv5YqoLi4u','dW5vZmZpY2lhbA==','dmFsdWU=','LmRpc3QudGFy','c3RkZXJy','5Yib5bu65LiA5LiqV2lkZ2V0','aHR0cDovLzEyNy4wLjAuMTo=','Z3JlZW4=','Y2hpbGRfcHJvY2Vzcw==','c3Rkb3V0','bnBtIGluc3RhbGw=','6K+35Y+N6aaI5Y+R5biD5bqP5Y+3Og==','dGhlbg==','5Y+R5biD5omA5pyJV2lkZ2V0cw==','Ymx1ZQ==','5a6M5oiQ5Yib5bu6V2lkZ2V0Og==','d3JpdGVGaWxlU3luYw==','5a6M5oiQ5a6J6KOF5L6d6LWW57uE5Lu2Li4u','V2lkZ2V0Og==','5a6M5oiQ5p6E5bu6V2lkZ2V077ya','6LC35q2M5rWP6KeI5Zmo5ZCv5Yqo5oiQ5YqfLi4u','cmVhZEZpbGVTeW5j','cHVibGlzaA==','5b2T5YmNV2lkZ2V05qCH6K+G77ya','Y29tbWFuZA==','YWN0aW9u','LS1tZWRpYS1jYWNoZS1zaXplPTE=','dG9JU09TdHJpbmc=','ZXhpc3RzU3luYw==','dG9GaXhlZA==','5Y+R5biD5LiA5LiqV2lkZ2V0','c3VjY2VlZA==','LS1kaXNrLWNhY2hlLXNpemU9MQ=='];(function(_0x2e1b7a,_0x42c741){const _0x461675=function(_0x5a501d){while(--_0x5a501d){_0x2e1b7a['push'](_0x2e1b7a['shift']());}};_0x461675(++_0x42c741);}(a0_0x406d,0x1e3));const a0_0x2acf=function(_0x2e1b7a,_0x42c741){_0x2e1b7a=_0x2e1b7a-0x0;let _0x461675=a0_0x406d[_0x2e1b7a];if(a0_0x2acf['mRurBG']===undefined){(function(){const _0x37ee48=function(){let _0x4d3ad9;try{_0x4d3ad9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x393505){_0x4d3ad9=window;}return _0x4d3ad9;};const _0x49e52d=_0x37ee48();const _0x14ec6b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x49e52d['atob']||(_0x49e52d['atob']=function(_0x2ce326){const _0x3b94d3=String(_0x2ce326)['replace'](/=+$/,'');let _0x37abc7='';for(let _0x4bb125=0x0,_0x53645a,_0x42d043,_0xe088d1=0x0;_0x42d043=_0x3b94d3['charAt'](_0xe088d1++);~_0x42d043&&(_0x53645a=_0x4bb125%0x4?_0x53645a*0x40+_0x42d043:_0x42d043,_0x4bb125++%0x4)?_0x37abc7+=String['fromCharCode'](0xff&_0x53645a>>(-0x2*_0x4bb125&0x6)):0x0){_0x42d043=_0x14ec6b['indexOf'](_0x42d043);}return _0x37abc7;});}());a0_0x2acf['wsjEBq']=function(_0x4bb9d1){const _0x539c08=atob(_0x4bb9d1);let _0x5a6d66=[];for(let _0x33be6b=0x0,_0x1201ce=_0x539c08['length'];_0x33be6b<_0x1201ce;_0x33be6b++){_0x5a6d66+='%'+('00'+_0x539c08['charCodeAt'](_0x33be6b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5a6d66);};a0_0x2acf['AHDHye']={};a0_0x2acf['mRurBG']=!![];}const _0x5a501d=a0_0x2acf['AHDHye'][_0x2e1b7a];if(_0x5a501d===undefined){_0x461675=a0_0x2acf['wsjEBq'](_0x461675);a0_0x2acf['AHDHye'][_0x2e1b7a]=_0x461675;}else{_0x461675=_0x5a501d;}return _0x461675;};const fs=require('fs');const fse=require(a0_0x2acf('0x13'));const path=require(a0_0x2acf('0x19'));const ora=require('ora');const tar=require(a0_0x2acf('0xa'));const Client=require('ftp');const chalk=require(a0_0x2acf('0x1'));const express=require('express');const copydir=require(a0_0x2acf('0x14'));const program=require(a0_0x2acf('0x59'));const inquirer=require(a0_0x2acf('0x1d'));const symbols=require(a0_0x2acf('0x63'));const handlebars=require('handlebars');const proxy=require('http-proxy-middleware');const download=require(a0_0x2acf('0x80'));const child_process=require(a0_0x2acf('0x38'));const ChromeLauncher=require('chrome-launcher');const githublink='FreezeSoul/DataColourWidgetTemplate#master';const dcServerAddress='http://39.101.138.43:8080';const widgetDebugUrl=a0_0x2acf('0x73');const ftpServerAddress=a0_0x2acf('0x87');const ftpServerUserName=a0_0x2acf('0x67');const ftpServerPassword='datacolour';const proxyServerPort=0x270f;try{const packagePath=path[a0_0x2acf('0x57')](__dirname,'package.json');if(fs[a0_0x2acf('0x4c')](packagePath)){const pjson=require(packagePath);const version=pjson[a0_0x2acf('0x6b')];program[a0_0x2acf('0x6b')](version,a0_0x2acf('0x5b'));}}catch(a0_0x3e9f0a){}program['command'](a0_0x2acf('0x2e'))[a0_0x2acf('0x21')]('初始化Widget项目')[a0_0x2acf('0x49')](_0xeb3dd6=>{if(!fs[a0_0x2acf('0x4c')](_0xeb3dd6)){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')]('初始化Widget项目'));const _0x1e2ece=ora(a0_0x2acf('0x0'));_0x1e2ece[a0_0x2acf('0x5')]();download(githublink,_0xeb3dd6,{'clone':![]},_0x22583d=>{if(_0x22583d){_0x1e2ece[a0_0x2acf('0x1a')]();console['log'](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0x22583d));}else{_0x1e2ece['succeed']();process['chdir'](_0xeb3dd6);console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x55')));child_process['execSync'](a0_0x2acf('0x3a'),{'stdio':a0_0x2acf('0x62')});console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk['white'](a0_0x2acf('0x41')));console[a0_0x2acf('0x5c')](symbols['info'],chalk['white'](a0_0x2acf('0x8')));}});}else{console['log'](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')]('项目'+_0xeb3dd6+a0_0x2acf('0x6')));}});program['command'](a0_0x2acf('0x7d'))[a0_0x2acf('0x21')](a0_0x2acf('0x9'))['action'](()=>{try{const _0x185337=a0_0x2acf('0x3');if(fs[a0_0x2acf('0x4c')](_0x185337)){const _0x1fc102=fs[a0_0x2acf('0x45')](_0x185337)[a0_0x2acf('0x88')]();const _0x1f04f1=JSON['parse'](_0x1fc102);for(let _0x219792 of _0x1f04f1[a0_0x2acf('0x79')]){const _0xe86445=a0_0x2acf('0x61')+_0x219792[a0_0x2acf('0x19')];const _0x47f1f9=_0xe86445+a0_0x2acf('0x18');if(fs[a0_0x2acf('0x4c')](_0x47f1f9)){let _0x3f7d42=fs[a0_0x2acf('0x45')](_0x47f1f9)[a0_0x2acf('0x88')]();const _0x121a96=JSON[a0_0x2acf('0x52')](_0x3f7d42);console[a0_0x2acf('0x5c')](symbols['info'],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x24')+_0x121a96['id']+a0_0x2acf('0x85')+_0x121a96[a0_0x2acf('0x7a')]+a0_0x2acf('0x2b')+_0x121a96[a0_0x2acf('0x6b')]));}}}}catch(_0x4573b5){console['log'](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0x4573b5));}});program[a0_0x2acf('0x48')]('create')[a0_0x2acf('0x21')](a0_0x2acf('0x35'))[a0_0x2acf('0x49')](()=>{inquirer[a0_0x2acf('0x64')]([{'name':'id','message':a0_0x2acf('0x51')},{'name':a0_0x2acf('0x7a'),'message':a0_0x2acf('0x83')},{'name':'description','message':a0_0x2acf('0x7f')},{'name':a0_0x2acf('0x56'),'message':'请输入Widget分类标签，要求英文字母，多个逗号分割'},{'name':'author','message':'请输入Widget作者名称，如：FreezeSoul<freezesoul@gmail.com>'},{'name':a0_0x2acf('0x19'),'message':'请输入Widget存储路径，默认路径unofficial，建议默认'}])[a0_0x2acf('0x3c')](_0x2a9aab=>{try{const _0x3f9008=_0x2a9aab['id'];const _0x244bb2=_0x2a9aab[a0_0x2acf('0x7a')];const _0x248b87=_0x2a9aab[a0_0x2acf('0x21')];const _0x5f5dd4=_0x2a9aab['author'];const _0x4f3457=_0x2a9aab['tag']?_0x2a9aab[a0_0x2acf('0x56')]:'Chart';const _0x9fd6d7=_0x2a9aab[a0_0x2acf('0x19')]?_0x2a9aab['path'][a0_0x2acf('0x6e')](/^\/+|\/+$/g,''):a0_0x2acf('0x31');const _0x49aaf9=createWidget(_0x3f9008,_0x244bb2,_0x248b87,_0x5f5dd4,_0x4f3457,_0x9fd6d7);if(_0x49aaf9){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x5e')],chalk[a0_0x2acf('0x37')]('Widget创建成功'));}}catch(_0x3706cb){console['log'](symbols['error'],chalk['red'](_0x3706cb));}});});program[a0_0x2acf('0x48')](a0_0x2acf('0x10'))['description'](a0_0x2acf('0x23'))[a0_0x2acf('0x49')](()=>{inquirer['prompt']([{'name':'id','message':'请选择要调试的Widget','type':a0_0x2acf('0x22'),'choices':getWidgetsList()},{'name':a0_0x2acf('0x68'),'message':'请输入平台服务地址，默认调用公共服务'}])[a0_0x2acf('0x3c')](_0x492a79=>{try{const _0x1d1149=_0x492a79['id'];const _0x479223=getWidgetPath(_0x1d1149);const _0x49ab6f=_0x492a79['host']?_0x492a79[a0_0x2acf('0x68')]:dcServerAddress;const _0x317dd8=a0_0x2acf('0x61')+_0x479223+'/manifest.json';if(fs['existsSync'](_0x317dd8)){const _0x34bef3=a0_0x2acf('0x3');let _0x3f38ee=fs['readFileSync'](_0x34bef3)[a0_0x2acf('0x88')]();const _0x119f54=JSON[a0_0x2acf('0x52')](_0x3f38ee);_0x119f54[a0_0x2acf('0x6b')]=getNextVersion(_0x119f54[a0_0x2acf('0x6b')]);for(let _0x4e73e1 of _0x119f54['widgets']){_0x4e73e1['enable']=_0x4e73e1[a0_0x2acf('0x19')]===_0x479223;}_0x3f38ee=JSON['stringify'](_0x119f54,null,0x2);fs[a0_0x2acf('0x40')](_0x34bef3,_0x3f38ee);let _0x49aa08=fs[a0_0x2acf('0x45')](_0x317dd8)['toString']();const _0x318e20=JSON[a0_0x2acf('0x52')](_0x49aa08);_0x318e20[a0_0x2acf('0x6b')]=getNextVersion(_0x318e20[a0_0x2acf('0x6b')]);_0x49aa08=JSON[a0_0x2acf('0x26')](_0x318e20,null,0x2);fs[a0_0x2acf('0x40')](_0x317dd8,_0x49aa08);console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x5d')+_0x318e20[a0_0x2acf('0x6b')]));startProxyServer(_0x49ab6f,function(){const _0x245e3b=child_process['spawn'](a0_0x2acf('0x2c'),['run',a0_0x2acf('0xd'),a0_0x2acf('0x29')+_0x479223],{'shell':!![]});_0x245e3b[a0_0x2acf('0x39')]['on'](a0_0x2acf('0x6a'),function(_0x5e50b6){console[a0_0x2acf('0x5c')](_0x5e50b6[a0_0x2acf('0x88')]());});_0x245e3b[a0_0x2acf('0x34')]['on'](a0_0x2acf('0x6a'),function(_0x539450){console[a0_0x2acf('0x5c')](_0x539450[a0_0x2acf('0x88')]());});});}else{console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')](a0_0x2acf('0x42')+_0x1d1149+a0_0x2acf('0x17')));}}catch(_0x57d1bf){console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')](_0x57d1bf));}});});program[a0_0x2acf('0x48')](a0_0x2acf('0x16'))['description'](a0_0x2acf('0x6d'))['action'](()=>{inquirer[a0_0x2acf('0x64')]([{'name':'id','message':'请选择要构建的Widget','type':a0_0x2acf('0x22'),'choices':getWidgetsList()}])[a0_0x2acf('0x3c')](_0x346849=>{try{const _0x29a6c6=_0x346849['id'];const _0x3757c4=getWidgetPath(_0x29a6c6);const _0x225749=a0_0x2acf('0x61')+_0x3757c4+a0_0x2acf('0x18');if(fs[a0_0x2acf('0x4c')](_0x225749)){let _0x568a55=fs[a0_0x2acf('0x45')](_0x225749)['toString']();const _0xdced4d=JSON['parse'](_0x568a55);_0xdced4d[a0_0x2acf('0x6b')]=getNextVersion(_0xdced4d[a0_0x2acf('0x6b')]);_0x568a55=JSON['stringify'](_0xdced4d,null,0x2);fs[a0_0x2acf('0x40')](_0x225749,_0x568a55);console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk['white'](a0_0x2acf('0x5d')+_0xdced4d['version']));child_process[a0_0x2acf('0x2f')](a0_0x2acf('0x6c')+_0x3757c4,{'stdio':'inherit'});}else{console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](a0_0x2acf('0x42')+_0x29a6c6+'不存在'));}}catch(_0x35721e){console['log'](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0x35721e));}});});program['command']('buildAll')['description'](a0_0x2acf('0x82'))[a0_0x2acf('0x49')](()=>{try{const _0x45cc65=getWidgetsList();for(let _0x772897 of _0x45cc65){const _0x1d5f87=_0x772897[a0_0x2acf('0x32')];const _0xd3f8e6=getWidgetPath(_0x1d5f87);const _0x143b2b=a0_0x2acf('0x61')+_0xd3f8e6+a0_0x2acf('0x18');if(fs[a0_0x2acf('0x4c')](_0x143b2b)){let _0x3eb708=fs[a0_0x2acf('0x45')](_0x143b2b)[a0_0x2acf('0x88')]();const _0xdb6728=JSON['parse'](_0x3eb708);_0xdb6728[a0_0x2acf('0x6b')]=getNextVersion(_0xdb6728[a0_0x2acf('0x6b')]);_0x3eb708=JSON[a0_0x2acf('0x26')](_0xdb6728,null,0x2);fs['writeFileSync'](_0x143b2b,_0x3eb708);console['log'](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x47')+_0x1d5f87));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x5d')+_0xdb6728[a0_0x2acf('0x6b')]));child_process[a0_0x2acf('0x2f')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0xd3f8e6,{'stdio':a0_0x2acf('0x62')});console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x5e')],chalk[a0_0x2acf('0x37')](a0_0x2acf('0x43')+_0xdb6728['version']));const _0x479cf0=a0_0x2acf('0x2d')+_0xd3f8e6;const _0x2ab483='build/'+_0xd3f8e6;if(!fs[a0_0x2acf('0x4c')]('build')){fs['mkdirSync'](a0_0x2acf('0x16'));}if(fs[a0_0x2acf('0x4c')](_0x479cf0)){fse['moveSync'](_0x479cf0,_0x2ab483);}}else{console['log'](symbols['error'],chalk['red'](a0_0x2acf('0x42')+_0x1d5f87+a0_0x2acf('0x17')));}}}catch(_0x39d90c){console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')](_0x39d90c));}});program['command'](a0_0x2acf('0x46'))[a0_0x2acf('0x21')](a0_0x2acf('0x4e'))[a0_0x2acf('0x49')](()=>{inquirer[a0_0x2acf('0x64')]([{'name':'id','message':'请选择要发布的Widget','type':a0_0x2acf('0x22'),'choices':getWidgetsList()},{'name':a0_0x2acf('0x4'),'message':a0_0x2acf('0x78')}])[a0_0x2acf('0x3c')](_0x39d85c=>{try{const _0x154b1e=_0x39d85c['id'];const _0x5b29f3=getWidgetPath(_0x154b1e);const _0x458e0b=a0_0x2acf('0x61')+_0x5b29f3;const _0x3268f0=a0_0x2acf('0x2d')+_0x5b29f3;const _0x3a959c=_0x458e0b+a0_0x2acf('0x18');const _0x4a11a4=new Date()[a0_0x2acf('0x4b')]()[a0_0x2acf('0x6e')](/T/,'')[a0_0x2acf('0x6e')](/\..+/,'')['replace'](/-/g,'')[a0_0x2acf('0x6e')](/:/g,'');const _0x54dd8a=_0x154b1e+'.'+_0x4a11a4;const _0x2e1508=_0x54dd8a+a0_0x2acf('0x65');const _0x9e3476=_0x54dd8a+a0_0x2acf('0x33');const _0x584b11=a0_0x2acf('0x71')+_0x2e1508;const _0x528278=a0_0x2acf('0x71')+_0x9e3476;if(!fs[a0_0x2acf('0x4c')]('publish')){fs['mkdirSync'](a0_0x2acf('0x46'));}if(fs[a0_0x2acf('0x4c')](_0x3a959c)){let _0x51b529=fs[a0_0x2acf('0x45')](_0x3a959c)[a0_0x2acf('0x88')]();const _0x441141=JSON['parse'](_0x51b529);_0x441141['version']=getNextVersion(_0x441141[a0_0x2acf('0x6b')]);_0x51b529=JSON['stringify'](_0x441141,null,0x2);fs['writeFileSync'](_0x3a959c,_0x51b529);console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk['white'](a0_0x2acf('0x5d')+_0x441141[a0_0x2acf('0x6b')]));child_process[a0_0x2acf('0x2f')]('npm\x20run\x20build-widget:pro\x20--\x20--path='+_0x5b29f3,{'stdio':a0_0x2acf('0x62')});fs['writeFileSync'](_0x458e0b+a0_0x2acf('0x81'),_0x5b29f3);fs[a0_0x2acf('0x40')](_0x3268f0+a0_0x2acf('0x81'),_0x5b29f3);tar[a0_0x2acf('0x66')](_0x458e0b)[a0_0x2acf('0x84')](fs['createWriteStream'](_0x584b11));tar[a0_0x2acf('0x66')](_0x3268f0)[a0_0x2acf('0x84')](fs[a0_0x2acf('0x54')](_0x528278));const _0x1625b0=_0x39d85c[a0_0x2acf('0x4')];if(_0x1625b0==='y'){connectFtpServer(function(_0x30fe92){const _0x4dda78=ora(a0_0x2acf('0x1c'));_0x4dda78[a0_0x2acf('0x5')]();const _0x32d853=fs[a0_0x2acf('0x77')](_0x584b11);const _0x52f80c=fs['statSync'](_0x584b11)[a0_0x2acf('0xc')];_0x30fe92[a0_0x2acf('0x7e')](_0x32d853,_0x2e1508,function(_0x310aa7){if(_0x310aa7){_0x4dda78['fail']();console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')](_0x310aa7));throw _0x310aa7;}_0x30fe92[a0_0x2acf('0x1b')]();_0x4dda78[a0_0x2acf('0x4f')]('部件代码提交中...');console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x5e')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x89')));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk['white'](a0_0x2acf('0x3b')+_0x54dd8a));});let _0x261ada=0x0;_0x32d853['on'](a0_0x2acf('0x6a'),function(_0x399622){_0x261ada+=_0x399622[a0_0x2acf('0x2a')];_0x4dda78[a0_0x2acf('0x12')]=a0_0x2acf('0x58')+((_0x261ada/_0x52f80c*0x64)[a0_0x2acf('0x4d')](0x2)+'%');});});}}else{console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')]('Widget:'+_0x154b1e+a0_0x2acf('0x17')));}}catch(_0x4f1611){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk['red'](_0x4f1611));}});});program[a0_0x2acf('0x48')](a0_0x2acf('0x15'))[a0_0x2acf('0x21')](a0_0x2acf('0x3d'))[a0_0x2acf('0x49')](async()=>{try{const _0x1d97c5=getWidgetsList();for(let _0x39d563 of _0x1d97c5){const _0x2d9813=_0x39d563[a0_0x2acf('0x32')];const _0x3fc345=getWidgetPath(_0x2d9813);const _0x3c0041=a0_0x2acf('0x61')+_0x3fc345;const _0x39ea80=a0_0x2acf('0x2d')+_0x3fc345;const _0x17bac7=_0x3c0041+a0_0x2acf('0x18');const _0x126828=new Date()[a0_0x2acf('0x4b')]()[a0_0x2acf('0x6e')](/T/,'')['replace'](/\..+/,'')['replace'](/-/g,'')[a0_0x2acf('0x6e')](/:/g,'');const _0x27c9b5=_0x2d9813+'.'+_0x126828;const _0x234436=_0x27c9b5+'.src.tar';const _0x2bd76e=_0x27c9b5+'.dist.tar';const _0x36a6c8=a0_0x2acf('0x71')+_0x234436;const _0x3f142f='publish/'+_0x2bd76e;if(!fs[a0_0x2acf('0x4c')](a0_0x2acf('0x46'))){fs['mkdirSync'](a0_0x2acf('0x46'));}if(fs[a0_0x2acf('0x4c')](_0x17bac7)){let _0xa439a5=fs[a0_0x2acf('0x45')](_0x17bac7)[a0_0x2acf('0x88')]();const _0x5ab033=JSON[a0_0x2acf('0x52')](_0xa439a5);_0x5ab033[a0_0x2acf('0x6b')]=getNextVersion(_0x5ab033['version']);_0xa439a5=JSON[a0_0x2acf('0x26')](_0x5ab033,null,0x2);fs[a0_0x2acf('0x40')](_0x17bac7,_0xa439a5);console['log'](symbols['info'],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x5d')+_0x5ab033['version']));child_process[a0_0x2acf('0x2f')](a0_0x2acf('0x6c')+_0x3fc345,{'stdio':a0_0x2acf('0x62')});fs[a0_0x2acf('0x40')](_0x3c0041+a0_0x2acf('0x81'),_0x3fc345);fs[a0_0x2acf('0x40')](_0x39ea80+'/__path__.txt',_0x3fc345);var _0x563840=new Promise((_0x230eb4,_0x58a831)=>{tar['pack'](_0x3c0041)[a0_0x2acf('0x84')](fs[a0_0x2acf('0x54')](_0x36a6c8))['on'](a0_0x2acf('0x86'),()=>{_0x230eb4(!![]);})['on']('error',_0x55afbd=>{_0x58a831(_0x55afbd);});});var _0x1e6245=new Promise((_0x3d43c4,_0x14d5de)=>{tar[a0_0x2acf('0x66')](_0x39ea80)[a0_0x2acf('0x84')](fs[a0_0x2acf('0x54')](_0x3f142f))['on']('finish',()=>{_0x3d43c4(!![]);})['on']('error',_0x1bf83f=>{_0x14d5de(_0x1bf83f);});});await Promise[a0_0x2acf('0x6f')]([_0x563840,_0x1e6245])['then'](()=>{});}else{console['log'](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](a0_0x2acf('0x42')+_0x2d9813+a0_0x2acf('0x17')));}}}catch(_0xa5b95e){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0xa5b95e));}});program[a0_0x2acf('0x52')](process['argv']);function createWidget(_0x3e9305,_0x1ee13a,_0x552e5d,_0x5502f9,_0x573a65,_0x4cc59c){if(!_0x3e9305||!_0x1ee13a||!_0x552e5d||!_0x573a65||!_0x4cc59c){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')]('请提供完整的Widget信息'));return![];}console[a0_0x2acf('0x5c')](symbols['info'],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x20')+_0x3e9305+a0_0x2acf('0x7')));try{const _0x14f16e=_0x4cc59c+'/'+_0x3e9305;const _0x56823d='src/widgets/'+_0x4cc59c;const _0x5ba94c='src/widgets/'+_0x14f16e;const _0x4c2be6=a0_0x2acf('0x2');if(!fs[a0_0x2acf('0x4c')](_0x56823d)){fs[a0_0x2acf('0x8c')](_0x56823d);}if(!fs['existsSync'](_0x4c2be6)){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')]('Widget模板文件夹不存在'));return![];}if(fs[a0_0x2acf('0x4c')](_0x5ba94c)){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](a0_0x2acf('0x42')+_0x3e9305+a0_0x2acf('0x69')));return![];}copydir['sync'](_0x4c2be6,_0x5ba94c);const _0x23e9e5=_0x5ba94c+a0_0x2acf('0x18');let _0x4a1a0c=fs[a0_0x2acf('0x45')](_0x23e9e5)[a0_0x2acf('0x88')]();const _0x400a49=JSON['parse'](_0x4a1a0c);_0x400a49['id']=_0x3e9305;_0x400a49[a0_0x2acf('0x56')]=_0x573a65;_0x400a49[a0_0x2acf('0x7a')]=_0x1ee13a;_0x400a49[a0_0x2acf('0x21')]=_0x552e5d;_0x400a49[a0_0x2acf('0xf')]=_0x5502f9;_0x4a1a0c=JSON[a0_0x2acf('0x26')](_0x400a49,null,0x2);fs[a0_0x2acf('0x40')](_0x23e9e5,_0x4a1a0c);const _0x52dd34=a0_0x2acf('0x3');let _0x936c51=fs[a0_0x2acf('0x45')](_0x52dd34)[a0_0x2acf('0x88')]();const _0x5d8a39=JSON['parse'](_0x936c51);_0x5d8a39['version']=getNextVersion(_0x5d8a39[a0_0x2acf('0x6b')]);for(let _0x1f463f of _0x5d8a39[a0_0x2acf('0x79')]){_0x1f463f[a0_0x2acf('0x27')]=![];}_0x5d8a39[a0_0x2acf('0x79')]['push']({'group':'测试','path':_0x14f16e,'enable':!![]});_0x936c51=JSON[a0_0x2acf('0x26')](_0x5d8a39,null,0x2);fs[a0_0x2acf('0x40')](_0x52dd34,_0x936c51);console['log'](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0xe')](a0_0x2acf('0x3f')+_0x3e9305+'...'));}catch(_0x324109){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0x324109));return![];}return!![];}function getNextVersion(_0x5f0918){if(_0x5f0918){const _0xc45b87=_0x5f0918[a0_0x2acf('0x53')](/(.*\.)(\d+)$/);if(_0xc45b87&&_0xc45b87[0x1]&&_0xc45b87[0x2]){return''+_0xc45b87[0x1]+(parseInt(_0xc45b87[0x2])+0x1);}}return _0x5f0918;}function getWidgetsList(){const _0x5a2b4c=[];try{const _0x473049='src/widgets/widgets.json';if(fs[a0_0x2acf('0x4c')](_0x473049)){const _0x1ecbc6=fs['readFileSync'](_0x473049)[a0_0x2acf('0x88')]();const _0x141ed8=JSON[a0_0x2acf('0x52')](_0x1ecbc6);for(let _0x5546e7 of _0x141ed8[a0_0x2acf('0x79')]){try{const _0x503b05='src/widgets/'+_0x5546e7['path'];const _0x207d4d=_0x503b05+'/manifest.json';if(fs['existsSync'](_0x207d4d)){let _0x192f7e=fs[a0_0x2acf('0x45')](_0x207d4d)[a0_0x2acf('0x88')]();const _0x413c38=JSON['parse'](_0x192f7e);_0x5a2b4c[a0_0x2acf('0x5f')]({'value':_0x413c38['id'],'name':a0_0x2acf('0x24')+_0x413c38['id']+a0_0x2acf('0x85')+_0x413c38['name']+a0_0x2acf('0x2b')+_0x413c38['version']});}}catch(_0xa35e76){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0x5546e7[a0_0x2acf('0x19')]+a0_0x2acf('0x76')));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk[a0_0x2acf('0x74')](_0xa35e76));}}}}catch(_0x30d92b){console['log'](symbols['error'],chalk[a0_0x2acf('0x74')](a0_0x2acf('0x25')));console[a0_0x2acf('0x5c')](symbols['error'],chalk[a0_0x2acf('0x74')](_0x30d92b));}return _0x5a2b4c;}function getWidgetPath(_0x2f5cac){const _0x605eff='src/widgets/widgets.json';let _0x22cd1b=fs['readFileSync'](_0x605eff)[a0_0x2acf('0x88')]();const _0x752329=JSON[a0_0x2acf('0x52')](_0x22cd1b);for(let _0x5ef42f of _0x752329[a0_0x2acf('0x79')]){const _0x330a8f=a0_0x2acf('0x61')+_0x5ef42f['path']+a0_0x2acf('0x18');let _0x168388=fs[a0_0x2acf('0x45')](_0x330a8f)[a0_0x2acf('0x88')]();const _0x2bbcf2=JSON[a0_0x2acf('0x52')](_0x168388);if(_0x2bbcf2['id']===_0x2f5cac){return _0x5ef42f[a0_0x2acf('0x19')];}}console['log'](symbols['error'],chalk[a0_0x2acf('0x74')](a0_0x2acf('0xb')+_0x2f5cac));}function startProxyServer(_0x222f0b,_0x53fefc){console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0x3e')](a0_0x2acf('0x5a')));var _0x4d0d73=express();_0x4d0d73['use']('/',proxy({'target':_0x222f0b,'changeOrigin':!![],'pathRewrite':{'/core/widgets':'/widgets'},'router':{'/core/widgets':widgetDebugUrl}}));_0x4d0d73[a0_0x2acf('0x60')](proxyServerPort,function(){console['log'](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0x3e')](a0_0x2acf('0x30')));console[a0_0x2acf('0x5c')](symbols['info'],chalk[a0_0x2acf('0x3e')](a0_0x2acf('0x7c')));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0x37')]('如浏览器启动失败，请通过如下命令行手工启动：'));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0x37')](a0_0x2acf('0x11')));console[a0_0x2acf('0x5c')](symbols['info'],chalk[a0_0x2acf('0x37')]('Linux:\x20/opt/google/chrome/chrome\x20--disable-web-security\x20--user-data-dir=/tmp/chrome_tmp'));console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x72')],chalk[a0_0x2acf('0x37')](a0_0x2acf('0x8b')));ChromeLauncher[a0_0x2acf('0x1e')]({'startingUrl':a0_0x2acf('0x36')+proxyServerPort,'chromeFlags':[a0_0x2acf('0x8a'),a0_0x2acf('0x1f'),a0_0x2acf('0x4a'),a0_0x2acf('0x50')]})[a0_0x2acf('0x3c')](_0x16c178=>{console['log'](symbols['info'],chalk['blue'](a0_0x2acf('0x44')));});if(_0x53fefc){_0x53fefc();}});}function connectFtpServer(_0x8ae9e0){const _0x215d63=new Client();const _0x1cbe11=ora(a0_0x2acf('0x75'));_0x1cbe11[a0_0x2acf('0x5')]();_0x215d63['on'](a0_0x2acf('0x70'),function(){_0x1cbe11[a0_0x2acf('0x4f')]();console[a0_0x2acf('0x5c')](symbols['info'],chalk[a0_0x2acf('0xe')]('服务器连接已建立...'));if(_0x8ae9e0){_0x8ae9e0(_0x215d63);}});_0x215d63['on']('error',function(_0xbdab64){_0x1cbe11[a0_0x2acf('0x1a')]();console[a0_0x2acf('0x5c')](symbols[a0_0x2acf('0x28')],chalk['red'](_0xbdab64));});_0x215d63[a0_0x2acf('0x7b')]({'host':ftpServerAddress,'user':ftpServerUserName,'password':ftpServerPassword});}